import React, { useEffect, useMemo, useRef, useState } from 'react';
import { AlertSeverity, Category, Child, CustomMode, MonitoringAlert, SafetyPlaybook } from '../types';
import {
  Bar,
  BarChart,
  CartesianGrid,
  PolarAngleAxis,
  PolarGrid,
  Radar as RadarComponent,
  RadarChart,
  Tooltip,
  XAxis,
  YAxis,
} from 'recharts';
import { useNavigate } from 'react-router-dom';
import {
  diagnosePsychScenarioFromAlerts,
  InappropriateContentSubtype,
  PsychScenarioId,
  ThreatExposureSubtype,
} from '../services/psychDiagnosticService';
import { fetchPlaybooks, sendRemoteCommand } from '../services/firestoreService';
import { getDefenseActionsWithPlaybooks } from '../services/ruleEngineService';

interface PsychologicalInsightViewProps {
  theme: 'light' | 'dark';
  child?: Child;
  alerts?: MonitoringAlert[];
  lang?: 'ar' | 'en';
  autoLockInAutomationEnabled?: boolean;
  allLocksDisabled?: boolean;
  onAcceptPlan: (plan: Partial<CustomMode>) => string | void;
  onApplyModeToChild?: (childId: string, modeId?: string) => Promise<void> | void;
  onPlanExecutionResult?: (summary: { done: number; failed: number; skipped: number }) => void;
  onSaveExecutionEvidence?: (payload: PlanExecutionEvidencePayload) => Promise<string | void> | string | void;
}

interface InterventionStep {
  week: string;
  goal: string;
  action: string;
}

interface GuidanceScenario {
  id: PsychScenarioId;
  title: string;
  icon: string;
  severity: AlertSeverity;
  severityColor: string;
  symptoms: string[];
  lurePatterns: string[];
  prevention: string[];
  interventionProgram: InterventionStep[];
  dialogues: {
    situation: string;
    opener: string;
    advice: string;
  }[];
  alertTemplates: string[];
  incidentPlan: string[];
}

interface AutoExecutionStep {
  id: string;
  title: string;
  description: string;
  command:
    | 'takeScreenshot'
    | 'blockApp'
    | 'setVideoSource'
    | 'setAudioSource'
    | 'startLiveStream'
    | 'lockDevice'
    | 'playSiren'
    | 'lockscreenBlackout'
    | 'walkieTalkieEnable'
    | 'cutInternet'
    | 'blockCameraAndMic'
    | 'notifyParent';
  value: any;
  minSeverity: AlertSeverity;
  enabledByDefault: boolean;
}

type AutoStepStatus = 'idle' | 'pending' | 'done' | 'error' | 'skipped';
type PlanVideoSource = 'camera_front' | 'camera_back' | 'screen';
type PlanAudioSource = 'mic' | 'system';
type PlanTimelineStatus = 'done' | 'error' | 'skipped' | 'info';
type ScenarioSectionKey =
  | 'symptoms'
  | 'lurePatterns'
  | 'prevention'
  | 'incidentPlan'
  | 'alertTemplates'
  | 'interventionProgram'
  | 'dialogues';
type PreviewSectionKey = 'symptoms' | 'lurePatterns';

interface PreviewOperationalInsight {
  badge: string;
  whyNow: string;
  immediateAction: string;
  toneClass: string;
}

interface PlanTimelineEntry {
  id: string;
  title: string;
  detail: string;
  status: PlanTimelineStatus;
  at: Date;
}

interface PlanExecutionEvidencePayload {
  childId: string;
  childName: string;
  scenarioId: PsychScenarioId;
  threatSubtype?: ThreatExposureSubtype;
  contentSubtype?: InappropriateContentSubtype;
  scenarioTitle: string;
  severity: AlertSeverity;
  dominantPlatform: string;
  summary: { done: number; failed: number; skipped: number };
  timeline: Array<{
    title: string;
    detail: string;
    status: PlanTimelineStatus;
    at: string;
  }>;
}

const severityRank: Record<AlertSeverity, number> = {
  [AlertSeverity.LOW]: 1,
  [AlertSeverity.MEDIUM]: 2,
  [AlertSeverity.HIGH]: 3,
  [AlertSeverity.CRITICAL]: 4,
};

const isAutoLockCommand = (command: AutoExecutionStep['command']): boolean =>
  command === 'lockDevice' || command === 'lockscreenBlackout';

const scenarioBlockedDomains: Record<PsychScenarioId, string[]> = {
  bullying: ['discord.com', 'telegram.org'],
  threat_exposure: ['discord.com', 'telegram.org', 'snapchat.com'],
  gaming: ['roblox.com', 'epicgames.com', 'discord.com'],
  inappropriate_content: ['reddit.com', 'xvideos.com', 'pornhub.com'],
  cyber_crime: ['pastebin.com', 'discord.com', 'telegram.org'],
  crypto_scams: ['binance.com', 'okx.com', 'telegram.org'],
  phishing_links: ['bit.ly', 'tinyurl.com', 't.me', 'discord.com'],
  self_harm: ['reddit.com', 'discord.com', 'telegram.org'],
  sexual_exploitation: ['snapchat.com', 'telegram.org', 'discord.com'],
  account_theft_fraud: ['bit.ly', 'tinyurl.com', 't.me', 'discord.com'],
  gambling_betting: ['stake.com', '1xbet.com', 'bet365.com'],
  privacy_tracking: ['grabify.link', 'iplogger.org', 'shorturl.at'],
  harmful_challenges: ['tiktok.com', 'youtube.com', 'discord.com'],
};

const guidanceScenariosBase: GuidanceScenario[] = [
  {
    id: 'bullying',
    title: 'ุงูุชููุฑ ุงูุฅููุชุฑููู',
    icon: '๐งฉ',
    severity: AlertSeverity.HIGH,
    severityColor: 'bg-rose-600',
    symptoms: [
      'ุชุฌูุจ ุงูุทูู ุชุทุจููุงุช ูุญุฏุฏุฉ ุฃู ุญุฐู ุงูุฑุณุงุฆู ุจุณุฑุนุฉ.',
      'ุชุบูุฑ ุงููุฒุงุฌ ุจุนุฏ ูุชุฑุงุช ุงุณุชุฎุฏุงู ูุตูุฑุฉ.',
      'ุงูุณุญุงุจ ุงุฌุชูุงุนู ุฃู ุฑูุถ ุงูุฐูุงุจ ูููุฏุฑุณุฉ ุฏูู ูุจุฑุฑ ูุงุถุญ.',
    ],
    lurePatterns: [
      'ูุฌููุนุงุช ุชุณุชูุฒ ุงูุทูู ุซู ุชูุดุฑ ููุทุงุช ูุญุฑุฌุฉ.',
      'ุญุณุงุจุงุช ููููุฉ ูุฅูุงูุฉ ูุชูุฑุฑุฉ ูุฅูุตุงุก ุงุฌุชูุงุนู.',
      'ุชุนูููุงุช ุชุญุฑูุถูุฉ ุชุฏูุน ุงูุทูู ููุฑุฏ ุงูุงููุนุงูู.',
    ],
    prevention: [
      'ุชุดุฏูุฏ ุงูุฎุตูุตูุฉ: ูู ูุฑุงุณู/ูุดุงูุฏ ุงูููุดูุฑุงุช.',
      'ููุน ุงูุฑุณุงุฆู ูู ุงูุบุฑุจุงุก ุฏุงุฎู ุงูุฃูุนุงุจ ูุงูููุตุงุช.',
      'ุชุฏุฑูุจ ุงูุทูู ุนูู ูุงุนุฏุฉ: ูุซููุ ุงุญุธุฑุ ุจููุบุ ูุง ุชุฑุฏ.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุงุญุชูุงุก ููุฑู', action: 'ุฌูุณุฉ ุฏุนู + ุชูุซูู ุงูุฃุฏูุฉ + ุญุธุฑ ุงูุญุณุงุจุงุช ุงููุคุฐูุฉ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุฅููุงู ุงูุงุณุชูุฒุงู', action: 'ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ ููุฑุงูุจุฉ ููุงุท ุงูุชูุงุณ ุนุงููุฉ ุงูุฎุทุฑ.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุงุณุชุนุงุฏุฉ ุงูุซูุฉ', action: 'ุญูุงุฑ ุชุฏุฑูุฌู ูุฅุดุฑุงู ุงููุฏุฑุณุฉ ุฅุฐุง ูุงูุช ุงูุจูุฆุฉ ูุดุชุฑูุฉ.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ุชุซุจูุช ุงูุชุนุงูู', action: 'ุฎุทุฉ ูุชุงุจุนุฉ ุฃุณุจูุนูุฉ ูุตูุฑุฉ ูุน ููุงุณ ุชุญุณู ุงูุณููู.' },
    ],
    dialogues: [
      {
        situation: 'ุงูุชุชุงุญ ุจูุง ููู',
        opener: 'ุฃูุง ูุนูุ ูุฃู ุฅุณุงุกุฉ ูุตูุช ูู ููุณุช ุฎุทุฃู. ุงุญูู ูู ุจูุฏูุก.',
        advice: 'ูุง ุชุจุฏุฃ ุจุงูุฃุณุฆูุฉ ุงูุงุชูุงููุฉุ ุงุจุฏุฃ ุจุงูุฃูุงู ุงูููุณู.',
      },
      {
        situation: 'ุชุนุทูู ุงูุถุฑุฑ',
        opener: 'ุณูููู ุงูุญุณุงุจุงุช ุงููุณูุฆุฉ ุงูุขูุ ููุญูุธ ุงูุฃุฏูุฉ ูุจู ุฃู ุญุฐู.',
        advice: 'ุงูุชูุซูู ูุณุจู ุงูุญุฐู ุฏุงุฆููุง.',
      },
      {
        situation: 'ุชุซุจูุช ุงูุซูุฉ',
        opener: 'ุฅุจูุงุบู ููุง ููุฉุ ูููุณ ุถุนููุง. ูุญู ูุฑูู ูุงุญุฏ.',
        advice: 'ุฃุนุฏ ุชุนุฑูู ุงูุดุฌุงุนุฉ ุจุฃููุง ุทูุจ ูุณุงุนุฏุฉ ูุจูุฑ.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ูุชูุณุท: ูุคุดุฑุงุช ุถุบุท ุงุฌุชูุงุนู ุฑูููุฉุ ูููุตุญ ุจุญูุงุฑ ูุงุฏุฆ ุงูููู.',
      'ุชูุจูู ูุฑุชูุน: ููุท ุชููุฑ ูุชูุฑุฑุ ุงุจุฏุฃ ูุณุงุฑ ุงูุชูุซูู ูุงูุญุธุฑ.',
    ],
    incidentPlan: [
      'ุทูุฃูุฉ ุงูุทูู ููุฑูุง: ูุง ููู ููุง ุนููุจุฉ ูุญุธุฉ ุงูุฅุจูุงุบ.',
      'ุญูุธ ุงูุฃุฏูุฉ: ููุทุงุช ุดุงุดุฉุ ุฃุณูุงุก ุงูุญุณุงุจุงุชุ ุงูุชูููุช.',
      'ุญุธุฑ ูุฅุจูุงุบ ุฏุงุฎู ุงูููุตุฉ.',
      'ุถุจุท ุงูุฎุตูุตูุฉ ูุชูููุฏ ุงูุฑุณุงุฆู ูู ุงูุบุฑุจุงุก.',
      'ูุชุงุจุนุฉ ููุณูุฉ ุฎูุงู 72 ุณุงุนุฉ.',
    ],
  },
  {
    id: 'threat_exposure',
    title: 'ุงูุชูุฏูุฏ ูุงูุงุจุชุฒุงุฒ',
    icon: '๐จ',
    severity: AlertSeverity.CRITICAL,
    severityColor: 'bg-red-700',
    symptoms: [
      'ุฎูู ูุงุถุญ ุนูุฏ ูุตูู ุฅุดุนุงุฑุงุช ูู ุฌูุฉ ุจุนูููุง.',
      'ุฅุฎูุงุก ุงููุงุชู ุฃู ุญุฐู ูุญุงุฏุซุงุช ุจุดูู ูุชุณุงุฑุน.',
      'ุทูุจ ูุงู/ุจุทุงูุงุช ุจุดูู ุบูุฑ ูุจุฑุฑ ุฃู ุชูุชุฑ ุญุงุฏ.',
    ],
    lurePatterns: [
      'ุจูุงุก ุซูุฉ ุฒุงุฆูุฉ ุซู ุทูุจ ุตูุฑ ุฃู ูุนูููุงุช ุฎุงุตุฉ.',
      'ุชูุฏูุฏ ุจุงููุดุฑ ุฃู ุงูุชุดููุฑ ุจุนุฏ ุงูุญุตูู ุนูู ูุญุชูู ุญุณุงุณ.',
      'ุงุจุชุฒุงุฒ ูุงูู ุนุจุฑ ุจุทุงูุงุช ุงููุฏุงูุง ุฃู ุงูุชุญูููุงุช ุงูุฑูููุฉ.',
    ],
    prevention: [
      'ูุงุนุฏุฉ ุฐูุจูุฉ: ูุง ุตูุฑ ุฎุงุตุฉุ ูุง ุฑููุฒ ุชุญููุ ูุง ุชูุงูุถ.',
      'ุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA) ููุญุณุงุจุงุช ุงูุฑุฆูุณูุฉ.',
      'ุชุนููู ุงูุทูู ุงุณุชุฎุฏุงู ุฒุฑ ุงููุณุงุนุฏุฉ ุงูููุฑู ุฏุงุฎู ุงูุชุทุจูู.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุฅููุงู ุงููุฒู', action: 'ุชุทุจูู ุฎุทุฉ 10 ุฏูุงุฆู ุจุงููุงูู ูุชุตุนูุฏ ุงูุญูุงูุฉ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุชุญุตูู ุงูุญุณุงุจุงุช', action: 'ุชุบููุฑ ูููุงุช ุงููุฑูุฑุ ูุฑุงุฌุนุฉ ุงูุฌูุณุงุชุ ุฅุบูุงู ุงููุณุงุฑุงุช ุงูููุดููุฉ.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุฏุนู ููุณู', action: 'ุฌูุณุงุช ุชูุฑูุบ ูููุ ูุชุฃููุฏ ุนุฏู ุงูุฐูุจ ุนูู ุงูุทูู.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ููุน ุงูุชูุฑุงุฑ', action: 'ุชุญุฏูุซ ุณูุงุณุงุช ุงูุฃุณุฑุฉ ุงูุฑูููุฉ ูุฑูุน ูุนู ุงูุทูู.' },
    ],
    dialogues: [
      {
        situation: 'ุฅููุงู ุงูุชุตุนูุฏ',
        opener: 'ุณูุงูุชู ุฃูููุง. ูู ูุฑุฏ ุนูู ุฃู ุชูุฏูุฏุ ูุณูุชุนุงูู ุฑุณูููุง.',
        advice: 'ูุง ุฏูุนุ ูุง ุชูุงูุถุ ูุง ุญุฐู ูุจู ุงูุชูุซูู.',
      },
      {
        situation: 'ุชุซุจูุช ุงูุฃูุงู',
        opener: 'ูู ุชูุงุฌู ูุฐุง ูุญุฏูุ ุณูุญู ุงูููุถูุน ุฎุทูุฉ ุจุฎุทูุฉ.',
        advice: 'ุฃุจุฑุฒ ุฃู ุงูุทูู ุถุญูุฉ ูููุณ ูุฐูุจูุง.',
      },
      {
        situation: 'ุงูุชุญุฑู ุงููุงูููู',
        opener: 'ุณูุฌูุน ุงูุฏููู ุซู ูุจููุบ ุงููููุงุช ุงููุนุชูุฏุฉ ูุญูุงูุชู.',
        advice: 'ุญูุธ ุงููููุฉ ุงูุฑูููุฉ ููุฌูุฉ ุงูููุฏุฏุฉ ููู ูุจู ุงูุฅุจูุงุบ.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ: ุงุญุชูุงู ุชูุฏูุฏ/ุงุจุชุฒุงุฒ ูุจุงุดุฑ. ุงุจุฏุฃ ุฎุทุฉ 10 ุฏูุงุฆู ุงูุขู.',
      'ุชูุจูู ุญุฑุฌ: ุณููู ุญุฐู ูุญุงุฏุซุงุช + ุฎูู + ุทูุจ ูุงููุ ููุฒู ุชุฏุฎู ููุฑู.',
    ],
    incidentPlan: [
      'ูุง ุชูุงูุถ ููุง ุฏูุน ุชุญุช ุฃู ุถุบุท.',
      'ุญูุธ ุงูุฃุฏูุฉ ุงูุฑูููุฉ ููุฑูุง.',
      'ุฅููุงู ุงูุชูุงุตู ูุน ุงููุจุชุฒ ูุญุธุฑู.',
      'ุชุฃููู ุงูุญุณุงุจุงุช (ุชุบููุฑ ูููุฉ ุงููุฑูุฑ + ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA)).',
      'ุฅุจูุงุบ ุงูููุตุฉ ูุงูุฌูุฉ ุงููุฎุชุตุฉ ุญุณุจ ุงูุฅุฌุฑุงุกุงุช ุงููุญููุฉ.',
    ],
  },
  {
    id: 'gaming',
    title: 'ุฅุฏูุงู ุงูุฃูุนุงุจ',
    icon: '๐ฎ',
    severity: AlertSeverity.HIGH,
    severityColor: 'bg-indigo-600',
    symptoms: [
      'ุณูุฑ ููุฑุท ูุงุถุทุฑุงุจ ููู ูุชูุฑุฑ.',
      'ุนุตุจูุฉ ุนุงููุฉ ุนูุฏ ุณุญุจ ุงูุฌูุงุฒ ุฃู ุงูุชูุงุก ุงูููุช.',
      'ุชุฑุงุฌุน ุฏุฑุงุณู ูุงูุณุญุงุจ ูู ุฃูุดุทุฉ ูุงูุนูุฉ.',
    ],
    lurePatterns: [
      'ููุงูุขุช ููููุฉ ุชุจูู ุชุนูููุง ููุฑููุง.',
      'ุถุบุท ุงูุฃุตุฏูุงุก ูู ุงููุฑู ุงูุชูุงูุณูุฉ.',
      'ูุดุชุฑูุงุช ุฏุงุฎู ุงููุนุจุฉ ุชุนุฒุฒ ูุทุงุฑุฏุฉ ุงูุฎุณุงุฑุฉ.',
    ],
    prevention: [
      'ุชูุนูู Bedtime ุชููุงุฆู.',
      'ุฌุฏููุฉ ููุช ุงููุนุจ ูุฑุจุทู ุจุงูููุงู ุงูููููุฉ.',
      'ููู ุงููุดุชุฑูุงุช ุจูููุฉ ูุฑูุฑ ููู ุงูุฃูุฑ.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุงุณุชูุฑุงุฑ ุงูููู', action: 'ุชุซุจูุช ููุช ููู ูููุน ุงูุงุณุชุฎุฏุงู ุงููููู.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุฎูุถ ุชุฏุฑูุฌู', action: 'ุชูููู 10%-15% ูู ุงูุงุณุชุฎุฏุงู ุงููููู.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุจุฏุงุฆู ูุงูุนูุฉ', action: 'ุฅุฏุฎุงู ูุดุงุท ุจุฏูู ุซุงุจุช (ุฑูุงุถุฉ/ููุงูุฉ).' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ุชุซุจูุช ุงูุณููู', action: 'ูุธุงู ููุงูุขุช ูุฑุชุจุท ุจุงูุงูุชุฒุงู ุงูุฏุฑุงุณู ูุงูุณูููู.' },
    ],
    dialogues: [
      {
        situation: 'ุงุชูุงู ููุตู',
        opener: 'ุฃูุง ูุง ุฃุฑูุฏ ุงูููุน ุงููุงููุ ููุท ูุญุชุงุฌ ุชูุงุฒููุง ูุญููู.',
        advice: 'ุงุฎุชุฑ ุตูุบุฉ ุดุฑุงูุฉ ูุง ุตูุบุฉ ุนูุงุจ.',
      },
      {
        situation: 'ุชูุธูู ุชุฏุฑูุฌู',
        opener: 'ุฎูููุง ูุจุฏุฃ ุจุฎุทุฉ ุฃุณุจูุนุ ุซู ูุฑุงุฌุน ุณูุง ุงููุชุงุฆุฌ.',
        advice: 'ุงูุชุบููุฑ ุงูุชุฏุฑูุฌู ููุฌุญ ุฃูุซุฑ ูู ุงููุทุน ุงูููุงุฌุฆ.',
      },
      {
        situation: 'ุฏุนู ุงูููุงุฑุฉ',
        opener: 'ููุงุฑุชู ููุชุงุฒุฉุ ููุฑูุฏูุง ุชุณุชูุฑ ุจุฏูู ุฃู ุชุถุฑ ูููู ูุฏุฑุงุณุชู.',
        advice: 'ุงุฑุจุท ุงูุซูุงุก ุจุถูุงุจุท ุงูุงุณุชุฎุฏุงู.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ููู: ุงุณุชุฎุฏุงู ูุชุฃุฎุฑ ูุชูุฑุฑุ ูููุตุญ ุจุชูุนูู ูุถุน ุงูููู.',
      'ุชูุจูู ุณูููู: ุชุฌุงูุฒุงุช ููุช ุงูุดุงุดุฉ ูุน ุงููุนุงู ุนูุฏ ุงูุฅููุงู.',
    ],
    incidentPlan: [
      'ุชูุฏุฆุฉ ุงููููู ูุนุฏู ุงูุฏุฎูู ูู ุตุฏุงู ูุญุธู.',
      'ุชูุนูู ูุถุน ุงูููู ูุฅุบูุงู ุงูุชุทุจููุงุช ุนุงููุฉ ุงูุงุณุชููุงู.',
      'ุชุญุฏูุฏ ุฎุทุฉ ุฃุณุจูุน ุฎูุถ ุชุฏุฑูุฌู.',
      'ุฅุฏุฎุงู ูุดุงุท ุจุฏูู ูููู.',
      'ูุฑุงุฌุนุฉ ุฃุณุจูุนูุฉ ุจุงูุฃุฑูุงู ูุง ุจุงูุงูุทุจุงุนุงุช.',
    ],
  },
  {
    id: 'inappropriate_content',
    title: 'ุงููุญุชูู ุบูุฑ ุงูููุงุณุจ',
    icon: '๐ก๏ธ',
    severity: AlertSeverity.HIGH,
    severityColor: 'bg-violet-700',
    symptoms: [
      'ุฅุบูุงู ููุงุฌุฆ ููุดุงุดุฉ ุนูุฏ ุงูุงูุชุฑุงุจ.',
      'ุชุตูุญ ุฎูู ูุชูุฑุฑ ุฃู ุชุงุฑูุฎ ูุญุฐูู ุจุงุณุชูุฑุงุฑ.',
      'ุชูุชุฑ ุฃู ุฎุฌู ุฒุงุฆุฏ ุจุนุฏ ุงูุชูุงุฌุฏ ุนูู ุงูุฅูุชุฑูุช.',
    ],
    lurePatterns: [
      'ุฑูุงุจุท ูุถููุฉ ุฏุงุฎู ููุฏูููุงุช ุฃู ุฃูุนุงุจ.',
      'ุญุณุงุจุงุช ูุถูููุฉ ุชูุดุฑ ููุงุฏ ุตุงุฏูุฉ ุจุนูุงููู ุจุฑูุฆุฉ.',
      'ููุงูุฐ ููุจุซูุฉ ุชุณุชุฏุฑุฌ ุงูุทูู ุฎุงุฑุฌ ุจูุฆุฉ ุขููุฉ.',
    ],
    prevention: [
      'SafeSearch + DNS ููุชุฑุฉ ุญุณุจ ุงูุนูุฑ.',
      'ูุงุฆูุฉ ููุงูุน/ุชุทุจููุงุช ููุซููุฉ ููุท.',
      'ุฑุณุงูุฉ ุฃุณุฑูุฉ ุซุงุจุชุฉ: ุฃุบูู ูุจููุบ ุจูุง ุนููุจุฉ.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุญูุงูุฉ ููุฑูุฉ', action: 'ุชูููุฉ ุงูููุงุชุฑ ูุฅุฒุงูุฉ ุงููุตุงุฏุฑ ุงูููุดููุฉ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุญูุงุฑ ุชุฑุจูู', action: 'ููุงุด ุขูู ุนู ุงููุญุชูู ุงูุตุงุฏู ูุทุฑู ุงูุชุจููุบ.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุจุฏุงุฆู ุตุญูุฉ', action: 'ุฅุญูุงู ูุญุชูู ููุงุณุจ ููุนูุฑ ููุฑุงูุจ.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ุชุซุจูุช ุงูุนุงุฏุฉ', action: 'ูุฑุงุฌุนุฉ ุฃุณุจูุนูุฉ ููุชุนุฑุถุงุช ูุชุนุฏูู ุงูุถุจุท.' },
    ],
    dialogues: [
      {
        situation: 'ุฅุฒุงูุฉ ุงูุฎูู',
        opener: 'ูู ุธูุฑ ุดูุก ูุฒุนุฌุ ุฃุบููู ูุชุนุงู ูุจุงุดุฑุฉุ ูุง ููู ุนูุงุจ.',
        advice: 'ุฃุฒู ูุตูุฉ ุงูุงุนุชุฑุงู ูู ุงูุจุฏุงูุฉ.',
      },
      {
        situation: 'ุชูุฌูู ุนููู',
        opener: 'ูุนุฏู ุงูุฅุนุฏุงุฏุงุช ุณูุง ุญุชู ูุง ูุชูุฑุฑ ุงููุตูู ููุฐุง ุงููุญุชูู.',
        advice: 'ุงูุญูุงุฑ ูุฌุจ ุฃู ููุชูู ุจุฎุทูุฉ ุชูููุฉ ูุงุถุญุฉ.',
      },
      {
        situation: 'ุชุซุจูุช ุงููุงุนุฏุฉ',
        opener: 'ุฃู ุฑุงุจุท ุบุฑูุจ ุฃู ูุญุชูู ุตุงุฏู: ูุง ูุชุญุ ููุท ุจููุบ.',
        advice: 'ุงูุชูุฑุงุฑ ุงููููู ูุจูู ุณููู ุงูุฃูุงู.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ูุญุชูู: ูุญุงููุงุช ูุตูู ูุชุตูููุงุช ูุญุฌูุจุฉ ุฃุนูู ูู ุงููุนุชุงุฏ.',
      'ุชูุจูู ููุงุฆู: ูููุตุญ ุจุชุญุฏูุซ ูุฑุดุญุงุช ุงููุญุชูู ููุฐุง ุงูุนูุฑ.',
    ],
    incidentPlan: [
      'ุฅููุงู ุงููุตุฏุฑ ุงููุณุจุจ (ุฑุงุจุท/ุญุณุงุจ/ุชุทุจูู).',
      'ูุฑุงุฌุนุฉ ุงูููุงุชุฑ ูุฅุนุฏุงุฏุงุช ุงูุจุญุซ ุงูุขูู.',
      'ุญูุงุฑ ุงุญุชูุงุก ูุตูุฑ ูุน ุงูุทูู ุฏูู ููู.',
      'ุชูุนูู ูุงุฆูุฉ ุจุฏุงุฆู ุขููุฉ ูููุญุชูู.',
      'ูุชุงุจุนุฉ 7 ุฃูุงู ูููุงุณ ุงูุชูุฑุงุฑ.',
    ],
  },
  {
    id: 'cyber_crime',
    title: 'ุงูุงูุญุฑุงู ุงูุณูุจุฑุงูู',
    icon: '๐จโ๐ป',
    severity: AlertSeverity.HIGH,
    severityColor: 'bg-slate-800',
    symptoms: [
      'ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุบูุฑ ููุซููุฉ ุจุตูุบุฉ ูุฌูููุฉ.',
      'ุงูุญุฏูุซ ุนู ุงุฎุชุฑุงู ุญุณุงุจุงุช ุจุงุนุชุจุงุฑู ุฅูุฌุงุฒูุง.',
      'ุฅุฎูุงุก ุงููููุฉ ุจุดูู ูุจุงูุบ ุฏูู ูุจุฑุฑ ูุงูุนู.',
    ],
    lurePatterns: [
      'ูููุงุช ุชูุฏู ุณูุฑุจุชุงุช ุฌุงูุฒุฉ ุจุฏุงูุน ุงููุถูู.',
      'ูุฌููุนุงุช ุชุนุทู ููุงู ุชุฎุฑูุจูุฉ ูููุงูุณุฉ.',
      'ุชุญููุฒ ุงุฌุชูุงุนู ุญูู ุงูููุฉ ุงูุชูููุฉ ููุงุจู ูุณุฑ ุงูููุงููู.',
    ],
    prevention: [
      'ุญุธุฑ ูุตุงุฏุฑ ุงูุฃุฏูุงุช ุงููุฌูููุฉ.',
      'ุดุฑุญ ุงููุฑู ุจูู ุงูุชุนูู ุงูุฃููู ุงููุงูููู ูุงูุชุนุฏู.',
      'ุชูุฌูู ุงููููุจุฉ ุฅูู ููุตุงุช CTF ุชุนููููุฉ ุจุฅุดุฑุงู.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุงุญุชูุงุก ุงูุณููู', action: 'ุฅููุงู ุงูุฃุฏูุงุช ุงูุฎุทุฑุฉ ููุฑุงุฌุนุฉ ุงูุฌูุงุฒ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุจุฏูู ูุงูููู', action: 'ุจุฏุก ูุณุงุฑ ุชุนูู ุฃุฎูุงูู ููุฃูู ุงูุณูุจุฑุงูู.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ูุนู ูุงูููู', action: 'ุฌูุณุฉ ุนูุงูุจ ุฌูุงุฆูุฉ ูุจุณุทุฉ ููุจุงุดุฑุฉ.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ุงูุชุฒุงู ูุณุชูุฑ', action: 'ุฎุทุฉ ุงุณุชุฎุฏุงู ุชูููุฉ ุฎุงุถุนุฉ ููุฑุงุฌุนุฉ ุฃุณุจูุนูุฉ.' },
    ],
    dialogues: [
      {
        situation: 'ุฅุนุงุฏุฉ ุชูุฌูู ุงูููุงุฑุฉ',
        opener: 'ุฐูุงุคู ุงูุชููู ูููุ ูุงูุฃูุถู ุชุญูููู ููุณุงุฑ ุงุญุชุฑุงูู ูุงูููู.',
        advice: 'ุงุนุชุฑู ุจุงููููุจุฉ ุฃูููุง ุซู ุฃุนุฏ ุชูุฌูููุง.',
      },
      {
        situation: 'ุญุฏูุฏ ูุงุถุญุฉ',
        opener: 'ุฃู ูุฌูู ุฑููู ูุฏ ูุตุจุญ ูุถูุฉ ุฌูุงุฆูุฉ ุชุคุซุฑ ุนูู ูุณุชูุจูู.',
        advice: 'ูุถุญ ุงูุนูุงูุจ ุจุฏูู ุชูููู ุนุงุทูู.',
      },
      {
        situation: 'ูุณุงุฑ ุจุฏูู',
        opener: 'ูุฎุชุงุฑ ูุนูุง ููุตุฉ ุชุฏุฑูุจ ูุงููููุฉ ููุจูู ููุงุฑุงุชู ุจุดูู ุขูู.',
        advice: 'ุงูุจุฏูู ุงูุนููู ูููู ุงูุนูุฏุฉ ููุณููู ุงูุฎุทุฑ.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ุณูููู: ูุดุงุท ุชููู ูุฌููู ูุชูุฑุฑ ูุญุชุงุฌ ุฅุนุงุฏุฉ ุชูุฌูู ููุฑู.',
      'ุชูุจูู ุชููู: ุชุซุจูุช ุฃุฏูุงุช ูุฌูููุฉ ุงููุตุฏุฑ ุนูู ุฌูุงุฒ ุงูุทูู.',
    ],
    incidentPlan: [
      'ุฅููุงู ุงูุฃุฏูุงุช ุงููุฌูููุฉ ููุฑูุง.',
      'ูุญุต ุงูุฌูุงุฒ ูุฅุฒุงูุฉ ุงููุตุงุฏุฑ ุบูุฑ ุงูููุซููุฉ.',
      'ุฌูุณุฉ ุชูุถูุญ ูุงูููู ูุตูุฑุฉ.',
      'ุฅุฏุฑุงุฌ ูุณุงุฑ ุชุนูู ุฃุฎูุงูู ุจุฏูู.',
      'ูุชุงุจุนุฉ ุงูุชุฒุงู ุฃุณุจูุนูุฉ.',
    ],
  },
  {
    id: 'phishing_links',
    title: 'ุงูุชุตูุฏ ูุงูุฑูุงุจุท ุงูุฎุจูุซุฉ',
    icon: '๐',
    severity: AlertSeverity.CRITICAL,
    severityColor: 'bg-cyan-700',
    symptoms: [
      'ุงุณุชูุจุงู ุฑูุงุจุท ูุฎุชุตุฑุฉ ุฃู ุตูุญุงุช ุฏุฎูู ุบูุฑ ูุฃูููุฉ ุจุดูู ูุชูุฑุฑ.',
      'ุทูุจ ุฑููุฒ ุชุญูู ุฃู ูููุฉ ูุฑูุฑ ุจุญุฌุฉ ุงูุชุญูู ูู ุงูุญุณุงุจ.',
      'ุฎุฑูุฌ ููุงุฌุฆ ูู ุงูุญุณุงุจุงุช ุฃู ุชูุจููุงุช ุชุณุฌูู ุฏุฎูู ุบูุฑ ูุนุฑููุฉ.',
    ],
    lurePatterns: [
      'ุฑุณุงุฆู ุนุงุฌูุฉ ุชุทูุจ ุชุญุฏูุซ ูููุฉ ุงููุฑูุฑ ููุฑุงู.',
      'ุตูุญุงุช ุชุณุฌูู ุฏุฎูู ูุฒููุฉ ูุดุงุจูุฉ ููููุตุงุช ุงููุนุฑููุฉ.',
      'ุฑูุงุจุท ุฌูุงุฆุฒ/ูุฏุงูุง ุชููุฏ ุฅูู ุฌูุน ุจูุงูุงุช ุงูุญุณุงุจ.',
    ],
    prevention: [
      'ูุงุนุฏุฉ ุซุงุจุชุฉ: ูุง ูุชุญ ุฑูุงุจุท ุญุณุงุณุฉ ูุจู ุงูุชุญูู ูู ุงูุฑุงุจุท ุงููุงูู.',
      'ุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA) ูุนุฏู ูุดุงุฑูุฉ ุฑููุฒ ุงูุชุญูู ูุทููุงู.',
      'ุงุณุชุฎุฏุงู ูุฏูุฑ ูููุงุช ูุฑูุฑ ูุชูุงุฏู ุฅุฏุฎุงู ุจูุงูุงุช ูู ุตูุญุงุช ูุฒููุฉ.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุงุญุชูุงุก ููุฑู', action: 'ุนุฒู ุงูุฑูุงุจุทุ ุชุบููุฑ ูููุงุช ุงููุฑูุฑุ ูุฅุบูุงู ุงูุฌูุณุงุช ุงููุดุจููุฉ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุชุญุตูู ุงูุญุณุงุจุงุช', action: 'ุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA) ููู ุงูุญุณุงุจุงุช ููุฑุงุฌุนุฉ ุฅุนุฏุงุฏุงุช ุงูุงุณุชุฑุฏุงุฏ.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุฑูุน ุงููุนู', action: 'ุชุฏุฑูุจ ุนููู ุนูู ุงูุชุญูู ูู ุงูุฑูุงุจุท ูุงูุจุฑูุฏ.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ููุน ุงูุชูุฑุงุฑ', action: 'ูุงุฆูุฉ ูุทุงูุงุช ูุญุธูุฑุฉ ูุชูุจููุงุช ุงุณุชุจุงููุฉ ููุฃุณุฑุฉ.' },
    ],
    dialogues: [
      {
        situation: 'ุฅููุงู ุงูุถุฑุฑ',
        opener: 'ูู ููุชุญ ุฃู ุฑุงุจุท ุฌุฏูุฏ ุงูุขู. ุณูุฑุงุฌุน ูู ุงูุฑูุงุจุท ูุนุงู ุจุฎุทูุงุช ูุงุถุญุฉ.',
        advice: 'ุงุจุฏุฃ ุจุงูุทูุฃูุฉ ุซู ุงูุชูู ูุจุงุดุฑุฉ ููุฅุฌุฑุงุก ุงูุชููู.',
      },
      {
        situation: 'ุชุฃููู ุงูุญุณุงุจ',
        opener: 'ุณูุบููุฑ ูููุงุช ุงููุฑูุฑ ูููุนู ุงูุชุญูู ุงูุซูุงุฆู ููุฑุงู ูุญูุงูุชู.',
        advice: 'ุงุฌุนู ุงูุทูู ุดุฑููุงู ูู ุนูููุฉ ุงูุฃูุงู ูุง ูุฌุฑุฏ ูุชููู ุฃูุงูุฑ.',
      },
      {
        situation: 'ุชุนุฒูุฒ ุงูุณููู',
        opener: 'ุฃู ุฑุงุจุท ูุทูุจ ูููุฉ ูุฑูุฑ ุฃู ุฑูุฒ ุชุญูู ูุนุชุจุฑ ูุดุจููุงู ุญุชู ูุซุจุช ุงูุนูุณ.',
        advice: 'ูุฑูุฑ ุงููุงุนุฏุฉ ููููุงู ุญุชู ุชุชุญูู ูุนุงุฏุงุช ุซุงุจุชุฉ.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ: ููุท ุชุตูุฏ/ุฑูุงุจุท ุฎุจูุซุฉ ูุฑุตูุฏ. ุชู ุชูุนูู ุนุฒู ุงูุฑุงุจุท ูุชุฃููู ุงูุญุณุงุจุงุช.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุฌุงุฑู ุชุฏููุฑ ูููุงุช ุงููุฑูุฑ ูุงูุชุญูู ูู ุฌูุณุงุช ุงูุฏุฎูู.',
    ],
    incidentPlan: [
      'ุฅููุงู ูุชุญ ุงูุฑูุงุจุท ุงููุดุจููุฉ ููุฑุงู.',
      'ุชุบููุฑ ูููุงุช ุงููุฑูุฑ ููุญุณุงุจุงุช ุงููุชุฃุซุฑุฉ.',
      'ุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA) ูุฅุบูุงู ูู ุงูุฌูุณุงุช ุงููุดุทุฉ ุบูุฑ ุงูููุซููุฉ.',
      'ุชูุซูู ุงูุฑุงุจุท ูุงูุฑุณุงูุฉ ุงูุฃุตููุฉ ูุจู ุงูุญุฐู.',
      'ุฅุจูุงุบ ุงูููุตุฉ ุนู ุฑุณุงูุฉ ุงูุชุตูุฏ.',
    ],
  },
  {
    id: 'crypto_scams',
    title: 'ุงูุงุญุชูุงู ุงููุงูู ุงูุฑููู',
    icon: '๐ธ',
    severity: AlertSeverity.MEDIUM,
    severityColor: 'bg-amber-600',
    symptoms: [
      'ุงูุฏูุงุน ุชุฌุงู ุฃุฑุจุงุญ ุณุฑูุนุฉ ุบูุฑ ูููููุฉ.',
      'ุทูุจ ููุงุฌุฆ ูุจุทุงูุงุช ุฃู ุชุญูููุงุช ุฑูููุฉ.',
      'ุงูุชุฑููุฌ ููููุงุช ุงุณุชุซูุงุฑ ุบูุฑ ููุซููุฉ ุจูู ุงูุฃุตุฏูุงุก.',
    ],
    lurePatterns: [
      'ูุนูุฏ ุจุนูุงุฆุฏ ูุถูููุฉ ุฎูุงู ููุช ูุตูุฑ.',
      'ุฑูุงุจุท Airdrop/ูุญุงูุธ ูุฒููุฉ.',
      'ุถุบุท ูู ูุคุซุฑูู ุฃู ูุฌููุนุงุช ุชูุตูุงุช ูุฌูููุฉ.',
    ],
    prevention: [
      'ุฅููุงู ุฃู ุชุญููู ุจูุง ููุงููุฉ ููู ุงูุฃูุฑ.',
      'ุญุธุฑ ุงููููุงุช ูุงููููุงุช ุงูุงุญุชูุงููุฉ ุงููุชูุฑุฑุฉ.',
      'ุชุนููู ููุงุนุฏ ุงูุชุญูู ุงููุงูู ุงูุฃุณุงุณู.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุชุฌููุฏ ุงููุฎุงุทุฑ', action: 'ููู ุงููุฏููุนุงุช ุบูุฑ ุงููุนุชูุฏุฉ ููุฑุงุฌุนุฉ ุงูุญุฑูุฉ ุงููุงููุฉ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุชูุธูู ุงููุตุงุฏุฑ', action: 'ุญุธุฑ ุงููููุงุช ุงููุดุจููุฉ ูุชุฏููู ุงูุฑูุงุจุท.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุฑูุน ุงููุนู', action: 'ุฌูุณุฉ ูุนู ูุงูู ููุฃุณุฑุฉ ูุน ุฃูุซูุฉ ุงุญุชูุงู ุดุงุฆุนุฉ.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ุถุจุท ุฏุงุฆู', action: 'ุญุฏูุฏ ูุงููุฉ ุดูุฑูุฉ ูุฅุดุนุงุฑุงุช ููุฑูุฉ.' },
    ],
    dialogues: [
      {
        situation: 'ุชุตุญูุญ ุงูููููู',
        opener: 'ุฃู ุฑุจุญ ุณุฑูุน ูุถููู ุบุงูุจูุง ุฎุทุฑุ ุฎููุง ูุชุญูู ูุจู ุฃู ุฎุทูุฉ.',
        advice: 'ุงูุชูุนูุฉ ุงููุงููุฉ ุงููุจูุฑุฉ ุชููู ุงูุชูุฑุท.',
      },
      {
        situation: 'ุญุฏูุฏ ุงูุฃุณุฑุฉ',
        opener: 'ุฃู ูุนุงููุฉ ุฑูููุฉ ูุงุฒู ุชูุฑ ุจูุฑุงุฌุนุฉ ููู ุงูุฃูุฑ.',
        advice: 'ุชุญููู ุงููุงุนุฏุฉ ุฅูู ุฅุฌุฑุงุก ูุงุถุญ ุฏุงุฎู ุงูุชุทุจูู.',
      },
      {
        situation: 'ุจุฏุงุฆู ุขููุฉ',
        opener: 'ูุชุนูู ุงูุงุณุชุซูุงุฑ ุงูุตุญูุญ ูู ูุตุงุฏุฑ ููุซููุฉ ุจุฏู ุงููููุงุช ุงูุนุดูุงุฆูุฉ.',
        advice: 'ุงุณุชุจุฏู ุงูููุน ุงููุฌุฑุฏ ุจูุณุงุฑ ุชุนูู ุจุฏูู.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ูุงูู: ูุดุงุท ุชุญููู ุบูุฑ ุงุนุชูุงุฏู ูุญุชุงุฌ ูุฑุงุฌุนุฉ ููุฑูุฉ.',
      'ุชูุจูู ุงุญุชูุงู: ุฑุตุฏ ุชูุงุนู ูุน ูููุงุช ุฑุจุญ ุณุฑูุน ูุฌูููุฉ.',
    ],
    incidentPlan: [
      'ุฅููุงู ุฃู ุนูููุฉ ุฏูุน ููุฏ ุงูุชูููุฐ.',
      'ุญุตุฑ ุงูุญุณุงุจุงุช ูุงููููุงุช ุงููุชูุฑุทุฉ.',
      'ุชุฃููู ูุณููุฉ ุงูุฏูุน ุงููุฑุชุจุทุฉ.',
      'ุฅุจูุงุบ ุงูููุตุฉ/ุงูุจูู ุญุณุจ ุงูุญุงูุฉ.',
      'ุฌูุณุฉ ุชูุนูุฉ ูุงููุฉ ูุจุงุดุฑุฉ ููุทูู.',
    ],
  },
  {
    id: 'self_harm',
    title: 'ุฅูุฐุงุก ุงูููุณ',
    icon: '๐',
    severity: AlertSeverity.CRITICAL,
    severityColor: 'bg-rose-700',
    symptoms: [
      'ุนุจุงุฑุงุช ูุฃุณ ุฃู ูุฑุงููุฉ ููุฐุงุช ุจุดูู ูุชูุฑุฑ.',
      'ุงูุนุฒุงู ุญุงุฏ ูุชุฑุงุฌุน ุณุฑูุน ูู ุงูุนูุงูุฉ ุงูููููุฉ.',
      'ุจุญุซ ุฃู ุชูุงุนู ูุน ูุญุชูู ูุคุฐู ุงูููุณ.',
    ],
    lurePatterns: [
      'ูุฌููุนุงุช ุฑูููุฉ ุชูุฌูุฏ ุฅูุฐุงุก ุงูุฐุงุช.',
      'ุฑุณุงุฆู ุชุดุฌุน ุนูู ุชุญุฏูุงุช ูุคุฐูุฉ.',
      'ุชุทุจูุน ุงููุญุชูู ุงููุงุฆุณ ุนูู ุฃูู ุญู ูููุดุงุนุฑ.',
    ],
    prevention: [
      'ุฑูุน ูุณุชูู ุงูููุชุฑุฉ ููุญุชูู ุฅูุฐุงุก ุงูููุณ.',
      'ููุงุฉ ุชูุงุตู ููููุฉ ูุตูุฑุฉ ูุน ุงูุทูู ุจูุง ููู.',
      'ุฎุทุฉ ุฃูุงู ุฃุณุฑูุฉ ูุงุถุญุฉ ููุญุงูุงุช ุงูุญุฑุฌุฉ.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุฃูุงู ููุฑู', action: 'ุชุฃููู ุงูุจูุฆุฉ ุงูุฑูููุฉ + ุชูุงุฌุฏ ุฃุณุฑู ูุฑูุจ + ูุฑุงูุจุฉ ูุตููุฉ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุชูุฑูุบ ุงูุถุบูุท', action: 'ุฌูุณุงุช ุฏุนู ููุธูุฉ ูุชุญุฏูุฏ ูุญูุฒุงุช ุงูุชุฏููุฑ.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุงุณุชุนุงุฏุฉ ุงูุฑูุชูู', action: 'ุชูุธูู ุงูููู ูุงููุดุงุท ุงูุจุฏูู ูุชูููู ุงูุนุฒูุฉ.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ููุน ุงูุงูุชูุงุณ', action: 'ูุชุงุจุนุฉ ุฏูุฑูุฉ ุจุฎุทุฉ ุชุญุฐูุฑ ูุจูุฑ.' },
    ],
    dialogues: [
      {
        situation: 'ุงูุงุญุชูุงุก',
        opener: 'ุณูุงูุชู ุฃูู ูู ุฃู ุดูุกุ ูุฃูุง ููุง ูุนู ุงูุขู.',
        advice: 'ุงุจุฏุฃ ุจุงูุฃูุงู ูุงูุชูุงุฌุฏ ุงููุนูู ูุจู ุฃู ููุงุด ุชุญูููู.',
      },
      {
        situation: 'ูุชุญ ุงูุญูุงุฑ',
        opener: 'ูู ูู ุฃููุงุฑ ูุคุฐูุฉุ ุชููู ูุนู ููุฑูุง ุจุฏูู ุฎูู ูู ุงูุนูุงุจ.',
        advice: 'ุฎููุถ ูุจุฑุฉ ุงูุญูู ูุฑููุฒ ุนูู ุงูุงุณุชูุงุน.',
      },
      {
        situation: 'ุงูุชุตุนูุฏ ุงููุณุคูู',
        opener: 'ุณูุทูุจ ุฏุนููุง ูุฎุชุตูุง ูุญูุงูุชูุ ููุฐุง ุฏููู ููุฉ.',
        advice: 'ุงูุชุตุนูุฏ ุงููุจูุฑ ุฃูุถู ูู ุงูุงูุชุธุงุฑ.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ ุฌุฏุงู: ูุคุดุฑุงุช ุฅูุฐุงุก ุงูููุณ ุชุชุทูุจ ุชุฏุฎููุง ููุฑููุง.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุชู ุชูุนูู ุฎุทุฉ ุฃูุงู ููุฑุงูุจุฉ ูุตููุฉ.',
    ],
    incidentPlan: [
      'ุชุฃููู ุงูุทูู ููุฑูุง ูุนุฏู ุชุฑูู ูููุฑุฏูุง ุนูุฏ ุงูุฎุทุฑ ุงููุฑุชูุน.',
      'ุฅุฒุงูุฉ/ุญุธุฑ ุงููุญุชูู ูุงูุญุณุงุจุงุช ุงููุญุฑุถุฉ ุนูู ุงูุฃุฐู.',
      'ูุชุญ ููุงุฉ ุชูุงุตู ูุจุงุดุฑ ููุงุฏุฆ ูุน ุงูุทูู.',
      'ุชูุซูู ุงููุคุดุฑุงุช ุงูุฑูููุฉ ุงูุฃุณุงุณูุฉ.',
      'ุงูุชุตุนูุฏ ููุฎุชุต ุฏุนู ููุณู ุจุดูู ุนุงุฌู ุนูุฏ ุงูุถุฑูุฑุฉ.',
    ],
  },
  {
    id: 'sexual_exploitation',
    title: 'ุงูุงุณุชุฏุฑุงุฌ ูุงูุงุณุชุบูุงู ุงูุฌูุณู',
    icon: '๐ซ',
    severity: AlertSeverity.CRITICAL,
    severityColor: 'bg-fuchsia-700',
    symptoms: [
      'ุชูุงุตู ุณุฑู ูุน ุญุณุงุจุงุช ูุฌูููุฉ ุฃูุจุฑ ุนูุฑูุง.',
      'ุทูุจ ุตูุฑ ุฎุงุตุฉ ุฃู ูุนูููุงุช ุดุฎุตูุฉ ุญุณุงุณุฉ.',
      'ุฎูู ูุงุถุญ ุจุนุฏ ูุญุงุฏุซุงุช ุฎุงุตุฉ ูุชูุฑุฑุฉ.',
    ],
    lurePatterns: [
      'ุจูุงุก ุซูุฉ ุณุฑูุน ุซู ุทูุจ ูุญุชูู ุฎุงุต.',
      'ูุนูุฏ ููููุฉ ุจุงูุญุจ ุฃู ุงูุฏุนู ููุงุจู ุงูุณุฑูุฉ.',
      'ุชูุฏูุฏ ุจุงููุดุฑ ุจุนุฏ ุฌูุน ุตูุฑ/ูุนูููุงุช.',
    ],
    prevention: [
      'ููุน ุงูุฑุณุงุฆู ูู ุงูุบุฑุจุงุก ุงูุชุฑุงุถููุง.',
      'ุชุนููู ูุงุนุฏุฉ: ูุง ุตูุฑ ุฎุงุตุฉุ ูุง ุฃุณุฑุงุฑ ูุน ุงูุบุฑุจุงุก.',
      'ูุฑุงุฌุนุฉ ุฏูุฑูุฉ ููููุงุช ุงูุฏุฑุฏุดุฉ ุนุงููุฉ ุงููุฎุงุทุฑ.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุงุญุชูุงุก ุนุงุฌู', action: 'ุฅููุงู ุงูุชูุงุตู + ุญูุธ ุงูุฃุฏูุฉ + ุญูุงูุฉ ุงูุญุณุงุจ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุฃูุงู ุฑููู', action: 'ุชุบููุฑ ูููุงุช ุงููุฑูุฑ ูุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA) ููุฑุงุฌุนุฉ ุงูุฌูุณุงุช.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุฏุนู ููุณู', action: 'ุฌูุณุฉ ุงุญุชูุงุก ุชุนุงูุฌ ุงูุฐูุจ ูุงูุฎูู.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ููุน ุงูุชูุฑุงุฑ', action: 'ุฎุทุฉ ุญูุงูุฉ ุชูุงุตู ุงุฌุชูุงุนู ูุฎุตุตุฉ.' },
    ],
    dialogues: [
      {
        situation: 'ุฅุฒุงูุฉ ุงูุฐูุจ',
        opener: 'ุฃูุช ูุณุช ูุฐูุจูุงุ ุงููุณุคูููุฉ ุนูู ูู ุงุณุชุบูู.',
        advice: 'ุซุจูุช ุฃู ุงูุทูู ุถุญูุฉ ูุญูุงูุฉ ุงูุงุณุชุฌุงุจุฉ ุงูููุณูุฉ.',
      },
      {
        situation: 'ุฅููุงู ุงูุชูุงุนู',
        opener: 'ุณูููู ุงูุชูุงุตู ุงูุขู ููุญูุธ ูู ุงูุฃุฏูุฉ ูุจู ุฃู ุญุฐู.',
        advice: 'ูุง ุชูุงูุถ ููุง ุฑุฏูุฏ ุงููุนุงููุฉ.',
      },
      {
        situation: 'ุงูุญูุงูุฉ ุงูุฑุณููุฉ',
        opener: 'ุณูุณุชุฎุฏู ุงููููุงุช ุงูุฑุณููุฉ ูุญูุงูุชู ููุญุงุณุจุฉ ุงูุทุฑู ุงููุคุฐู.',
        advice: 'ุงูุชูุซูู ุงูุฏููู ูุณุฑูุน ุงูุงุณุชุฌุงุจุฉ ุงูุฑุณููุฉ.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ: ูุคุดุฑุงุช ุงุณุชุฏุฑุงุฌ/ุงุณุชุบูุงู ุฌูุณู ูุฑุตูุฏุฉ.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุชู ุนุฒู ุงูุชูุงุตู ูุจุฏุก ูุณุงุฑ ุงูุฅุจูุงุบ.',
    ],
    incidentPlan: [
      'ูุทุน ุงูุชูุงุตู ูุน ุงูุญุณุงุจ ุงููุคุฐู ููุฑูุง.',
      'ุญูุธ ูุนุฑูุงุช ุงูุญุณุงุจุงุช ูุงูุฑุณุงุฆู ูุงูุชูููุช.',
      'ุชุฃููู ุงูุญุณุงุจุงุช ุงููุฑุชุจุทุฉ ูุชุบููุฑ ูููุงุช ุงููุฑูุฑ.',
      'ุชูุนูู ุญูุงูุฉ ูุดุฏุฏุฉ ููุฏุฑุฏุดุฉ ูุงูุฎุตูุตูุฉ.',
      'ุฅุจูุงุบ ุงูููุตุฉ ูุงูุฌูุงุช ุงููุฎุชุตุฉ ุญุณุจ ุงูุฅุฌุฑุงุกุงุช.',
    ],
  },
  {
    id: 'account_theft_fraud',
    title: 'ุณุฑูุฉ ุงูุญุณุงุจุงุช ูุงูุงุญุชูุงู',
    icon: '๐',
    severity: AlertSeverity.HIGH,
    severityColor: 'bg-blue-700',
    symptoms: [
      'ุทูุจุงุช ูุชูุฑุฑุฉ ูุฑูุฒ ุงูุชุญูู ุฃู ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ.',
      'ุฑุณุงุฆู ุชูุจูู ุฏุฎูู ูู ุฃุฌูุฒุฉ ุบูุฑ ูุนุฑููุฉ.',
      'ุชุบููุฑุงุช ุบูุฑ ูุจุฑุฑุฉ ูู ุฅุนุฏุงุฏุงุช ุงูุญุณุงุจ.',
    ],
    lurePatterns: [
      'ุตูุญุงุช ุชุณุฌูู ุฏุฎูู ูุฒููุฉ.',
      'ุฑูุงุจุท ุฏุนู ููู ูุฒุนููุฉ ุชุณุญุจ ุจูุงูุงุช ุงูุงุนุชูุงุฏ.',
      'ุงูุชุญุงู ุตูุฉ ุตุฏูู/ููุตุฉ ูุทูุจ ุงูุฃููุงุฏ.',
    ],
    prevention: [
      'ุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA) ุนูู ูู ุงูุญุณุงุจุงุช ุงููููุฉ.',
      'ุงุณุชุฎุฏุงู ูููุงุช ูุฑูุฑ ูุฑูุฏุฉ ููุฏูุฑ ูููุงุช ูุฑูุฑ.',
      'ูุฑุงุฌุนุฉ ุฌูุณุงุช ุงูุฏุฎูู ูุงูุฃุฌูุฒุฉ ุงูููุซููุฉ ุฃุณุจูุนููุง.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุงุณุชุนุงุฏุฉ ุงูุชุญูู', action: 'ุชุฏููุฑ ูููุงุช ุงููุฑูุฑ ูุฅุบูุงู ูู ุงูุฌูุณุงุช.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุชูููุฉ ุงูุชุนุงูู', action: 'ุชุญุฏูุซ ูุณุงุฆู ุงูุงุณุชุฑุฏุงุฏ ูุชุฃููุฏ ุงูุจุฑูุฏ/ุงููุงุชู.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ููุน ุฅุนุงุฏุฉ ุงูุงุฎุชุฑุงู', action: 'ุญุธุฑ ุงูุฑูุงุจุท ุงููุดุจููุฉ ูุชุฏููู ุงูุชุทุจููุงุช.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ุชุซุจูุช ุงูููุงุฑุณุงุช', action: 'ูุญุต ุฃููู ุฏูุฑู ูุฎุชุตุฑ ููุญุณุงุจุงุช.' },
    ],
    dialogues: [
      {
        situation: 'ุงูุชูุฏุฆุฉ',
        opener: 'ูููููุง ุงุณุชุนุงุฏุฉ ุงูุญุณุงุจ ุจุฎุทูุงุช ููุธูุฉุ ูุง ุฏุงุนู ููุฐุนุฑ.',
        advice: 'ุญููู ุงููููู ุฅูู ุฎุทุฉ ุนูููุฉ ูุงุถุญุฉ.',
      },
      {
        situation: 'ุงูุฅุฌุฑุงุก ุงูููุฑู',
        opener: 'ุณูุบูุฑ ูููุงุช ุงููุฑูุฑ ููุบูู ูู ุงูุฃุฌูุฒุฉ ุบูุฑ ุงูููุซููุฉ ุงูุขู.',
        advice: 'ุงูุฃููููุฉ ูุฅููุงู ุงูุฌูุณุงุช ุงููุดุทุฉ ุงููุฎุชุฑูุฉ.',
      },
      {
        situation: 'ุงูุชูุนูุฉ',
        opener: 'ุฃู ุทูุจ ูุฑูุฒ ุงูุชุญูู ูุนุชุจุฑ ุฎุทุฑูุง ุญุชู ูุซุจุช ุงูุนูุณ.',
        advice: 'ุซุจูุช ูุงุนุฏุฉ ุนุฏู ูุดุงุฑูุฉ OTP ูุทูููุง.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ุงุดุชุจุงู ูุญุงููุฉ ุณุฑูุฉ ุญุณุงุจ.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุชู ุชุฏููุฑ ูููุงุช ุงููุฑูุฑ ูุฅุบูุงู ุงูุฌูุณุงุช.',
    ],
    incidentPlan: [
      'ุฅุบูุงู ูู ุงูุฌูุณุงุช ูุชุณุฌูู ุงูุฎุฑูุฌ ูู ูู ุงูุฃุฌูุฒุฉ.',
      'ุชุบููุฑ ูููุงุช ุงููุฑูุฑ ูุชุญุฏูุซ ูุณุงุฆู ุงูุงุณุชุฑุฏุงุฏ.',
      'ูุญุต ุงูุจุฑูุฏ ูุงูุฑุณุงุฆู ูุฑูุงุจุท ุงุญุชูุงู ุฅุถุงููุฉ.',
      'ูุฑุงุฌุนุฉ ุตูุงุญูุงุช ุงูุชุทุจููุงุช ุงูุฎุงุฑุฌูุฉ.',
      'ุชูุซูู ุงูุญุงุฏุซ ูุฑูุน ุจูุงุบ ููููุตุฉ.',
    ],
  },
  {
    id: 'gambling_betting',
    title: 'ุงูููุงูุฑุฉ ูุงููุฑุงููุงุช',
    icon: '๐ฐ',
    severity: AlertSeverity.HIGH,
    severityColor: 'bg-yellow-700',
    symptoms: [
      'ุงูุฏูุงุน ูุญู ุฑูุงูุงุช ุฃู ุตูุงุฏูู ุญุธ ุฏุงุฎู ุงูุฃูุนุงุจ.',
      'ูุญุงููุงุช ุดุฑุงุก ูุชูุฑุฑุฉ ุบูุฑ ูุจุฑุฑุฉ.',
      'ุชูุชุฑ ูุงุถุญ ุจุนุฏ ุงูุฎุณุงุฑุฉ ููุญุงููุฉ ุชุนููุถูุง ููุฑูุง.',
    ],
    lurePatterns: [
      'ููุตุงุช ุชุฑุงูู ุจูุนูุฏ ุฑุจุญ ุณุฑูุน.',
      'ูุคุซุฑูู ูุฑููุฌูู ูููุงุฑ ุฑููู ูููู.',
      'ุฑุจุท ุงูุชูุฏู ูู ุงููุนุจุฉ ุจูุดุชุฑูุงุช ุงุญุชูุงููุฉ.',
    ],
    prevention: [
      'ุฅููุงู ุงููุฏููุนุงุช ุฏุงุฎู ุงูุชุทุจููุงุช ุงูุชุฑุงุถููุง.',
      'ุญุฏ ุฅููุงู ุดูุฑู ูุน ุฅุดุนุงุฑ ููุฑู.',
      'ุชูุนูุฉ ูุงููุฉ ุญูู ููู ุงูุงุณุชุฑุฏุงุฏ ุงูุณุฑูุน.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุชุฌููุฏ ุงููุฎุงุทุฑ', action: 'ุชุนุทูู ุงููุดุชุฑูุงุช ูุงูุจุทุงูุงุช ุงููุฑุชุจุทุฉ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุชูููู ุงูุนุงุฏุฉ', action: 'ุญุธุฑ ุชุทุจููุงุช ุงููุฑุงููุฉ ูุชุชุจุน ูุญูุฒุงุช ุงูุงุณุชุฎุฏุงู.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุจุฏุงุฆู ุตุญูุฉ', action: 'ุฃูุดุทุฉ ุจุฏููุฉ ุชููุฏ ุฅูุฌุงุฒูุง ุบูุฑ ูุงูู.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ุซุจุงุช ุณูููู', action: 'ูุฑุงุฌุนุฉ ุงูุชุฒุงู ุฃุณุจูุนูุฉ ูุน ููู ุงูุฃูุฑ.' },
    ],
    dialogues: [
      {
        situation: 'ุชุตุญูุญ ุงูุชููุน',
        opener: 'ุงูุฑูุงู ููุณ ุงุณุชุซูุงุฑูุงุ ูุบุงูุจูุง ููุชูู ุจุฎุณุงุฑุฉ ุฃูุจุฑ.',
        advice: 'ูุฏูู ุฃูุซูุฉ ุนูููุฉ ุจุฏูู ูุญุงุถุฑุฉ ุทูููุฉ.',
      },
      {
        situation: 'ุงูุญุฏูุฏ',
        opener: 'ูู ุงูููู ูุง ุชูุฌุฏ ุฃู ุนูููุฉ ุดุฑุงุก ุฃู ุฑูุงู ุฏูู ูุฑุงุฌุนุฉ.',
        advice: 'ุญููู ุงูุญุฏูุฏ ุฅูู ุฅุนุฏุงุฏุงุช ุชูููุฉ ุซุงุจุชุฉ.',
      },
      {
        situation: 'ุงูุจุฏูู',
        opener: 'ูุฎุชุงุฑ ูุดุงุทูุง ูุนุทูู ูุชุนุฉ ุจุฏูู ุฎุณุงุฑุฉ ูุงููุฉ.',
        advice: 'ุงูุจุฏุงุฆู ุงูุณุฑูุนุฉ ุชููู ุงูุงูุชูุงุณ.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ูุดุงุท ูุฑุงููุงุช/ูุดุชุฑูุงุช ุงุญุชูุงููุฉ ูุชูุฑุฑ.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุชู ุชูุนูู ุญุฏูุฏ ุงูุฅููุงู ูุญุธุฑ ูุตุงุฏุฑ ุงูุฑูุงู.',
    ],
    incidentPlan: [
      'ุชุฌููุฏ ุงููุดุชุฑูุงุช ูุงููุฏููุนุงุช ููุฑูุง.',
      'ุญุธุฑ ุชุทุจููุงุช ูููุงูุน ุงูุฑูุงู.',
      'ูุฑุงุฌุนุฉ ุณุฌู ุงูุฅููุงู ูุน ููู ุงูุฃูุฑ.',
      'ูุถุน ุฎุทุฉ ุจุฏุงุฆู ููููุฉ ูุตูุฑุฉ.',
      'ูุชุงุจุนุฉ ุฃุณุจูุนูุฉ ููุงูุชุฒุงู.',
    ],
  },
  {
    id: 'privacy_tracking',
    title: 'ุงูุฎุตูุตูุฉ ูุงูุชุชุจุน ุงูุฑููู',
    icon: '๐',
    severity: AlertSeverity.HIGH,
    severityColor: 'bg-teal-700',
    symptoms: [
      'ูุดุงุฑูุฉ ููุฑุทุฉ ูููููุน ุฃู ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ.',
      'ุธููุฑ ุฑูุงุจุท ุชุชุจุน ุฃู ุทูุจุงุช ุตูุงุญูุงุช ุบูุฑ ููุทููุฉ.',
      'ุชุณุฑูุจ ุตูุฑ/ูุนูููุงุช ูููู ุฑุจุทูุง ุจุงููููุฉ.',
    ],
    lurePatterns: [
      'ุฑูุงุจุท ุชุฌูุน ุนููุงู IP ูุงููููุน ุฏูู ุนูู ุงูุทูู.',
      'ุชุทุจููุงุช ุชุฌุณุณ ูุชููุฑุฉ ูุฃุฏูุงุช ูุณุงุนุฏุฉ.',
      'ุงุณุชุฏุฑุงุฌ ูุฌูุน ูุนูููุงุช ุงููุฏุฑุณุฉ/ุงูุณูู/ุงูุฑูุชูู.',
    ],
    prevention: [
      'ุชุนุทูู ูุดุงุฑูุฉ ุงููููุน ุบูุฑ ุงูุถุฑูุฑูุฉ.',
      'ูุฑุงุฌุนุฉ ุฃุฐููุงุช ุงูุชุทุจููุงุช ุฏูุฑููุง.',
      'ุชุฏุฑูุจ ุงูุทูู ุนูู ุฅุฎูุงุก ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูููุดูุฑุงุช.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุชูููู ุงูุงููุดุงู', action: 'ุฅุบูุงู ุตูุงุญูุงุช ุงูุชุชุจุน ูุฅุฒุงูุฉ ุงูุชุทุจููุงุช ุงููุดุจููุฉ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุชูุธูู ุงูุฃุซุฑ', action: 'ุญุฐู ุงูููุดูุฑุงุช ุงูุญุณุงุณุฉ ูุถุจุท ุงูุฎุตูุตูุฉ.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุชูุนูุฉ ุนูููุฉ', action: 'ุชุฏุฑูุจ ุงูุทูู ุนูู ูุญุต ุงูุฑูุงุจุท ูุจู ูุชุญูุง.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ุตูุงูุฉ ูุณุชูุฑุฉ', action: 'ูุฑุงุฌุนุฉ ุฃุณุจูุนูุฉ ุณุฑูุนุฉ ูุฅุนุฏุงุฏุงุช ุงูุฃูุงู.' },
    ],
    dialogues: [
      {
        situation: 'ูุนู ุงูุฎุตูุตูุฉ',
        opener: 'ูุนูููุฉ ุจุณูุทุฉ ุนูู ูุฏ ุชูุณุชุบูุ ูููุญูู ุชูุงุตููู ูู ุงูุขู.',
        advice: 'ุงุฌุนู ุงูุฑุณุงูุฉ ุชูุนููุฉ ูููุณุช ุชุฎููููุฉ.',
      },
      {
        situation: 'ูุญุต ุงูุฌูุงุฒ',
        opener: 'ุณูุฑุงุฌุน ุฃุฐููุงุช ุงูุชุทุจููุงุช ููุบูู ุฃู ุตูุงุญูุฉ ุบูุฑ ุถุฑูุฑูุฉ.',
        advice: 'ุงูุฎุทูุฉ ุงูุชูููุฉ ูุฌุจ ุฃู ุชููู ููุฑูุฉ.',
      },
      {
        situation: 'ุณููู ูููู',
        opener: 'ูุจู ุฃู ูุดุฑ: ูู ูุฐุง ููุดู ูููุนู ุฃู ุจูุงูุงุชูุ',
        advice: 'ุณุคุงู ุจุณูุท ูุฑูุน ุงููุนู ุงููููู.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ูุคุดุฑุงุช ุชุชุจุน/ุงูุชูุงู ุฎุตูุตูุฉ ูุฑุตูุฏุฉ.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุชู ุชูููู ุตูุงุญูุงุช ุงูุชุชุจุน ูุชูุธูู ุงูุฃุซุฑ ุงูุฑููู.',
    ],
    incidentPlan: [
      'ุฅููุงู ูุดุงุฑูุฉ ุงููููุน ูุงูุจูุงูุงุช ุงูุญุณุงุณุฉ.',
      'ุฅุฒุงูุฉ ุงูุชุทุจููุงุช ุงููุดุจููุฉ ููุฑุงุฌุนุฉ ุงูุฃุฐููุงุช.',
      'ุชูุธูู ุงููุญุชูู ุงูููุดูุฑ ุงูุฐู ููุดู ุงููููุฉ.',
      'ุญุธุฑ ุฑูุงุจุท ุงูุชุชุจุน ุงููุนุฑููุฉ.',
      'ูุชุงุจุนุฉ ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ ุฃุณุจูุนููุง.',
    ],
  },
  {
    id: 'harmful_challenges',
    title: 'ุงููุฌููุนุงุช ุงูุถุงุฑุฉ ูุงูุชุญุฏูุงุช ุงูุฎุทุฑุฉ',
    icon: 'โ๏ธ',
    severity: AlertSeverity.CRITICAL,
    severityColor: 'bg-orange-700',
    symptoms: [
      'ุชูุงุนู ูุน ุชุญุฏูุงุช ุชุคุฐู ุงูุฌุณุฏ ุฃู ุงูููุณ.',
      'ุงูุฏูุงุน ูุชุตููุฑ ุณููููุงุช ุฎุทุฑุฉ ูุฅุซุจุงุช ุงูุฐุงุช.',
      'ุถุบุท ุฌูุงุนู ุฑููู ูุฏูุน ูููุฎุงุทุฑุฉ ุงูุนุงููุฉ.',
    ],
    lurePatterns: [
      'ุชุฑูุฏุงุช ุชุญุฑูุถูุฉ ุชุชุญุฏู ุญุฏูุฏ ุงูุณูุงูุฉ.',
      'ูุฌููุนุงุช ูุบููุฉ ุชูุงูุฆ ุงูุณููู ุงูุฎุทุฑ ุจุงููุจูู ุงูุงุฌุชูุงุนู.',
      'ูุญุชูู ูููู ูู ุฎุทูุฑุฉ ุงูุฃุฐู ุงูุญูููู.',
    ],
    prevention: [
      'ุญุธุฑ ุงููุณูู ูุงููููุงุช ุงููุฑุชุจุทุฉ ุจุงูุชุญุฏูุงุช ุงูุฎุทุฑุฉ.',
      'ุชุซููู ุงูุทูู ุจูุงุนุฏุฉ: ูุง ุชุฌุฑุจุฉ ุฃู ุชุญุฏู ุฏูู ููุงููุฉ ุงูุฃุณุฑุฉ.',
      'ุฑูุน ุฅุดุฑุงู ุงููุงูุฏูู ุนูู ุงูููุฏูููุงุช ุงููุตูุฑุฉ.',
    ],
    interventionProgram: [
      { week: 'ุงูุฃุณุจูุน 1', goal: 'ุงุญุชูุงุก ููุฑู', action: 'ุนุฒู ุงูููุตุงุช/ุงููุฌููุนุงุช ุงููุญุฑุถุฉ.' },
      { week: 'ุงูุฃุณุจูุน 2', goal: 'ุชูููู ุงูุชุฃุซูุฑ', action: 'ุฌูุณุฉ ุชุญููู ุถุบุท ุงูุฃูุฑุงู ูููููุฉ ุงูุฑูุถ.' },
      { week: 'ุงูุฃุณุจูุน 3', goal: 'ุจุฏุงุฆู ุงูุชูุงุก', action: 'ุฅุดุฑุงู ุงูุทูู ูู ูุฌููุนุงุช ุขููุฉ ุฅูุฌุงุจูุฉ.' },
      { week: 'ุงูุฃุณุจูุน 4', goal: 'ุชุซุจูุช ุงูุญูุงูุฉ', action: 'ูุฑุงูุจุฉ ุฏูุฑูุฉ ููุชุฑูุฏุงุช ูุงูุชูุงุนู.' },
    ],
    dialogues: [
      {
        situation: 'ููู ุงูุณููู',
        opener: 'ุฃู ุชุญุฏู ูุนุฑูุถู ููุฎุทุฑ ุณูุชููู ููุฑูุงุ ุณูุงูุชู ุฃูููุง.',
        advice: 'ุงูุญุฒู ูุทููุจ ูุน ุงูุญูุงุธ ุนูู ูุบุฉ ุฏุงุนูุฉ.',
      },
      {
        situation: 'ูู ุงูุถุบุท',
        opener: 'ุงูุฑูุถ ููุณ ุถุนููุงุ ุจู ูุฑุงุฑ ุดุฌุงุน ูุญููู.',
        advice: 'ุฃุนุฏ ุชุนุฑูู ุงูุดุฌุงุนุฉ ุจุนูุฏูุง ุนู ุงููุฎุงุทุฑุฉ.',
      },
      {
        situation: 'ุจุฏูู ุขูู',
        opener: 'ูุจุญุซ ุนู ุชุญุฏูุงุช ุฅูุฌุงุจูุฉ ุชุจูู ููุงุฑุงุชู ุจุฏูู ุฃุฐู.',
        advice: 'ุงูุจุฏุงุฆู ุงููุงูุนูุฉ ุชููู ุงูุนูุฏุฉ ูููุฌููุนุงุช ุงูุถุงุฑุฉ.',
      },
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ: ุฑุตุฏ ุชูุงุนู ูุน ุชุญุฏูุงุช ุฎุทุฑุฉ/ูุฌููุนุงุช ุถุงุฑุฉ.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุชู ุนุฒู ุงููุตุงุฏุฑ ูุจุฏุก ุชุฏุฎู ุชุฑุจูู ุนุงุฌู.',
    ],
    incidentPlan: [
      'ุฅููุงู ููุฑู ููุชุญุฏู ุฃู ุงููุดุงุฑูุฉ ุงูุฌุงุฑูุฉ.',
      'ุญุธุฑ ุงููููุงุช/ุงูุญุณุงุจุงุช ุงููุญุฑุถุฉ.',
      'ุฌูุณุฉ ุฏุนู ุนุงุฌูุฉ ูุน ุงูุทูู ุญูู ุถุบุท ุงููุฌููุนุฉ.',
      'ุชูุนูู ุฑูุงุจุฉ ูุตููุฉ ูุตูุฑุฉ ุงููุฏู ุนูู ุงููุญุชูู ุงููุฑุฆู.',
      'ูุชุงุจุนุฉ ููููุฉ ุญุชู ุฒูุงู ูุคุดุฑุงุช ุงูุฎุทุฑ.',
    ],
  },
];

type GuidanceScenarioExtension = {
  symptoms?: string[];
  lurePatterns?: string[];
  prevention?: string[];
  interventionProgram?: InterventionStep[];
  dialogues?: GuidanceScenario['dialogues'];
  alertTemplates?: string[];
  incidentPlan?: string[];
};

const scenarioKnowledgeExtensions: Record<PsychScenarioId, GuidanceScenarioExtension> = {
  bullying: {
    symptoms: [
      'ุงูุฎูุงุถ ููุงุฌุฆ ูู ุงูุชุญุตูู ุฃู ุฑูุถ ุงููุดุงุฑูุฉ ุงูุตููุฉ ุจุนุฏ ูุดุงุท ุฑููู.',
      'ุดูุงูู ูุชูุฑุฑุฉ ูู ุตุฏุงุน ุฃู ุฃุฑู ูุจู ุงูููู ุจุณุจุจ ุงูุชุธุงุฑ ุฑุณุงุฆู ูุณูุฆุฉ.',
      'ุชุฌูุจ ุงูุชูุงุท ุงูุตูุฑ ุฃู ุงูุธููุฑ ูู ูุนุงููุงุช ุจุณุจุจ ุงูุฎูู ูู ุงูุณุฎุฑูุฉ.',
      'ุงุณุชุฎุฏุงู ุนุจุงุฑุงุช ุฌูุฏ ุฐุงุชู ูุซู "ุฃูุง ุงูุณุจุจ" ุฃู "ุฃูุง ูุงุดู".',
      'ุทูุจ ุชุจุฏูู ุงููุฏุฑุณุฉ ุฃู ุงููุฑูู ุฏูู ุชูุณูุฑ ูุงุถุญ ููููุน.',
    ],
    lurePatterns: [
      'ุงุจุชุฒุงุฒ ุงุฌุชูุงุนู ุนุจุฑ ุชูุฏูุฏ ุจูุดุฑ ูุญุงุฏุซุงุช ุฎุงุตุฉ ุฎุงุฑุฌ ุณูุงููุง.',
      'ุชุญููู ุงููุฒุงุญ ุงูุฌูุงุนู ุฅูู ุญููุงุช ุชุดููู ูุณุชูุฑุฉ ููุฌุฏููุฉ.',
      'ุงุณุชูุฒุงุฒ ุงูุทูู ููุฑุฏ ุจุนูู ุซู ุงุณุชุฎุฏุงู ุฑุฏู ุถุฏู ุฃูุงู ุงููุนูููู.',
      'ุงูุชุญุงู ุดุฎุตูุฉ ุฒููู ููุฑุจ ูุฌูุน ูุนูููุงุช ุญุณุงุณุฉ ุซู ุชุณุฑูุจูุง.',
      'ุงุณุชุฎุฏุงู ุงุณุชุทูุงุนุงุช ุฃู "ุชุตููุชุงุช" ูุฅุฐูุงู ุงูุทูู ุนูููุง.',
    ],
    prevention: [
      'ุงุชูุงู ุฃุณุฑู ูุงุถุญ: ุฃู ุฅุณุงุกุฉ ุฑูููุฉ ุชูุจูุบ ุฎูุงู ููุณ ุงูููู ุจุฏูู ุนููุจุฉ ุนูู ุงูุฅุจูุงุบ.',
      'ุชุฌููุฒ ุฑุฏูุฏ ูุตูุฑุฉ ุฌุงูุฒุฉ ููุฑูุถ: "ูุฐุง ุบูุฑ ููุจูู" ุซู ุงูุญุธุฑ ุฏูู ููุงุด.',
      'ูุฑุงุฌุนุฉ ุฃุณุจูุนูุฉ ูุณุฌู ุงูุชูุจููุงุช ูุน ุงููุฏุฑุณุฉ ุนูุฏ ูุฌูุฏ ุชูุงุทุน ูุงูุนู.',
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ูุคุดุฑุงุช ุชููุฑ ููุชุฏ ุนุจุฑ ุฃูุซุฑ ูู ููุตุฉ ูุน ุฃุซุฑ ููุณู ูุงุถุญ.',
    ],
    incidentPlan: [
      'ุชูุซูู ุงูุณูุงู ุงููุงูู (ูุจู/ุฃุซูุงุก/ุจุนุฏ ุงูุฅุณุงุกุฉ) ุจุฏู ููุทุฉ ููุฑุฏุฉ ููุท.',
      'ุชูุณูู ููุงุฉ ุงุชุตุงู ูุงุญุฏุฉ ุจูู ุงูููุฒู ูุงููุฏุฑุณุฉ ูููุน ุชุถุงุฑุจ ุงูุฑุณุงุฆู.',
    ],
    dialogues: [
      {
        situation: 'ุฅุฒุงูุฉ ุงูุดุนูุฑ ุจุงูุฐูุจ',
        opener: 'ุญุชู ูู ุฑุฏุฏุช ุจุนุตุจูุฉุ ุงููุณุคูููุฉ ุงูุฃุณุงุณูุฉ ุนูู ูู ุจุฏุฃ ุงูุฃุฐู.',
        advice: 'ุงูุตู ุจูู ุงูุณููู ูุฑุฏ ุงููุนู ุญุชู ูุง ูุญูู ุงูุทูู ุนุจุฆูุง ูุงูููุง.',
      },
      {
        situation: 'ุงุณุชุนุงุฏุฉ ุงูุชุญูู',
        opener: 'ุณูุถุน ุฎุทุฉ ูู 3 ุฎุทูุงุช ุงูููู ูู ุชุดุนุฑ ุฃูู ูุณูุทุฑ ุนูู ุงููููู.',
        advice: 'ุฅุนุทุงุก ุงูุทูู ุฏูุฑูุง ุนููููุง ูููู ุงูุนุฌุฒ ููุฒูุฏ ุงูุงูุชุฒุงู.',
      },
    ],
  },
  threat_exposure: {
    symptoms: [
      'ุชุฌูุจ ูุชุญ ุงููุงููุฑุง ุฃู ุงููููุฑูููู ุฑุบู ุงุนุชูุงุฏู ุงูุณุงุจู ุนูู ุฐูู.',
      'ููู ุดุฏูุฏ ุนูุฏ ุทูุจ ุฑูุฒ ุชุญูู ุฃู ุฃู ุจูุงูุงุช ูุงููุฉ.',
      'ุทูุจ ุญุฐู ุงูุญุณุงุจุงุช ุจุงููุงูู ูุฌุฃุฉ ุฏูู ุณุจุจ ุชููู ูุงุถุญ.',
      'ููุจุงุช ุจูุงุก ุฃู ุงุฑุชุจุงู ุจุนุฏ ููุงููุงุช ูุตูุฑุฉ ูู ุฃุฑูุงู ุบูุฑ ูุญููุธุฉ.',
      'ุฑูุถ ุงูุญุฏูุซ ุนู ุดุฎุต/ุญุณุงุจ ุจุนููู ูุน ุชุบูุฑ ูุจุฑุฉ ุงูุตูุช.',
    ],
    lurePatterns: [
      'ุฌูุน ูุนูููุงุช ุชุฏุฑูุฌููุง ุซู ุงูุงูุชูุงู ุงูุณุฑูุน ุฅูู ูุบุฉ ุชูุฏูุฏ.',
      'ุงุฏุนุงุก ุงูุชูุงู ุตูุฑ/ุจูุงูุงุช ุฅุถุงููุฉ ูุฅุฌุจุงุฑ ุงูุทูู ุนูู ุงูุงูุชุซุงู.',
      'ุทูุจ ุชูููุฐ ููุงู ูุชุตุงุนุฏุฉ ุฒููููุง ุชุญุช ุถุบุท ุงูุนุฏู ุงูุชูุงุฒูู.',
      'ุงุณุชุบูุงู ุฃุณุฑุงุฑ ุนุงุฆููุฉ ุฃู ูุฏุฑุณูุฉ ูุฎูู ุฎูู ูู ุงููุถูุญุฉ.',
      'ุชุญููู ุงูุงุจุชุฒุงุฒ ูู ุฑููู ุฅูู ูุงูุนู ุนุจุฑ ุชูุฏูุฏ ุจุงููุตูู ูููุญูุท ุงููุฑูุจ.',
    ],
    prevention: [
      'ูุงุนุฏุฉ ุฃุณุงุณูุฉ: ุฃู ุฑุณุงูุฉ ุชูุฏูุฏ ุชูุญููู ูุจุงุดุฑุฉ ูููู ุงูุฃูุฑ ุฏูู ุฑุฏ.',
      'ุฅุฎูุงุก ุจูุงูุงุช ุงูุชูุงุตู ุงูุนุงุฆููุฉ ูู ุงูุญุณุงุจุงุช ุงูุนุงูุฉ ุจุงููุงูู.',
      'ุชูุฑูู ุนููู ุดูุฑู ุนูู ุณููุงุฑูู ุงุจุชุฒุงุฒ ูููู ูุฎุทูุงุช ุงูุงุณุชุฌุงุจุฉ.',
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ: ุฑุตุฏ ููุท ุชูุฏูุฏ ูุจุงุดุฑ ูุน ูุทุงูุจ ุชุตุนูุฏูุฉ ุฒูููุฉ.',
    ],
    incidentPlan: [
      'ุชุซุจูุช ูููุฉ ุงููุจุชุฒ (ูุนุฑููุงุช ุงูุญุณุงุจ/ุงูุฑูู/ุงูุจุตูุฉ ุงูุฒูููุฉ) ูุจู ุฃู ุฅุฌุฑุงุก ูุงุณุน.',
      'ูุตู ุงูุญุณุงุจุงุช ุงูุญุฑุฌุฉ ุนู ุงูุฌูุงุฒ ุงููุนุฑูุถ ูุญูู ุงูุชูุงู ุงูุงุญุชูุงุก.',
    ],
    dialogues: [
      {
        situation: 'ุชูููู ุงูุฎูู',
        opener: 'ูุบุฉ ุงูุชูุฏูุฏ ูุตููุฉ ูุฅุฑุจุงููุ ููู ูุฏููุง ุฎุทุฉ ุฃููู ูู ูุฐุง ุงูุถุบุท.',
        advice: 'ุณููู ุงููุฏู ุงูููุณู ูููุจุชุฒ ุญุชู ูููุฏ ุชุฃุซูุฑู.',
      },
      {
        situation: 'ูุฑุงุฑ ุนุฏู ุงูุฏูุน',
        opener: 'ุงูุฏูุน ูุง ูููู ุงูุงุจุชุฒุงุฒ ุบุงูุจูุงุ ูุฐูู ุณูุญููู ุจุทุฑู ุตุญูุญุฉ.',
        advice: 'ูุฏูู ุงูุจุฏูู ุงูุนููู ููุฑูุง ุญุชู ูุง ูุจุฏู ุงููุฑุงุฑ ูุธุฑููุง ููุท.',
      },
    ],
  },
  gaming: {
    symptoms: [
      'ุชุฃุฎุฑ ูุชูุฑุฑ ูู ุงูููู ูุชุจุนู ุฅุฑูุงู ุตุจุงุญู ูุงุถุญ.',
      'ููุฏุงู ุงูุงูุชูุงู ุจุฃูุดุทุฉ ูุงู ูุณุชูุชุน ุจูุง ุฎุงุฑุฌ ุงูุดุงุดุฉ.',
      'ุงููุนุงู ุดุฏูุฏ ุนูุฏ ุฃู ุงููุทุงุน ุฅูุชุฑูุช ุฃู ููุฏุงู ุฌููุฉ.',
      'ุชุฑุงุฌุน ุงูุนูุงูุงุช ุงูุฃุณุฑูุฉ ุจุณุจุจ ุงูุงุฑุชุจุงุท ุงููุณุชูุฑ ุจุงููุนุจุฉ.',
      'ุงููุฐุจ ุญูู ูุฏุฉ ุงูุงุณุชุฎุฏุงู ุฃู ุงูุฅููุงู ุฏุงุฎู ุงููุนุจุฉ.',
    ],
    lurePatterns: [
      'ุฃูุธูุฉ ููุงูุขุช ูุชูุทุนุฉ ุชุฏูุน ููุนูุฏุฉ ุงููุชูุฑุฑุฉ ุฏูู ุชููู.',
      'ุถุบุท ุงููุฑูู/ุงูุนุดูุฑุฉ ููุญุถูุฑ ุงููููู ุฎูููุง ูู ุงูุทุฑุฏ.',
      'ุนุฑูุถ ููุณููุฉ ูุญุฏูุฏุฉ ุงูููุช ุชุฎูู ุดุนูุฑ "ุงููุฑุตุฉ ุงูุฃุฎูุฑุฉ".',
      'ุฑุจุท ุงูููุงูุฉ ุงูุงุฌุชูุงุนูุฉ ุงูุฑูููุฉ ุจุนุฏุฏ ุงูุณุงุนุงุช ุฃู ุงููุดุชุฑูุงุช.',
      'ุฑุณุงุฆู ุฅุดุนุงุฑ ูุตููุฉ ูุฅุนุงุฏุฉ ุชูุดูุท ุงูุทูู ุจุนุฏ ุฃู ุงููุทุงุน.',
    ],
    prevention: [
      'ุชุซุจูุช ุฌุฏูู ูุนุจ ูุฑุฆู ููุชูู ุนููู ูุน ูุชุฑุงุช ุฑุงุญุฉ ุฅูุฒุงููุฉ.',
      'ุฑุจุท ุงูุงุณุชูุฑุงุฑ ูู ุงููุนุจ ุจูุคุดุฑุงุช ุชูุงุฒู: ูููุ ุฏุฑุงุณุฉุ ุญุฑูุฉ ุจุฏููุฉ.',
      'ุชุนุทูู ุงูุฅุดุนุงุฑุงุช ุงูุฌุงุฐุจุฉ ุฎุงุฑุฌ ูุงูุฐุฉ ุงููุนุจ ุงููุญุฏุฏุฉ.',
    ],
    alertTemplates: [
      'ุชูุจูู ูุชูุณุท: ุงุฑุชูุงุน ููุท ุงููุนุจ ุงูููุฑู ูุน ุฃุซุฑ ุนูู ุงูููู ูุงูุงูุถุจุงุท.',
    ],
    incidentPlan: [
      'ุชูุนูู "ุชูุฏุฆุฉ 48 ุณุงุนุฉ" ูุน ุจุฏุงุฆู ููุชุนุฉ ูููุณ ููุนูุง ุนูุงุจููุง ููุท.',
      'ุชุญููู ูุญุธุงุช ุงูุฐุฑูุฉ (ูุชู/ููุงุฐุง) ูุฅุนุงุฏุฉ ุชุตููู ุงูุฑูุชูู ุงููููู.',
    ],
    dialogues: [
      {
        situation: 'ุงุชูุงู ูุงูุนู',
        opener: 'ูู ููุบู ุงููุนุจุ ุณูุถุจุทู ููุฎุฏูู ุจุฏู ูุง ูุณุชูููู.',
        advice: 'ุงูุฑุณุงูุฉ ุงููุชูุงุฒูุฉ ุชููู ููุงููุฉ ุงูุทูู ููุชุบููุฑ.',
      },
      {
        situation: 'ุฅุฏุงุฑุฉ ุงูุงูุชูุงุณุฉ',
        opener: 'ุฅุฐุง ุฒุงุฏุช ุงูุณุงุนุงุช ููููุงุ ูุตุญุญ ุงูููู ุงูุชุงูู ุจุฏูู ุฌูุฏ ุฐุงุช.',
        advice: 'ุฎุทุท ุงูุชุนุงูู ุงูุณุฑูุนุฉ ุฃูุถู ูู ุงูุตุฑุงูุฉ ุบูุฑ ุงููุงุจูุฉ ููุงุณุชูุฑุงุฑ.',
      },
    ],
  },
  inappropriate_content: {
    symptoms: [
      'ูุถูู ููุฑู ููุจุญุซ ุนู ูุญุชูู ุฃูุซุฑ ุตุฏูุฉ ูุน ุงูููุช.',
      'ุชุทุจูุน ูุบูู ููุดุงูุฏ ุนูู/ุฅูุญุงุกุงุช ูู ุชูู ูุฃูููุฉ ุณุงุจููุง.',
      'ุงุณุชุฎุฏุงู ูุถุน ุงูุชุตูุญ ุงูุฎูู ุจุดูู ูููู ููุฑุท.',
      'ุชุบูุฑ ุตูุฑุฉ ุงูุฌุณุฏ ุฃู ุงูุนูุงูุงุช ูุชูุฌุฉ ููุงุฑูุฉ ุบูุฑ ุตุญูุฉ.',
      'ุชุฑุงุฌุน ุนุชุจุฉ ุงูุชุนุงุทู ูุน ูุดุงูุฏ ุงูุฅูุฐุงุก ุฃู ุงูุฅุฐูุงู.',
    ],
    lurePatterns: [
      'ุฎูุงุฑุฒููุงุช ุชูุชุฑุญ ูุญุชูู ุฃูุซุฑ ุญุฏุฉ ุจุนุฏ ูู ูุดุงูุฏุฉ ูุตูุฑุฉ.',
      'ุนูุงููู ุตุงุฏูุฉ ุชุณุชุฎุฏู ุงููุถูู ูุจูุงุจุฉ ุงูุชูุงู ุชุฏุฑูุฌู.',
      'ุฑูุงุจุท "ูููุจุงุฑ ููุท" ุชูุชุฏุงูู ุฏุงุฎู ูุฌููุนุงุช ุฃูุฑุงู ูุบููุฉ.',
      'ุชุญุฏูุงุช ูุดุงูุฏุฉ ูุชุทุฑูุฉ ูููุงุณ "ุงูุฌุฑุฃุฉ" ุจูู ุงูุฃุตุฏูุงุก.',
      'ุฏูุฌ ุงููุญุชูู ุงูุฅุจุงุญู/ุงูุนููู ุฏุงุฎู ููุงุทุน ุชุจุฏู ุชุฑููููุฉ ุจุงูุจุฏุงูุฉ.',
    ],
    prevention: [
      'ุชุทุจูู SafeSearch ูDNS ุนุงุฆูู ูุน ูุฑุงุฌุนุฉ ุดูุฑูุฉ ููุนุงููุชู.',
      'ุญูุงุฑ ุชุซูููู ุนู ุงูุญุฏูุฏ ุงูุฑูููุฉ ุจุฏู ุงูุงูุชุตุงุฑ ุนูู ุงูููุน.',
      'ุฑุจุท ุฃู ุฎุฑู ูููุงุนุฏ ุงููุญุชูู ุจุฎุทุฉ ุชุนูู ุชุนููุถูุฉ ูุตูุฑุฉ.',
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ุชูุฑุงุฑ ุชุนุฑุถ ููุญุชูู ุบูุฑ ููุงุณุจ ูุน ุชุบููุฑ ุณูููู ูุฑุงูู.',
    ],
    incidentPlan: [
      'ุชุญุฏูุฏ ูุตุฏุฑ ุงูุงููุดุงู (ุจุญุซ/ุงูุชุฑุงุญ/ุฑุงุจุท ุตุฏูู) ูุจู ูุถุน ุงูุนูุงุฌ.',
      'ุฅุนุงุฏุฉ ุชููุฆุฉ ุงูุชูุตูุงุช ุนุจุฑ ูุณุญ ุงูุณุฌู ูุงูุชูุงุนู ุงูุฅูุฌุงุจู ุงูุจุฏูู.',
    ],
    dialogues: [
      {
        situation: 'ุญูุงุฑ ุจูุง ูุตู',
        opener: 'ุณุฃุดุฑุญ ูู ููุงุฐุง ูุฐุง ุงููุญุชูู ูุคุฐูู ุฏูู ุชุฎููู ุฃู ุฅูุงูุฉ.',
        advice: 'ุงูุชุฑููุฒ ุนูู ุงูุฃุซุฑ ูุญุงูุธ ุนูู ุงูุซูุฉ ุฃูุซุฑ ูู ุงูุชุฎุฌูู.',
      },
      {
        situation: 'ุชุตุญูุญ ุงูููุงููู',
        opener: 'ููุณ ูู ูุง ููุนุฑุถ ุทุจูุนููุง ุฃู ุตุญููุงุ ุฎูููุง ูููู ุงูุฑุณุงุฆู ูุนูุง.',
        advice: 'ุจูุงุก ุงูุชูููุฑ ุงูููุฏู ูููู ุงูุนูุฏุฉ ุงูุนูููุฉ ูููุญุชูู ุงููุคุฐู.',
      },
    ],
  },
  cyber_crime: {
    symptoms: [
      'ุงูุชูุงู ููุงุฌุฆ ุจุฃุฏูุงุช ุงุฎุชุฑุงู ุฃู ุณูุฑุจุชุงุช ุบูุฑ ูููููุฉ ููุนูุฑ.',
      'ูุญุงููุงุช ูุชูุฑุฑุฉ ูุชุฌุงูุฒ ุตูุงุญูุงุช ุงูุชุทุจููุงุช ุฃู ุงููุฏุฑุณุฉ.',
      'ุชุจุงูู ุจู"ุงุฎุชุจุงุฑ ุงูุฃูุธูุฉ" ุฏูู ููู ุงูุนูุงูุจ ุงููุงููููุฉ.',
      'ุงูุงูุฎุฑุงุท ูู ูุฌุชูุนุงุช ุชุชุจุงุฏู ุฃุฏูุงุช ูุฌูู ุฃู ุชุณุฑูุจ ุจูุงูุงุช.',
      'ุชุฌุงุฑุจ ุนูู ุญุณุงุจุงุช ุงูุฃุตุฏูุงุก ุจุฏุนูู ุงููุฒุงุญ ุงูุชููู.',
    ],
    lurePatterns: [
      'ูุฌุชูุนุงุช ุชุนุฑุถ "ุฃุฏูุงุช ูุฌุงููุฉ" ููุงุจู ุชุฌุฑุจุฉ ุนูู ุฃูุฏุงู ุญููููุฉ.',
      'ูุนูุฏ ุจุงูููุจุฉ ุงูุฑูููุฉ ููุงุจู ุชูููุฐ ููุงู ูุฌูู ุจุณูุทุฉ.',
      'ุชุญุฏูุงุช ุงุฎุชุฑุงู ูุฏุฑุณูุฉ/ุฃูุนุงุจ ุชููุญ ุดูุฑุฉ ุฒุงุฆูุฉ ุณุฑูุนุฉ.',
      'ุจูุน ุจูุงูุงุช ุฃู ุญุณุงุจุงุช ูุณุฑููุฉ ุฏุงุฎู ูููุงุช ุดุจู ูุบููุฉ.',
      'ุชุญููู ุงููุถูู ุงูุชููู ููุณุงุฑ ุนุฏุงุฆู ุนุจุฑ ูุฏูุฉ ููุญุฑูุฉ.',
    ],
    prevention: [
      'ุชุญููู ุงููุถูู ููุณุงุฑ ูุงูููู: CTF ุขููุ ุจุฑูุฌุฉ ุฏูุงุนูุฉุ ุฃูู ุฃุฎูุงูู.',
      'ุชูุถูุญ ุงูุนูุงูุจ ุงููุงููููุฉ ุงููุงูุนูุฉ ุจูุบุฉ ุนูุฑูุฉ ูุงุถุญุฉ.',
      'ูุชุงุจุนุฉ ูุฌุชูุนุงุช ุงูุทูู ุงูุชูููุฉ ูุชูููู ูุจุฑุฉ ุงููุญุชูู ุฏูุฑููุง.',
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ูุคุดุฑุงุช ุงูุชูุงู ูู ูุถูู ุชููู ุฅูู ุณููู ุงุฎุชุฑุงูู ุชูููุฐู.',
    ],
    incidentPlan: [
      'ุนุฒู ุงูุฃุฏูุงุช ุงููุดุจููุฉ ูุชุฌููุฏ ุจูุฆุฉ ุงูุชูููุฐ ููุฑูุง.',
      'ุฅุนุฏุงุฏ ูุณุงุฑ ุจุฏูู ุฑุณูู ูุชุนูู ุงูุฃูู ุงูุณูุจุฑุงูู ุงูุฃุฎูุงูู.',
    ],
    dialogues: [
      {
        situation: 'ุชุญููู ุงููุณุงุฑ',
        opener: 'ููุงุฑุชู ุงูุชูููุฉ ูููุฉุ ููุฑูุฏูุง ูู ูุณุงุฑ ูุญูู ุงููุงุณ ูุง ูุคุฐููู.',
        advice: 'ุงุนุชุฑู ุจุงููุฏุฑุฉ ุซู ุฃุนุฏ ุชูุฌูููุง ุจุฏู ุดูุทูุฉ ุงูุทูู.',
      },
      {
        situation: 'ูุนู ูุงูููู',
        opener: 'ุจุนุถ ุงูุฃูุนุงู ุงูุฑูููุฉ ุชูุณุฌููู ูุงูููููุง ุญุชู ูู ูุงูุช "ุชุฌุฑุจุฉ".',
        advice: 'ุงุฑุจุท ุงููุงููู ุจุฃูุซูุฉ ุนูููุฉ ุญุชู ูููู ููููุณูุง.',
      },
    ],
  },
  phishing_links: {
    symptoms: [
      'ุงูุถุบุท ุนูู ุฑูุงุจุท ูุฌูููุฉ ูุจู ุงูุชุญูู ูู ุงููุตุฏุฑ.',
      'ุฅุฏุฎุงู ุจูุงูุงุช ุญุณุงุจ ูู ุตูุญุงุช ุชุดุจู ุงูุฃุตู ูุน ูุฑูู ุทูููุฉ.',
      'ูุดุงุฑูุฉ ุฑูุฒ ุชุญูู ููุฑุฉ ูุงุญุฏุฉ ุจุนุฏ ุฑุณุงูุฉ ุฅููุงุน ูุณุชุนุฌูุฉ.',
      'ููุฏุงู ูุตูู ูุคูุช ููุญุณุงุจุงุช ุจุนุฏ ููุฑ ุฑุงุจุท ูุตูุฑ.',
      'ุชุฒุงูุฏ ุฑุณุงุฆู "ุงุณุชุนุงุฏุฉ ุงูุญุณุงุจ" ุฏูู ุณุจุจ ูุนุฑูู.',
    ],
    lurePatterns: [
      'ุฑุณุงุฆู ุนุงุฌูุฉ ุชุฏูุนู ุชุนููู ุงูุญุณุงุจ ูุชุชุทูุจ ุฅุฌุฑุงุก ููุฑููุง.',
      'ุฌูุงุฆุฒ ููููุฉ ูุฑุชุจุทุฉ ุจุชุณุฌูู ุฏุฎูู ุนุจุฑ ุตูุญุฉ ูุฒููุฉ.',
      'ุงูุชุญุงู ุตูุฉ ุตุฏูู ูุน ุฑุงุจุท "ููู ุฌุฏูุง" ุฎุงุฑุฌ ุงูุณูุงู ุงููุนุชุงุฏ.',
      'ุงุฎุชุตุงุฑุงุช ุฑูุงุจุท ุชุฎูู ุงููุฌูุฉ ุงูุญููููุฉ ููุตูุญุฉ.',
      'ููุงูุฐ ุฏูุน ุฃู ุชุญุฏูุซ ุฃูุงู ูุฒููุฉ ุชุญุตุฏ ุจูุงูุงุช ุงูุจุทุงูุฉ.',
    ],
    prevention: [
      'ูุงุนุฏุฉ ุงูุฑุงุจุท ุงูุขูู: ุงูุญุต ุงููุทุงู ูุจู ุฃู ุฅุฏุฎุงู ุจูุงูุงุช.',
      'ููุน ุฅุฏุฎุงู OTP ุฎุงุฑุฌ ุงูุชุทุจูู ุงูุฑุณูู ูููุง ูุงูุช ุงูุฑุณุงูุฉ ูููุนุฉ.',
      'ุงุณุชุฎุฏุงู ูุฏูุฑ ูููุงุช ูุฑูุฑ ูุง ูููุฃ ุงูููุงุฐุฌ ุนูู ูุทุงู ูุฒูู.',
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ: ุงุญุชูุงู ุชุตูุฏ ูุดุท ุจุนุฏ ูุดุงุฑูุฉ ุจูุงูุงุช ุฃู ุฑูุฒ ุชุญูู.',
    ],
    incidentPlan: [
      'ุชุบููุฑ ูููุงุช ุงููุฑูุฑ ูู ุฌูุงุฒ ููุซูู ุบูุฑ ูุตุงุจ.',
      'ุฅุบูุงู ุฌููุน ุงูุฌูุณุงุช ุงููุดุทุฉ ููุฑุงุฌุนุฉ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ุจุงูุญุณุงุจ.',
    ],
    dialogues: [
      {
        situation: 'ุฅููุงู ุงูุงูุฏูุงุน',
        opener: 'ุฃู ุฑุณุงูุฉ ูุณุชุนุฌูุฉ ูู ุฅุดุงุฑุฉ ุชูููุ ูููุณุช ุฅุดุงุฑุฉ ุชูููุฐ.',
        advice: 'ุฒุฑุน ุนุงุฏุฉ "ุชููู 30 ุซุงููุฉ" ูุจู ุงูููุฑ ูููู ุงูุญูุงุฏุซ ูุซูุฑูุง.',
      },
      {
        situation: 'ุชุนูู ูู ุงูุญุงุฏุซ',
        opener: 'ุงูุฎุทุฃ ูุงุจู ููุฅุตูุงุญุ ูุงูููู ุฃู ูุชุนูู ููุท ุงูุฎุฏุงุน ุงููุงุฏู.',
        advice: 'ุญูู ุงูุญุงุฏุซ ุฅูู ุชูุฑูู ูุนุฑูู ูููุณ ูุญุธุฉ ุชุฃููุจ.',
      },
    ],
  },
  crypto_scams: {
    symptoms: [
      'ุญุฏูุซ ูุชูุฑุฑ ุนู ุฃุฑุจุงุญ ุณุฑูุนุฉ ูุถูููุฉ ุฏูู ูุฎุงุทุฑ.',
      'ุงูุงูุถูุงู ููููุงุช ุชูุตูุงุช ุงุณุชุซูุงุฑูุฉ ูุฌูููุฉ ุงููููุฉ.',
      'ุชุญูููุงุช ุตุบูุฑุฉ ุชุฌุฑูุจูุฉ ุชุชุฒุงูุฏ ุชุฏุฑูุฌููุง ุฏูู ุฅุดุฑุงู.',
      'ุถุบุท ููุณู ุนูุฏ ููุงุช "ูุฑุตุฉ ุนููุฉ" ูุฒุนููุฉ.',
      'ุชูุฑุงุฑ ูููุงุช ุชุณููููุฉ ูุซู "ูุคูุฏ/ูุถููู/ุณุฑู".',
    ],
    lurePatterns: [
      'ูุฌููุนุงุช ุชุถุฎ ุนููุฉ ุซู ุชุฏุนู ููุจูุน ุนูู ุงููุชุงุจุนูู ุงููุชุฃุฎุฑูู.',
      'ููุตุงุช ููููุฉ ุชุนุฑุถ ุฃุฑุจุงุญูุง ูุตุทูุนุฉ ุฏุงุฎู ููุญุฉ ูุฒููุฉ.',
      'ูุนูุฏ ุงุณุชุฑุฏุงุฏ ุฎุณุงุฆุฑ ุณุฑูุนุฉ ููุงุจู ุชุญููู ุฅุถุงูู.',
      'ุงูุชุญุงู ุฎุจูุฑ ุชุฏุงูู ูุน ููุทุงุช ุฃุฑุจุงุญ ููุจุฑูุฉ.',
      'ุงุณุชุฎุฏุงู ูุคุซุฑูู ุตุบุงุฑ ูุฅุถูุงุก ุดุฑุนูุฉ ููููุฉ ุนูู ุงููุดุฑูุน.',
    ],
    prevention: [
      'ููุน ุฃู ุชุญููู ูุงูู ุฏูู ูุฑุงุฌุนุฉ ููู ุงูุฃูุฑ ุงููุณุจูุฉ.',
      'ุชุทุจูู ูุงุนุฏุฉ: ุฅุฐุง ุจุฏุง ุงูุฑุจุญ ุบูุฑ ููุทูู ููู ุบุงูุจูุง ุงุญุชูุงู.',
      'ุญุตุฑ ุงูุชุนูู ุงููุงูู ูู ููุตุงุช ุชุนููููุฉ ููุซููุฉ ููุท.',
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ูุคุดุฑุงุช ุงุญุชูุงู ูุงูู ุฑููู ูุน ูุงุจููุฉ ุฎุณุงุฑุฉ ูุจุงุดุฑุฉ.',
    ],
    incidentPlan: [
      'ุชุฌููุฏ ุฃู ุชุญูููุงุช ุฅุถุงููุฉ ููุฑูุง ุญุชู ุงูุชูุงู ุงูุชุญูู.',
      'ุชูุซูู ุงููุญุงูุธ/ุงูุนูุงููู/ุงููุนุฑูุงุช ูุจู ูุญุงููุฉ ุงูุงุณุชุฑุฏุงุฏ.',
    ],
    dialogues: [
      {
        situation: 'ุชูููู ุงูููู',
        opener: 'ุงููุญุชุงู ูุจูุน ุงูุณุฑุนุฉุ ุจูููุง ุงูุงุณุชุซูุงุฑ ุงูุญูููู ูุจูุน ุงูุงูุถุจุงุท.',
        advice: 'ุถุน ููุงุฑูุฉ ูุจุงุดุฑุฉ ุจูู ุงููุนุฏ ุงูุงุญุชูุงูู ูุงููุณุงุฑ ุงูุตุญูุญ.',
      },
      {
        situation: 'ุญูุงูุฉ ูุณุชูุจููุฉ',
        opener: 'ุณูุจูู ูู ูุงุฆูุฉ ุชุญูู ูุจู ุฃู ูุฑุงุฑ ูุงูู ุนูู ุงูุฅูุชุฑูุช.',
        advice: 'ูุฌูุฏ Checklist ูุฎูู ูุฑุงุฑุงุช ุงูุงูุฏูุงุน ุงููุญุธู.',
      },
    ],
  },
  self_harm: {
    symptoms: [
      'ููุดูุฑุงุช ุชุญูู ูุฃุณูุง ุฃู ุงูุนุฏุงู ูููุฉ ุงูุฐุงุช ุจุดูู ูุชูุฑุฑ.',
      'ุงูุนุฒุงู ุญุงุฏ ูุน ุชุฑุงุฌุน ุงูุนูุงูุฉ ุจุงูููุณ.',
      'ุงูุชุฎูุต ูู ุฃุดูุงุก ูุญุจุจุฉ ุฃู ุฑุณุงุฆู ูุฏุงุนูุฉ ูุจุทูุฉ.',
      'ุงุถุทุฑุงุจ ุฃูู/ููู ุญุงุฏ ูุฑุชุจุท ุจุญุงูุฉ ููุณูุฉ ูุชุฏููุฑุฉ.',
      'ุจุญุซ ุนู ุทุฑู ุฅูุฐุงุก ุฃู ูุฌููุนุงุช ุชุดุฌุน ุงูุณููู ุงููุคุฐู.',
    ],
    lurePatterns: [
      'ูุฌุชูุนุงุช ุชูุฌูุฏ ุงูุฃูู ุงูููุณู ูุชุทุจุน ุฅูุฐุงุก ุงูุฐุงุช.',
      'ูุญุชูู ุจุตุฑู ูุญููุฒ ููุฏู ุงูุฅูุฐุงุก ูุญู ููุชุฎููู.',
      'ุฃูุฑุงู ูุฏูุนูู ููุชุญุฏูุงุช ุงููุคุฐูุฉ ุชุญุช ุดุนุงุฑ "ุฅุซุจุงุช ุงูููุฉ".',
      'ุฑุณุงุฆู ุชุนุฒู ุงูุทูู ุนู ูุตุงุฏุฑ ุงูุฏุนู ุงูุญูููู.',
      'ุณุฑุฏูุงุช ุฑููุงูุณูุฉ ุชุฑุจุท ุงููุนุงูุงุฉ ุจุงููููุฉ ุงูุดุฎุตูุฉ.',
    ],
    prevention: [
      'ุฎุทุฉ ุฃูุงู ุดุฎุตูุฉ ููุชูุจุฉ ูุน ุฌูุงุช ุงุชุตุงู ููุฑูุฉ ูุงุถุญุฉ.',
      'ูุฑุงูุจุฉ ุฅุดุงุฑุงุช ุงูุชุฏููุฑ ุงููููู (ููู/ูุฒุงุฌ/ุดููุฉ/ุงูุณุญุงุจ).',
      'ุฅุญุงูุฉ ูุฎุชุต ููุณู ูุจูุฑ ุนูุฏ ุฃู ุฅุดุงุฑุฉ ุญุฑุฌุฉ ูุชูุฑุฑุฉ.',
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ ุฌุฏูุง: ูุคุดุฑุงุช ุฅูุฐุงุก ุฐุงุชู ุชุชุทูุจ ุชุฏุฎููุง ููุณููุง ููุฑููุง.',
    ],
    incidentPlan: [
      'ุฅุฒุงูุฉ ุงููุณุงุฆู ุงููุญุชููุฉ ููุฅูุฐุงุก ูู ุงูุจูุฆุฉ ุงููุฑูุจุฉ ูุจุงุดุฑุฉ.',
      'ุนุฏู ุชุฑู ุงูุทูู ูุญูุฏูุง ุนูุฏ ูุฌูุฏ ูุคุดุฑุงุช ุฎุทุฑ ุญุงุฏุฉ.',
    ],
    dialogues: [
      {
        situation: 'ุฃูุงู ููุฑู',
        opener: 'ุณูุงูุชู ุฃูู ูู ุฃู ุดูุก ุงูุขูุ ูุณุฃุจูู ูุนู ุฎุทูุฉ ุจุฎุทูุฉ.',
        advice: 'ุงูุฑุณุงูุฉ ุงูุฃููู ูุฌุจ ุฃู ุชููู ุฃูุงููุง ูุง ุชุญููููุง.',
      },
      {
        situation: 'ุทูุจ ุงููุณุงุนุฏุฉ',
        opener: 'ุทูุจ ุงููุณุงุนุฏุฉ ุงูุทุจูุฉ ูุงูููุณูุฉ ูู ูุฑุงุฑ ููุฉ ูููุณ ุถุนููุง.',
        advice: 'ุฃุฒู ุงููุตูุฉ ุนู ุงูุชุฏุฎู ุงููุฎุชุต ูุจูุฑูุง.',
      },
    ],
  },
  sexual_exploitation: {
    symptoms: [
      'ุณุฑูุฉ ููุฑุทุฉ ุญูู ุฌูุฉ ุชูุงุตู ุฑูููุฉ ูุญุฏุฏุฉ.',
      'ุชููู ูุฏุงูุง/ุฑุตูุฏ/ุงูุชูุงุฒุงุช ุฑูููุฉ ุจูุง ุชูุณูุฑ ูุงุถุญ.',
      'ููู ุดุฏูุฏ ุนูุฏ ุงูุญุฏูุซ ุนู ุงูุตูุฑ ุฃู ุงููุงููุฑุง.',
      'ุชุจุฏู ููุงุฌุฆ ูู ุงููุบุฉ ุงูุฌูุณูุฉ ุบูุฑ ุงูููุงุฆูุฉ ููุนูุฑ.',
      'ุฑูุถ ูุดุงุฑูุฉ ุฃู ุชูุงุตูู ุนู ุนูุงูุงุช ุฑูููุฉ "ุฎุงุตุฉ ุฌุฏูุง".',
    ],
    lurePatterns: [
      'ุจูุงุก ุงุฑุชุจุงุท ุนุงุทูู ุณุฑูุน ุซู ุทูุจ ุณุฑูุฉ ูุทููุฉ.',
      'ุงุฎุชุจุงุฑ ุงูุญุฏูุฏ ุชุฏุฑูุฌููุง ุนุจุฑ ุทูุจ ุตูุฑ "ุนุงุฏูุฉ" ุฃูููุง.',
      'ุงุณุชุฎุฏุงู ุงูุฐูุจ ุงูุนุงุทูู ูุฅุฌุจุงุฑ ุงูุทูู ุนูู ุงูุงุณุชูุฑุงุฑ.',
      'ุชูุฏูุฏ ุจูุดู ุงููุญุงุฏุซุงุช ูุฅุจูุงุก ุงูุณูุทุฑุฉ.',
      'ููู ุงูุชูุงุตู ูููุตุงุช ุฃูู ุฑูุงุจุฉ ูุฃูุซุฑ ุงุฎุชูุงุกู.',
    ],
    prevention: [
      'ุชุนููู ูุงุนุฏุฉ: ูุง ุตูุฑ ุฎุงุตุฉ ุชุญุช ุฃู ุธุฑู ุฃู ุนูุงูุฉ.',
      'ุฑูุน ุฅุนุฏุงุฏุงุช ุงูุณูุงูุฉ ููุชูุงุตู ูููุน ุงูุบุฑุจุงุก ุงูุชุฑุงุถููุง.',
      'ุชุฏุฑูุจ ุงูุทูู ุนูู ูููุงุช ุงุณุชุบุงุซุฉ ุฃุณุฑูุฉ ูุชูู ุนูููุง.',
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ: ููุท ุงุณุชุฏุฑุงุฌ ุฌูุณู ูุญุชูู ูุน ุชุตุงุนุฏ ูู ุทูุจุงุช ุงูุฎุตูุตูุฉ.',
    ],
    incidentPlan: [
      'ุฅููุงู ุงูุชูุงุตู ููุฑูุง ูุน ุญูุธ ูู ุงูุฃุฏูุฉ ูุจู ุงูุญุธุฑ.',
      'ุงูุจุฏุก ุจุฅุฌุฑุงุกุงุช ุจูุงุบ ุฑุณููุฉ ุนุจุฑ ุงููููุงุช ุงููุนุชูุฏุฉ.',
    ],
    dialogues: [
      {
        situation: 'ุฅุฒุงูุฉ ุงูุนุงุฑ',
        opener: 'ุฃู ุงุณุชุบูุงู ุญุตู ููุณ ุฎุทุฃูุ ูุงููุณุคูููุฉ ูุงููุฉ ุนูู ุงููุนุชุฏู.',
        advice: 'ููุน ููู ุงูุถุญูุฉ ุฃุณุงุณ ูุฌุงุญ ุงูุงุณุชุฌุงุจุฉ.',
      },
      {
        situation: 'ุชุซุจูุช ุงูุญุฏูุฏ',
        opener: 'ุฌุณูู ูุฎุตูุตูุชู ุฎุท ุฃุญูุฑุ ููุง ุฃุญุฏ ูููู ุญู ุชุฌุงูุฒููุง.',
        advice: 'ุนุฒูุฒ ุงูุญุฏูุฏ ุจุทุฑููุฉ ุญุงุฒูุฉ ูุฏุงุนูุฉ ูู ุขู ูุงุญุฏ.',
      },
    ],
  },
  account_theft_fraud: {
    symptoms: [
      'ุชุณุฌูู ุฎุฑูุฌ ูุชูุฑุฑ ูู ุงูุญุณุงุจุงุช ุฏูู ุชุฏุฎู ูู ุงูุทูู.',
      'ุงุณุชูุจุงู ุฑููุฒ ุงุณุชุนุงุฏุฉ ุบูุฑ ูุทููุจุฉ ุนูู ุงูุจุฑูุฏ/ุงููุงุชู.',
      'ุชุบูุฑุงุช ููุงุฌุฆุฉ ูู ุฅุนุฏุงุฏุงุช ุงูุญุณุงุจ ุฃู ุงูุจุฑูุฏ ุงูุจุฏูู.',
      'ุฑุณุงุฆู ูุฃุตุฏูุงุก ุงูุทูู ูู ูุฑุณููุง ูู ูุนูููุง.',
      'ุฅููุงู/ูุดุชุฑูุงุช ูุฌูููุฉ ูู ุญุณุงุจุงุช ูุฑุชุจุทุฉ.',
    ],
    lurePatterns: [
      'ุตูุญุงุช ุชุณุฌูู ุฏุฎูู ูููุฏุฉ ุชุทูุจ ุจูุงูุงุช ุงูุญุณุงุจ.',
      'ุฑูุงุจุท ุชุญุฏูุซ ุฃูุงู ูุฒููุฉ ูุน ุดุนุงุฑ ููุตุฉ ููุซููุฉ.',
      'ุฎุฏุงุน ุนุจุฑ ุฏุนู ููู ูุฒูู ูุทูุจ ุฑูุฒ ุงูุชุญูู.',
      'ุงุณุชุบูุงู ูููุงุช ูุฑูุฑ ููุฑุฑุฉ ุนุจุฑ ุชุณุฑูุจุงุช ูุฏููุฉ.',
      'ุณุฑูุฉ ุฌูุณุฉ ุนุจุฑ ูููุงุช ุชุนุฑูู ุงุฑุชุจุงุท ุฃู ุฃุฌูุฒุฉ ุนุงูุฉ.',
    ],
    prevention: [
      'ุงุณุชุฎุฏุงู ูููุงุช ูุฑูุฑ ูุฑูุฏุฉ ููู ููุตุฉ ูุน ูุฏูุฑ ูููุงุช ูุฑูุฑ.',
      'ุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA) ูุฑุจุท ุงูุญุณุงุจ ุจุจุฑูุฏ ุงุณุชุฑุฏุงุฏ ุขูู ููุณุชูู.',
      'ูุฑุงุฌุนุฉ ูุดุงุท ุชุณุฌูู ุงูุฏุฎูู ุฃุณุจูุนููุง ูุงูุชุดุงู ุงูุฃุฌูุฒุฉ ุงูุบุฑูุจุฉ.',
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ูุคุดุฑุงุช ุงุณุชููุงุก ุนูู ุญุณุงุจ ุฃู ูุญุงููุฉ ุงุฎุชุฑุงู ูุชูุฏูุฉ.',
    ],
    incidentPlan: [
      'ุชุฏููุฑ ุฌููุน ูููุงุช ุงููุฑูุฑ ุงููุฑุชุจุทุฉ ุจุงูุญุณุงุจ ุงููุฎุชุฑู.',
      'ุฅูุบุงุก ุตูุงุญูุงุช ุงูุชุทุจููุงุช ุงูุฎุงุฑุฌูุฉ ุบูุฑ ุงูููุซููุฉ ููุฑูุง.',
    ],
    dialogues: [
      {
        situation: 'ุงุญุชูุงุก ุณุฑูุน',
        opener: 'ุณูุณุชุนูุฏ ุงูุญุณุงุจ ุจุฎุทูุงุช ูุงุถุญุฉุ ูุงูููุช ููุง ููู ุฌุฏูุง.',
        advice: 'ุฅุนุทุงุก ุชุณูุณู ูุงุถุญ ูููู ุงูุฐุนุฑ ููุฑูุน ุงูุชุฑููุฒ.',
      },
      {
        situation: 'ุชุนูู ุฃููู',
        opener: 'ุจุนุฏ ุงูุงุณุชุฑุฏุงุฏุ ุณูุจูู ุญูุงูุฉ ุชููุน ุชูุฑุงุฑ ููุณ ุงูุซุบุฑุฉ.',
        advice: 'ุญููู ุงูุญุงุฏุซ ุฅูู ุชุฑููุฉ ูุนููุฉ ูู ุนุงุฏุงุช ุงูุฃูุงู.',
      },
    ],
  },
  gambling_betting: {
    symptoms: [
      'ุงูุดุบุงู ูุณุชูุฑ ุจูุชุงุฆุฌ ูุจุงุฑูุงุช/ุฑูุงูุงุช ุจุฏู ุงูุฃูุดุทุฉ ุงูููููุฉ.',
      'ุทูุจ ุฃููุงู ูุชูุฑุฑ ูุน ูุจุฑุฑุงุช ุบูุฑ ูุชุณูุฉ.',
      'ุชููุจ ูุฒุงุฌ ุญุงุฏ ูุฑุชุจุท ุจุงูููุณุจ ูุงูุฎุณุงุฑุฉ ุงููุญุธูุฉ.',
      'ุฅุฎูุงุก ุณุฌู ุงููุฏููุนุงุช ุฃู ุงุณุชุฎุฏุงู ุจุทุงูุงุช ูุณุจูุฉ ุงูุฏูุน.',
      'ูุทุงุฑุฏุฉ ุงูุฎุณุงุฑุฉ ุนุจุฑ ูุถุงุนูุฉ ุงูุฑูุงู ุจุนุฏ ูู ูุจูุท.',
    ],
    lurePatterns: [
      'ุนุฑูุถ ุชุฑุญูุจูุฉ ูุฌุงููุฉ ุชููุฏ ุชุฏุฑูุฌููุง ููุฎุงุทุฑ ูุงููุฉ ุนุงููุฉ.',
      'ุฅุดุนุงุฑุงุช "ุงุณุชุฑุฌุงุน ุงูุฎุณุงุฑุฉ ุงูุขู" ูุชุดุฌูุน ุงูุงูุฏูุงุน.',
      'ุฑุจุท ุงูุฑูุงู ุจูููุฉ ุงุฌุชูุงุนูุฉ ุฏุงุฎู ูุฌููุนุงุช ุงูุฃุตุฏูุงุก.',
      'ุชุญููู ุงูููุงูุฑุฉ ุฅูู ุชุญุฏูุงุช ููููุฉ ูุตูุฑุฉ ุณููุฉ ุงูุฏุฎูู.',
      'ุงุณุชุฎุฏุงู ุนููุงุช ุฏุงุฎู ุงููุนุจุฉ ูุฅุฎูุงุก ุงูุทุงุจุน ุงูููุงุฑู.',
    ],
    prevention: [
      'ุญุธุฑ ููุตุงุช ุงููุฑุงููุฉ ูุนูููุงุช ุงูุฏูุน ุงููุฑุชุจุทุฉ ุจูุง ุชููููุง.',
      'ูุถุน ุณูู ุฅููุงู ุฑููู ุตูุฑู ููุญุณุงุจุงุช ุงูุญุณุงุณุฉ.',
      'ุจุฑูุงูุฌ ุจุฏุงุฆู ููุฑู (ุฑูุงุถุฉ/ูุดุงุท ุฌูุงุนู/ููุงูุขุช ุบูุฑ ูุงููุฉ).',
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ุณููู ูุฑุงููุฉ ูุชูุฑุฑ ูุน ูุฎุงุทุฑ ุฎุณุงุฑุฉ ูุงููุฉ ูุชุตุงุนุฏุฉ.',
    ],
    incidentPlan: [
      'ุฅููุงู ูุณุงุฆู ุงูุฏูุน ูุฑุจุท ุงูุฅุดุนุงุฑุงุช ุงููุงููุฉ ุจููู ุงูุฃูุฑ.',
      'ูุฑุงุฌุนุฉ ููููุฉ ููุฅููุงู ููุฏุฉ ุฃุณุจูุนูู ุจุนุฏ ุงูุญุงุฏุซ.',
    ],
    dialogues: [
      {
        situation: 'ูู ุฏุงุฆุฑุฉ ุงูุฎุณุงุฑุฉ',
        opener: 'ูุญุงููุฉ ุชุนููุถ ุงูุฎุณุงุฑุฉ ุจุณุฑุนุฉ ุชุฒูุฏูุง ุบุงูุจูุงุ ูููููู ุงูุญููุฉ ุงูุขู.',
        advice: 'ุงุดุฑุญ ููููู "ูุทุงุฑุฏุฉ ุงูุฎุณุงุฑุฉ" ุจูุบุฉ ุจุณูุทุฉ ูุงุจูุฉ ููููู.',
      },
      {
        situation: 'ุจุฏูู ุงูููุงูุฃุฉ',
        opener: 'ุณูุจุฏู ุฅุซุงุฑุฉ ุงูุฑูุงู ุจุฅุซุงุฑุฉ ุฅูุฌุงุฒ ุญููููุฉ ุชุญูู ูู ุชูุฏูุฑูุง ุซุงุจุชูุง.',
        advice: 'ุงูุจุฏูู ุงูุฅูุฌุงุจู ูููุน ุงููุฑุงุบ ุงูุฐู ูุนูุฏ ุงูุณููู ุงููุฏูู.',
      },
    ],
  },
  privacy_tracking: {
    symptoms: [
      'ูุนุฑูุฉ ุฃุทุฑุงู ุฎุงุฑุฌูุฉ ุจุชูุงุตูู ููุงู/ููุช ูู ููุดุงุฑููุง ุงูุทูู.',
      'ุชุทุจููุงุช ุบุฑูุจุฉ ุฐุงุช ุตูุงุญูุงุช ูููุน ููููุฑูููู ููุฑุทุฉ.',
      'ุฑุณุงุฆู ุชูุฏูุฏ ูุจููุฉ ุนูู ูุนูููุงุช ุดุฎุตูุฉ ุฏูููุฉ.',
      'ุงุณุชููุงู ุจุทุงุฑูุฉ/ุจูุงูุงุช ุบูุฑ ุทุจูุนู ุจุดูู ูุณุชูุฑ.',
      'ุธููุฑ ุฑูุงุจุท ุชุชุจุน ูู ุงููุญุงุฏุซุงุช ุนูู ุฃููุง "ุงุฎุชุจุงุฑ ุจุณูุท".',
    ],
    lurePatterns: [
      'ุฅุฑุณุงู ุฑูุงุจุท ูุตูุฑุฉ ุชุฏูุนู ูุนุฑูุฉ ูู ุฒุงุฑ ุงูุญุณุงุจ.',
      'ุชุทุจููุงุช "ุฎุฏูุงุช ูุฌุงููุฉ" ุชุทูุจ ุตูุงุญูุงุช ุชุฌุณุณูุฉ ูุงููุฉ.',
      'ุฌูุน ุตูุฑ/ุจูุงูุงุช ุฎูููุฉ ูุงุณุชุฎุฏุงููุง ูู ุงูุฏููุณููุบ.',
      'ุงุณุชุฎุฏุงู ูุณุงุจูุงุช ููููุฉ ูุงุณุชุฎุฑุงุฌ ุงูุนููุงู ูุงููุฏุฑุณุฉ.',
      'ุงุจุชุฒุงุฒ ุจุจูุงูุงุช ุงููููุน ูุฅุฌุจุงุฑ ุงูุทูู ุนูู ุงูุงุณุชุฌุงุจุฉ.',
    ],
    prevention: [
      'ูุฑุงุฌุนุฉ ุดูุฑูุฉ ูุตูุงุญูุงุช ุงูุชุทุจููุงุช ูุฅุฒุงูุฉ ุฃู ุตูุงุญูุฉ ุบูุฑ ูุงุฒูุฉ.',
      'ุชุนุทูู ูุดุงุฑูุฉ ุงููููุน ุงูุฏุงุฆูุฉ ูุงูุงูุชูุงุก ุจู"ุฃุซูุงุก ุงูุงุณุชุฎุฏุงู".',
      'ููุน ูุดุฑ ุตูุฑ ุชูุดู ุงูุนููุงู ุฃู ุงููุฏุฑุณุฉ ุฃู ุงูุฑูุชูู ุงููููู.',
    ],
    alertTemplates: [
      'ุชูุจูู ูุฑุชูุน: ุงุญุชูุงู ุชุชุจุน/ุชุฌุณุณ ุฑููู ูุน ุชุณุฑูุจ ุจูุงูุงุช ุญุณุงุณุฉ.',
    ],
    incidentPlan: [
      'ูุญุต ุงูุฌูุงุฒ ุฃููููุง ูุญุฐู ุงูุชุทุจููุงุช ุงููุดุจููุฉ ููุฑูุง.',
      'ุชุบููุฑ ูููุงุช ุงููุฑูุฑ ูุฅุนุงุฏุฉ ุชุนููู ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ ุงูุฃุณุงุณูุฉ.',
    ],
    dialogues: [
      {
        situation: 'ุฑูุน ุงููุนู',
        opener: 'ุงููุนูููุฉ ุงูุตุบูุฑุฉ ูุฏ ุชูุดู ุญูุงุชู ุงูููููุฉ ุจุงููุงูู ุฅุฐุง ุชุฑุงููุช.',
        advice: 'ุงุดุฑุญ ูุจุฏุฃ "ุชุฌููุน ุงูุจูุงูุงุช" ุจุฏู ุงูุชุฎููู ุงููุจุงุดุฑ.',
      },
      {
        situation: 'ุงูุถุจุงุท ุงููุดุงุฑูุฉ',
        opener: 'ูุจู ุฃู ูุดุฑุ ูุณุฃู: ูู ูุฐุง ููุดู ููุงููุง ุฃู ุฑูุชูููุงุ',
        advice: 'ุณุคุงู ูุงุญุฏ ุซุงุจุช ูุจู ุงููุดุฑ ูููู ุงูุชุณุฑูุจุงุช ุชููุงุฆููุง.',
      },
    ],
  },
  harmful_challenges: {
    symptoms: [
      'ูุญุงููุงุช ุชุตููุฑ ุณููู ุฎุทูุฑ ุจูุฏู ุงููุดุฑ ูุงูุญุตูู ุนูู ุชูุงุนู.',
      'ุชูุฑุงุฑ ุนุจุงุฑุงุช ุชุญุฏู ูุซู "ุฅุฐุง ูู ุชูุนู ูุฃูุช ุถุนูู".',
      'ุฅุตุงุจุงุช ุทูููุฉ ูุชูุฑุฑุฉ ูุน ุชูุณูุฑุงุช ุบูุฑ ูููุนุฉ.',
      'ุงูุฏูุงุน ููู ูุญู ุฅุซุจุงุช ุงูุฐุงุช ุฃูุงู ูุฌููุนุฉ ุฑูููุฉ ูุนููุฉ.',
      'ุชุฌุงูู ุนูุงูุจ ุงูุณูุงูุฉ ููุงุจู "ุงูุชุฑูุฏ" ูุงูุงูุชุดุงุฑ.',
    ],
    lurePatterns: [
      'ุชุญุฏูุงุช ุชุตุงุนุฏูุฉ ุชุจุฏุฃ ุจุณูุทุฉ ุซู ุชููุฒ ุฅูู ุฅูุฐุงุก ุญูููู.',
      'ุฑุจุท ุงููุจูู ุงูุงุฌุชูุงุนู ุจุชูููุฐ ุณููู ุฎุทุฑ ุฃูุงู ุงููุงููุฑุง.',
      'ุงูุถุบุท ุนุจุฑ ุงูุนุฏ ุงูุชูุงุฒูู ุฃู ุชูุฏูุฏ ุจุงูุฅูุตุงุก ูู ุงููุฌููุนุฉ.',
      'ุงุณุชุฎุฏุงู ููุงูุขุช ุฑูููุฉ/ูุชุงุจุนูู ูุญุงูุฒ ูููุฌุงุฒูุฉ.',
      'ุชุถููู ุงููุฎุงุทุฑ ุนุจุฑ ูุตุต ูุฌุงุญ ูุฒููุฉ ุฏูู ุฐูุฑ ุงูุฅุตุงุจุงุช.',
    ],
    prevention: [
      'ุณูุงุณุฉ ุฃุณุฑูุฉ ูุงุถุญุฉ: ุฃู ุชุญุฏู ุฌุณุฏู/ูุคุฐู ูุฑููุถ ููุฑูุง.',
      'ุชุนุฒูุฒ ุจุฏุงุฆู ุชุญุฏูุงุช ุฅูุฌุงุจูุฉ (ุฑูุงุถุฉ/ููุงุฑุฉ/ูุดุฑูุน ุฅุจุฏุงุนู).',
      'ูุฑุงุฌุนุฉ ุฏูุฑูุฉ ููุชุฑูุฏุงุช ุงูุดุงุฆุนุฉ ูุน ุดุฑุญ ูุฎุงุทุฑูุง ุงููุงูุนูุฉ.',
    ],
    alertTemplates: [
      'ุชูุจูู ุญุฑุฌ: ุงุฑุชุจุงุท ุจููุท ุชุญุฏูุงุช ุฎุทุฑุฉ ูุฏ ูููุฏ ูุฅูุฐุงุก ูุจุงุดุฑ.',
    ],
    incidentPlan: [
      'ุชุนููู ุงูุญุณุงุจุงุช/ุงููุฌููุนุงุช ุงููุญุฑุถุฉ ูุคูุชูุง ุญุชู ุงุณุชูุฑุงุฑ ุงูุณููู.',
      'ุชูููู ุทุจู ููุฑู ุนูุฏ ุฃู ุนูุงูุฉ ุฅุตุงุจุฉ ุฃู ุฅุฑูุงู ุดุฏูุฏ.',
    ],
    dialogues: [
      {
        situation: 'ุชูููู ุถุบุท ุงูุฃูุฑุงู',
        opener: 'ุงูููุฉ ุงูุญููููุฉ ูู ุฑูุถ ูุง ูุคุฐูู ุญุชู ูู ุตูู ูู ุงูุขุฎุฑูู.',
        advice: 'ุญููู ุชุนุฑูู ุงูุดุฌุงุนุฉ ูู ุงููุฎุงุทุฑุฉ ุฅูู ุญูุงูุฉ ุงูููุณ.',
      },
      {
        situation: 'ุจูุงุก ุงูุชูุงุก ุขูู',
        opener: 'ุณูุจุญุซ ุนู ูุฌููุนุฉ ุฅูุฌุงุจูุฉ ุชูุฏูุฑู ุจุฏูู ุดุฑูุท ุฎุทุฑุฉ.',
        advice: 'ุงูุงูุชูุงุก ุงูุจุฏูู ูููู ุงูุฑุฌูุน ูููุฌููุนุฉ ุงูุถุงุฑุฉ.',
      },
    ],
  },
};

const normalizeListEntry = (value: string) => value.replace(/\s+/g, ' ').trim();

const mergeUniqueStrings = (base: string[], extension: string[] = []) => {
  const seen = new Set<string>();
  const merged: string[] = [];
  [...base, ...extension].forEach((value) => {
    const normalized = normalizeListEntry(value);
    if (!normalized || seen.has(normalized)) return;
    seen.add(normalized);
    merged.push(normalized);
  });
  return merged;
};

const mergeInterventionSteps = (base: InterventionStep[], extension: InterventionStep[] = []) => {
  const seen = new Set<string>();
  const merged: InterventionStep[] = [];
  [...base, ...extension].forEach((step) => {
    const key = `${normalizeListEntry(step.week)}|${normalizeListEntry(step.goal)}|${normalizeListEntry(step.action)}`;
    if (seen.has(key)) return;
    seen.add(key);
    merged.push({
      week: normalizeListEntry(step.week),
      goal: normalizeListEntry(step.goal),
      action: normalizeListEntry(step.action),
    });
  });
  return merged;
};

const mergeDialogues = (
  base: GuidanceScenario['dialogues'],
  extension: GuidanceScenario['dialogues'] = []
) => {
  const seen = new Set<string>();
  const merged: GuidanceScenario['dialogues'] = [];
  [...base, ...extension].forEach((dialogue) => {
    const key = [
      normalizeListEntry(dialogue.situation),
      normalizeListEntry(dialogue.opener),
      normalizeListEntry(dialogue.advice),
    ].join('|');
    if (seen.has(key)) return;
    seen.add(key);
    merged.push({
      situation: normalizeListEntry(dialogue.situation),
      opener: normalizeListEntry(dialogue.opener),
      advice: normalizeListEntry(dialogue.advice),
    });
  });
  return merged;
};

const guidanceScenarios: GuidanceScenario[] = guidanceScenariosBase.map((scenario) => {
  const extension = scenarioKnowledgeExtensions[scenario.id];
  if (!extension) return scenario;
  return {
    ...scenario,
    symptoms: mergeUniqueStrings(scenario.symptoms, extension.symptoms),
    lurePatterns: mergeUniqueStrings(scenario.lurePatterns, extension.lurePatterns),
    prevention: mergeUniqueStrings(scenario.prevention, extension.prevention),
    alertTemplates: mergeUniqueStrings(scenario.alertTemplates, extension.alertTemplates),
    incidentPlan: mergeUniqueStrings(scenario.incidentPlan, extension.incidentPlan),
    interventionProgram: mergeInterventionSteps(scenario.interventionProgram, extension.interventionProgram),
    dialogues: mergeDialogues(scenario.dialogues, extension.dialogues),
  };
});

const SCENARIO_CONTENT_MINIMUMS = {
  symptoms: 7,
  lurePatterns: 7,
  prevention: 6,
  incidentPlan: 6,
  alertTemplates: 3,
  dialogues: 4,
} as const;

if (import.meta.env.DEV) {
  const lowCoverage = guidanceScenarios
    .map((scenario) => {
      const gaps: string[] = [];
      if (scenario.symptoms.length < SCENARIO_CONTENT_MINIMUMS.symptoms) gaps.push('symptoms');
      if (scenario.lurePatterns.length < SCENARIO_CONTENT_MINIMUMS.lurePatterns) gaps.push('lurePatterns');
      if (scenario.prevention.length < SCENARIO_CONTENT_MINIMUMS.prevention) gaps.push('prevention');
      if (scenario.incidentPlan.length < SCENARIO_CONTENT_MINIMUMS.incidentPlan) gaps.push('incidentPlan');
      if (scenario.alertTemplates.length < SCENARIO_CONTENT_MINIMUMS.alertTemplates) gaps.push('alertTemplates');
      if (scenario.dialogues.length < SCENARIO_CONTENT_MINIMUMS.dialogues) gaps.push('dialogues');
      return gaps.length ? { id: scenario.id, gaps } : null;
    })
    .filter(Boolean) as Array<{ id: PsychScenarioId; gaps: string[] }>;

  if (lowCoverage.length) {
    console.warn('[PsychologicalInsightView] Scenario encyclopedia coverage gaps detected:', lowCoverage);
  }
}

const severityClassMap: Record<AlertSeverity, string> = {
  [AlertSeverity.CRITICAL]: 'bg-red-100 text-red-700 border-red-200',
  [AlertSeverity.HIGH]: 'bg-orange-100 text-orange-700 border-orange-200',
  [AlertSeverity.MEDIUM]: 'bg-amber-100 text-amber-700 border-amber-200',
  [AlertSeverity.LOW]: 'bg-emerald-100 text-emerald-700 border-emerald-200',
};

const severityTextMap: Record<AlertSeverity, string> = {
  [AlertSeverity.CRITICAL]: 'ุญุฑุฌ',
  [AlertSeverity.HIGH]: 'ูุฑุชูุน',
  [AlertSeverity.MEDIUM]: 'ูุชูุณุท',
  [AlertSeverity.LOW]: 'ููุฎูุถ',
};

const scenarioGlassStyles: Record<PsychScenarioId, { tint: string; ring: string; button: string }> = {
  bullying: {
    tint: 'from-fuchsia-500/25 via-rose-400/20 to-pink-500/25',
    ring: 'shadow-fuchsia-500/20',
    button: 'from-fuchsia-500 to-rose-600',
  },
  threat_exposure: {
    tint: 'from-red-500/25 via-rose-500/20 to-orange-500/25',
    ring: 'shadow-red-500/25',
    button: 'from-red-500 to-rose-700',
  },
  gaming: {
    tint: 'from-indigo-500/25 via-blue-500/20 to-violet-500/25',
    ring: 'shadow-indigo-500/20',
    button: 'from-indigo-500 to-violet-600',
  },
  inappropriate_content: {
    tint: 'from-violet-500/25 via-fuchsia-500/20 to-indigo-500/25',
    ring: 'shadow-violet-500/20',
    button: 'from-violet-500 to-fuchsia-600',
  },
  cyber_crime: {
    tint: 'from-slate-500/25 via-cyan-500/20 to-slate-700/25',
    ring: 'shadow-slate-500/25',
    button: 'from-slate-600 to-cyan-700',
  },
  phishing_links: {
    tint: 'from-cyan-500/25 via-sky-500/20 to-blue-500/25',
    ring: 'shadow-cyan-500/20',
    button: 'from-cyan-500 to-blue-600',
  },
  crypto_scams: {
    tint: 'from-amber-500/25 via-orange-500/20 to-yellow-500/25',
    ring: 'shadow-amber-500/20',
    button: 'from-amber-500 to-orange-600',
  },
  self_harm: {
    tint: 'from-rose-600/25 via-red-500/20 to-pink-500/25',
    ring: 'shadow-rose-500/25',
    button: 'from-rose-600 to-red-700',
  },
  sexual_exploitation: {
    tint: 'from-fuchsia-600/25 via-pink-500/20 to-purple-500/25',
    ring: 'shadow-fuchsia-500/25',
    button: 'from-fuchsia-600 to-pink-700',
  },
  account_theft_fraud: {
    tint: 'from-blue-500/25 via-sky-500/20 to-indigo-500/25',
    ring: 'shadow-blue-500/20',
    button: 'from-blue-500 to-indigo-600',
  },
  gambling_betting: {
    tint: 'from-yellow-500/25 via-amber-500/20 to-orange-500/25',
    ring: 'shadow-yellow-500/20',
    button: 'from-yellow-500 to-amber-600',
  },
  privacy_tracking: {
    tint: 'from-teal-500/25 via-cyan-500/20 to-emerald-500/25',
    ring: 'shadow-teal-500/20',
    button: 'from-teal-500 to-emerald-600',
  },
  harmful_challenges: {
    tint: 'from-orange-500/25 via-rose-500/20 to-red-500/25',
    ring: 'shadow-orange-500/25',
    button: 'from-orange-500 to-red-600',
  },
};

const inferScenarioId = (child?: Child): GuidanceScenario['id'] => {
  const profile = child?.psychProfile;
  if (profile?.priorityScenario) {
    return profile.priorityScenario;
  }

  const hay = (profile?.recentKeywords || []).join(' ');
  if (
    hay.includes('ุฅูุฐุงุก ุงูููุณ') ||
    hay.includes('ุงูุชุญุงุฑ') ||
    hay.toLowerCase().includes('self harm') ||
    hay.toLowerCase().includes('suicide')
  ) {
    return 'self_harm';
  }
  if (
    hay.includes('ุงุณุชุฏุฑุงุฌ') ||
    hay.includes('ุงุณุชุบูุงู ุฌูุณู') ||
    hay.toLowerCase().includes('grooming') ||
    hay.toLowerCase().includes('predator')
  ) {
    return 'sexual_exploitation';
  }
  if (
    hay.includes('ุณุฑูุฉ ุญุณุงุจ') ||
    hay.includes('ุงุฎุชุฑุงู ุงูุญุณุงุจ') ||
    hay.toLowerCase().includes('account stolen') ||
    hay.toLowerCase().includes('credential')
  ) {
    return 'account_theft_fraud';
  }
  if (
    hay.includes('ูุฑุงููุฉ') ||
    hay.includes('ููุงุฑ') ||
    hay.toLowerCase().includes('gambling') ||
    hay.toLowerCase().includes('bet')
  ) {
    return 'gambling_betting';
  }
  if (
    hay.includes('ุฎุตูุตูุฉ') ||
    hay.includes('ุชุชุจุน') ||
    hay.toLowerCase().includes('tracking') ||
    hay.toLowerCase().includes('dox')
  ) {
    return 'privacy_tracking';
  }
  if (
    hay.includes('ุชุญุฏู ุฎุทูุฑ') ||
    hay.includes('ูุฌููุนุฉ ุถุงุฑุฉ') ||
    hay.toLowerCase().includes('dangerous challenge')
  ) {
    return 'harmful_challenges';
  }
  if (hay.includes('ุชูุฏูุฏ') || hay.includes('ุงุจุชุฒุงุฒ')) return 'threat_exposure';
  if (hay.includes('ุชููุฑ')) return 'bullying';
  if (hay.toLowerCase().includes('phishing') || hay.includes('ุชุตูุฏ') || hay.includes('ุฑุงุจุท')) return 'phishing_links';
  if (hay.includes('ุณูุฑ') || hay.includes('ุฅุฏูุงู') || hay.includes('ูุนุจ')) return 'gaming';
  if (hay.includes('ุงุฎุชุฑุงู') || hay.includes('ุณูุฑุจุช')) return 'cyber_crime';
  if (hay.includes('ุงุณุชุซูุงุฑ') || hay.includes('ุชุญููู')) return 'crypto_scams';
  if (hay.includes('ุฅุจุงุญูุฉ') || hay.includes('ูุญุชูู')) return 'inappropriate_content';
  return 'bullying';
};

const scenarioToCategory = (
  scenarioId: PsychScenarioId,
  threatSubtype: ThreatExposureSubtype = 'direct_threat',
  contentSubtype: InappropriateContentSubtype = 'sexual_content',
  severity: AlertSeverity = AlertSeverity.MEDIUM
): Category => {
  switch (scenarioId) {
    case 'bullying':
      return Category.BULLYING;
    case 'threat_exposure':
      if (threatSubtype === 'financial_blackmail') return Category.SCAM;
      if (threatSubtype === 'sexual_blackmail') return Category.SEXUAL_EXPLOITATION;
      return Category.BLACKMAIL;
    case 'gaming':
      return Category.SAFE;
    case 'inappropriate_content':
      return contentSubtype === 'violent_content' ? Category.VIOLENCE : Category.ADULT_CONTENT;
    case 'cyber_crime':
      if (severity === AlertSeverity.CRITICAL) return Category.TAMPER;
      if (severityRank[severity] >= severityRank[AlertSeverity.HIGH]) return Category.PREDATOR;
      return Category.SAFE;
    case 'crypto_scams':
      return Category.SCAM;
    case 'phishing_links':
      return Category.PHISHING_LINK;
    case 'self_harm':
      return Category.SELF_HARM;
    case 'sexual_exploitation':
      return threatSubtype === 'sexual_blackmail' ? Category.BLACKMAIL : Category.SEXUAL_EXPLOITATION;
    case 'account_theft_fraud':
      return Category.SCAM;
    case 'gambling_betting':
      return Category.SCAM;
    case 'privacy_tracking':
      return Category.PREDATOR;
    case 'harmful_challenges':
      return severityRank[severity] >= severityRank[AlertSeverity.HIGH] ? Category.VIOLENCE : Category.SELF_HARM;
    default:
      return Category.BULLYING;
  }
};

interface ThreatTrackProfile {
  id: ThreatExposureSubtype;
  badgeLabelAr: string;
  badgeLabelEn: string;
  narrativeAr: string;
  narrativeEn: string;
  incidentPlanAr: string[];
  incidentPlanEn: string[];
  alertTemplatesAr: string[];
  alertTemplatesEn: string[];
  preferWalkie: boolean;
  preferBlackout: boolean;
  preferCutInternet: boolean;
  preferSiren: boolean;
}

const threatTrackProfiles: Record<ThreatExposureSubtype, ThreatTrackProfile> = {
  direct_threat: {
    id: 'direct_threat',
    badgeLabelAr: 'ุชูุฏูุฏ ูุจุงุดุฑ',
    badgeLabelEn: 'Direct Threat',
    narrativeAr:
      'ุงูุฎุทุฑ ุงูุญุงูู ุฃูุฑุจ ุฅูู ุชูุฏูุฏ ูุจุงุดุฑุ ุงูุฃููููุฉ ูุนุฒู ุงูุชูุงุตู ุงููุคุฐูุ ุชุซุจูุช ุงูููุงุฉ ุงูุตูุชูุฉ ุงูุขููุฉุ ูุชูุซูู ุงูุฃุฏูุฉ ููุฑุงู.',
    narrativeEn:
      'The current pattern matches direct threat exposure. Prioritize immediate containment, safe voice channel, and evidence capture.',
    incidentPlanAr: [
      'ูุง ุชูุงูุถ ููุง ุฑุฏ ุงููุนุงูู ูุน ุงูุญุณุงุจ ุงูููุฏุฏ.',
      'ุชูุนูู ุงูููู ุงูููุงุฆู ุงูููุฑู ูุน ุดุงุดุฉ ุญูุงูุฉ.',
      'ุชุดุบูู ููุงุฉ ุชูุงุตู ูุจุงุดุฑ (Walkie) ูุน ุงูุทูู.',
      'ุงูุชูุงุท ุฃุฏูุฉ ุงูุดุงุดุฉ ุซู ุฑูุน ุจูุงุบ ุงูููุตุฉ.',
      'ุชุตุนูุฏ ููุฑู ูููู ุงูุฃูุฑ ุงูููุงูุจ ุนูุฏ ุงุณุชูุฑุงุฑ ุงูุชูุฏูุฏ.',
    ],
    incidentPlanEn: [
      'Do not negotiate or react emotionally to the threatening account.',
      'Enable immediate protective lock and blackout screen.',
      'Open a direct walkie channel with the child.',
      'Capture screen evidence, then report on platform.',
      'Escalate to on-duty guardian if threat persists.',
    ],
    alertTemplatesAr: [
      'ุชูุจูู ุญุฑุฌ: ููุท ุชูุฏูุฏ ูุจุงุดุฑ ูุฑุตูุฏ. ุชู ุชูุนูู ุงูุงุญุชูุงุก ุงูููุงุฆู.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุชู ุชูุซูู ุงูุฃุฏูุฉ ูููุชุธุฑ ุงูุฅุจูุงุบ ุงูุฑุณูู ููููุตุฉ.',
    ],
    alertTemplatesEn: [
      'Critical alert: direct threat pattern detected. Protective containment enabled.',
      'Follow-up alert: evidence captured, pending official platform report.',
    ],
    preferWalkie: true,
    preferBlackout: true,
    preferCutInternet: false,
    preferSiren: true,
  },
  financial_blackmail: {
    id: 'financial_blackmail',
    badgeLabelAr: 'ุงุจุชุฒุงุฒ ูุงูู',
    badgeLabelEn: 'Financial Blackmail',
    narrativeAr:
      'ุงูุฎุทุฑ ุงูุญุงูู ูุชุถูู ุถุบุทุงู ูุงููุงูุ ุงูุฃููููุฉ ููุทุน ูุณุงุฑุงุช ุงูุฏูุนุ ุนุฒู ุงูุดุจูุฉ ูุคูุชุงูุ ูุชุฃููู ุงูุญุณุงุจุงุช ุงููุฑุชุจุทุฉ ุจุงูุชุญููู.',
    narrativeEn:
      'The current pattern indicates financial blackmail. Prioritize payment freeze, temporary network quarantine, and account hardening.',
    incidentPlanAr: [
      'ุฅููุงู ุฃู ุชุญููู ุฃู ุฏูุน ููุฑู ุชุญุช ุงูุถุบุท.',
      'ุชูุนูู ุนุฒู ุงูุดุจูุฉ ูุคูุชุงู ุญุชู ุงูุชูุงุก ุงููุฑุงุฌุนุฉ.',
      'ุชุฃููู ุงูุญุณุงุจุงุช ุงููุงููุฉ ูุชุบููุฑ ูููุงุช ุงููุฑูุฑ.',
      'ุชูุซูู ุงูุฑุณุงุฆู ุงููุงููุฉ ูุฑูุงุจุท ุงูุฏูุน ุงููุดุจููุฉ.',
      'ุฅุจูุงุบ ุงูููุตุฉ ูุฎุฏูุฉ ุงูุฏูุน ุนู ูุญุงููุฉ ุงูุงุจุชุฒุงุฒ.',
    ],
    incidentPlanEn: [
      'Stop all pressured transfers or payments immediately.',
      'Enable temporary network quarantine during investigation.',
      'Harden financial accounts and rotate passwords.',
      'Preserve payment requests and suspicious links as evidence.',
      'Report blackmail attempt to platform and payment provider.',
    ],
    alertTemplatesAr: [
      'ุชูุจูู ุญุฑุฌ: ููุท ุงุจุชุฒุงุฒ ูุงูู ูุฑุตูุฏ. ุชู ุชุฌููุฏ ูุณุงุฑุงุช ุงูุฏูุน ูุคูุชุงู.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุชุญูู ูู ุงูุญุณุงุจุงุช ุงููุงููุฉ ูุชูุซูู ุฑูุงุจุท ุงูุชุญููู ุฌุงุฑู.',
    ],
    alertTemplatesEn: [
      'Critical alert: financial blackmail pattern detected. Payment channels temporarily frozen.',
      'Follow-up alert: financial account verification and transfer-link evidence in progress.',
    ],
    preferWalkie: false,
    preferBlackout: false,
    preferCutInternet: true,
    preferSiren: false,
  },
  sexual_blackmail: {
    id: 'sexual_blackmail',
    badgeLabelAr: 'ุงุจุชุฒุงุฒ ุฌูุณู',
    badgeLabelEn: 'Sexual Blackmail',
    narrativeAr:
      'ุงูุฎุทุฑ ุงูุญุงูู ูุดูุฑ ุฅูู ุงุจุชุฒุงุฒ ุฌูุณูุ ุงูุฃููููุฉ ููุชุฃููู ุงูููุฑูุ ููุน ุงูุชูุงูุถุ ุญูุธ ุงูุฃุฏูุฉุ ูุจุฏุก ูุณุงุฑ ุฅุจูุงุบ ุฑุณูู ุณุฑูุน.',
    narrativeEn:
      'The current pattern indicates sexual blackmail. Prioritize immediate protection, no negotiation, evidence preservation, and fast formal reporting.',
    incidentPlanAr: [
      'ูุง ุชูุงูุถ ููุง ุฅุฑุณุงู ุฃู ูุญุชูู ุฅุถุงูู ูุทููุงู.',
      'ุชูุนูู ุงูููู ุงูููุงุฆู ูุดุงุดุฉ ุงูุญูุงูุฉ ููุฑุงู.',
      'ุงูุชูุงุท ุงูุฃุฏูุฉ (ุงููุนุฑูุงุช/ุงูุฑุณุงุฆู/ุงูููุช) ูุจู ุฃู ุญุฐู.',
      'ูุชุญ ููุงุฉ Walkie ูุฏุนู ุงูุทูู ูุทูุฃูุชู ููุฑูุงู.',
      'ุจุฏุก ูุณุงุฑ ุฅุจูุงุบ ุฑุณูู ููููุตุฉ ูุงูุฌูุงุช ุงููุฎุชุตุฉ.',
    ],
    incidentPlanEn: [
      'Do not negotiate and never send any additional content.',
      'Enable immediate protective lock and safety blackout screen.',
      'Capture identifiers/messages/timestamps before any deletion.',
      'Open walkie channel for immediate reassurance and support.',
      'Trigger fast formal reporting to platform and authorities.',
    ],
    alertTemplatesAr: [
      'ุชูุจูู ุญุฑุฌ ุฌุฏุงู: ุงุดุชุจุงู ุงุจุชุฒุงุฒ ุฌูุณู. ุชู ุชูุนูู ุงูุญูุงูุฉ ุงูููุฑูุฉ.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุญูุธ ุงูุฃุฏูุฉ ูุจุฏุก ูุณุงุฑ ุงูุฅุจูุงุบ ุงูุฑุณูู.',
    ],
    alertTemplatesEn: [
      'Extreme alert: suspected sexual blackmail. Immediate protection has been activated.',
      'Follow-up alert: evidence preserved and formal reporting flow started.',
    ],
    preferWalkie: true,
    preferBlackout: true,
    preferCutInternet: false,
    preferSiren: false,
  },
};

const inferThreatSubtypeFromKeywords = (keywords: string[]): ThreatExposureSubtype => {
  const hay = (keywords || []).join(' ').toLowerCase();
  if (
    hay.includes('ุงุจุชุฒุงุฒ ุฌูุณู') ||
    hay.includes('ุงุณุชุบูุงู ุฌูุณู') ||
    hay.includes('sextortion') ||
    hay.includes('private photos') ||
    hay.includes('nude')
  ) {
    return 'sexual_blackmail';
  }
  if (
    hay.includes('ุงุจุชุฒุงุฒ ูุงูู') ||
    hay.includes('ุชุญููู') ||
    hay.includes('ุฏูุน') ||
    hay.includes('gift card') ||
    hay.includes('wallet')
  ) {
    return 'financial_blackmail';
  }
  return 'direct_threat';
};

interface ContentTrackProfile {
  id: InappropriateContentSubtype;
  badgeLabelAr: string;
  badgeLabelEn: string;
  narrativeAr: string;
  narrativeEn: string;
  incidentPlanAr: string[];
  incidentPlanEn: string[];
  alertTemplatesAr: string[];
  alertTemplatesEn: string[];
  preferBlackout: boolean;
  preferSiren: boolean;
}

const contentTrackProfiles: Record<InappropriateContentSubtype, ContentTrackProfile> = {
  sexual_content: {
    id: 'sexual_content',
    badgeLabelAr: 'ูุญุชูู ุฌูุณู',
    badgeLabelEn: 'Sexual Content',
    narrativeAr:
      'ุงููุคุดุฑ ุงูุญุงูู ูุฑุชุจุท ุจุชุนุฑุถ ููุญุชูู ุฌูุณู ุบูุฑ ููุงุณุจุ ุงูุฃููููุฉ ูุชุดุฏูุฏ ุงูููุชุฑุฉุ ุงูุชูุฏุฆุฉุ ูุญูุงุฑ ุงุญุชูุงุฆู ุจูุง ููู.',
    narrativeEn:
      'Current pattern indicates exposure to sexual explicit content. Prioritize tighter filtering, calm handling, and non-blaming guidance.',
    incidentPlanAr: [
      'ุฅููุงู ุงููุตุฏุฑ ุงููุณุจุจ ููุฑุงู (ุฑุงุจุท/ุญุณุงุจ/ุชุทุจูู).',
      'ุฑูุน ูุณุชูู ุงูููุชุฑุฉ ูSafeSearch ุจุญุณุจ ุงูุนูุฑ.',
      'ุฌูุณุฉ ุญูุงุฑ ูุตูุฑุฉ ุจูุง ููู ูุน ุงูุทูู.',
      'ุชูุนูู ูุงุฆูุฉ ููุงูุน ุจุฏููุฉ ุขููุฉ.',
      'ูุชุงุจุนุฉ ุฃุณุจูุนูุฉ ูููุงุณ ุงูุชูุฑุงุฑ.',
    ],
    incidentPlanEn: [
      'Block the source immediately (link/account/app).',
      'Increase filtering and SafeSearch strictness.',
      'Run a short non-blaming discussion with the child.',
      'Provide trusted safe alternatives.',
      'Track recurrence weekly.',
    ],
    alertTemplatesAr: [
      'ุชูุจูู ูุฑุชูุน: ุชุนุฑุถ ูุญุชูู ููุญุชูู ุฌูุณู ุบูุฑ ููุงุณุจ. ุชู ุชุดุฏูุฏ ุงูููุชุฑุฉ.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุชู ุชูููุฐ ุฎุทุฉ ุงุญุชูุงุก ุชุฑุจูู ููุฑุงุฌุนุฉ ูุตุฏุฑ ุงููุตูู.',
    ],
    alertTemplatesEn: [
      'High alert: potential sexual explicit-content exposure. Filtering has been tightened.',
      'Follow-up alert: educational containment plan and source review completed.',
    ],
    preferBlackout: false,
    preferSiren: false,
  },
  violent_content: {
    id: 'violent_content',
    badgeLabelAr: 'ูุญุชูู ุนููู',
    badgeLabelEn: 'Violent Content',
    narrativeAr:
      'ุงููุคุดุฑ ุงูุญุงูู ูุฑุชุจุท ุจุชุนุฑุถ ูุชูุฑุฑ ููุญุชูู ุนููู/ุชุญุฑูุถูุ ุงูุฃููููุฉ ููุงุญุชูุงุก ุงูููุฑูุ ุงูุชูุฏุฆุฉุ ูุชูููู ูุญูุฒุงุช ุงูุนูู.',
    narrativeEn:
      'Current pattern indicates repeated exposure to violent/harmful content. Prioritize immediate containment and de-escalation.',
    incidentPlanAr: [
      'ุฅููุงู ุงููุตุฏุฑ ุงูุนููู ูุญุธุฑ ุงูุญุณุงุจ/ุงูููุงุฉ ุงููุฑุชุจุทุฉ.',
      'ุชูุนูู ุดุงุดุฉ ุญูุงูุฉ ูุคูุชุฉ ูุน ุฑุณุงูุฉ ุชูุฏุฆุฉ.',
      'ูุฑุงุฌุนุฉ ุณุฌู ุงููุดุงูุฏุฉ ูุชุญุฏูุฏ ููุงุท ุงูุงุณุชุฏุฑุงุฌ.',
      'ุฌูุณุฉ ุชูุนูุฉ ุญูู ุงููุฑู ุจูู ุงููุญุชูู ุงูุชุฑูููู ูุงูุชุญุฑูุถ.',
      'ูุชุงุจุนุฉ ููููุฉ ูุตูุฑุฉ ุญุชู ุงุณุชูุฑุงุฑ ุงูููุท.',
    ],
    incidentPlanEn: [
      'Block the violent source and related account/channel.',
      'Enable temporary safety blackout with calming message.',
      'Review watch history and lure vectors.',
      'Run a brief guidance talk about harmful content.',
      'Track daily until pattern stabilizes.',
    ],
    alertTemplatesAr: [
      'ุชูุจูู ุญุฑุฌ: ุชุนุฑุถ ูุชูุฑุฑ ููุญุชูู ุนููู/ุชุญุฑูุถู. ุชู ุจุฏุก ุงูุงุญุชูุงุก ุงูููุงุฆู.',
      'ุชูุจูู ูุชุงุจุนุฉ: ุฌุงุฑู ุชูููู ูุญูุฒุงุช ุงูุนูู ููุฑุงุฌุนุฉ ุงููููุงุช ุงููุฑุชุจุทุฉ.',
    ],
    alertTemplatesEn: [
      'Critical alert: repeated violent-content exposure detected. Protective containment started.',
      'Follow-up alert: violence triggers are being reduced and channels reviewed.',
    ],
    preferBlackout: true,
    preferSiren: true,
  },
};

const inferContentSubtypeFromKeywords = (keywords: string[]): InappropriateContentSubtype => {
  const hay = (keywords || []).join(' ').toLowerCase();
  if (
    hay.includes('violent') ||
    hay.includes('gore') ||
    hay.includes('ุนููู') ||
    hay.includes('ุชุญุฑูุถ') ||
    hay.includes('ุฏููู')
  ) {
    return 'violent_content';
  }
  return 'sexual_content';
};

const PsychologicalInsightView: React.FC<PsychologicalInsightViewProps> = ({
  theme,
  child,
  alerts = [],
  lang = 'ar',
  autoLockInAutomationEnabled = true,
  allLocksDisabled = false,
  onAcceptPlan,
  onApplyModeToChild,
  onPlanExecutionResult,
  onSaveExecutionEvidence,
}) => {
  const profile = child?.psychProfile;
  const navigate = useNavigate();
  const primaryCardRef = useRef<HTMLDivElement | null>(null);
  const radarContainerRef = useRef<HTMLDivElement | null>(null);
  const trendContainerRef = useRef<HTMLDivElement | null>(null);
  const [radarSize, setRadarSize] = useState({ width: 0, height: 0 });
  const [trendSize, setTrendSize] = useState({ width: 0, height: 0 });
  const diagnosis = useMemo(
    () => diagnosePsychScenarioFromAlerts(child?.name || '', alerts),
    [child?.name, alerts]
  );

  const [activeScenarioId, setActiveScenarioId] = useState<GuidanceScenario['id']>(
    diagnosis?.scenarioId || inferScenarioId(child)
  );
  const [expandedScenarioId, setExpandedScenarioId] = useState<GuidanceScenario['id'] | null>(
    diagnosis?.scenarioId || inferScenarioId(child)
  );
  const [expandedSectionMap, setExpandedSectionMap] = useState<Record<string, boolean>>({});
  const [copiedPlan, setCopiedPlan] = useState(false);
  const [autoSelection, setAutoSelection] = useState<Record<string, boolean>>({});
  const [autoStatus, setAutoStatus] = useState<Record<string, AutoStepStatus>>({});
  const [isAutoRunning, setIsAutoRunning] = useState(false);
  const [autoRunSummary, setAutoRunSummary] = useState('');
  const [executionTimeline, setExecutionTimeline] = useState<PlanTimelineEntry[]>([]);
  const [timelineFilter, setTimelineFilter] = useState<'all' | PlanTimelineStatus>('all');
  const [isSavingExecutionEvidence, setIsSavingExecutionEvidence] = useState(false);
  const [planVideoSource, setPlanVideoSource] = useState<PlanVideoSource>('screen');
  const [planAudioSource, setPlanAudioSource] = useState<PlanAudioSource>('mic');
  const [playbooks, setPlaybooks] = useState<SafetyPlaybook[]>([]);
  const [blackoutMessage, setBlackoutMessage] = useState(
    lang === 'ar'
      ? 'ุชู ููู ุงูุฌูุงุฒ ูุฏูุงุนู ุงูุฃูุงู. ูุฑุฌู ุงูุชูุงุตู ูุน ุงููุงูุฏูู.'
      : 'Device locked for safety. Please contact a parent.'
  );

  const activeScenario = useMemo(
    () => guidanceScenarios.find((s) => s.id === activeScenarioId) || guidanceScenarios[0],
    [activeScenarioId]
  );
  const recentKeywordsSignature = (child?.psychProfile?.recentKeywords || []).join('||');

  const threatSubtype = useMemo<ThreatExposureSubtype>(() => {
    if (activeScenario.id !== 'threat_exposure') return 'direct_threat';
    return diagnosis?.threatSubtype || inferThreatSubtypeFromKeywords(child?.psychProfile?.recentKeywords || []);
  }, [activeScenario.id, recentKeywordsSignature, diagnosis?.threatSubtype]);

  const contentSubtype = useMemo<InappropriateContentSubtype>(() => {
    if (activeScenario.id !== 'inappropriate_content') return 'sexual_content';
    return diagnosis?.contentSubtype || inferContentSubtypeFromKeywords(child?.psychProfile?.recentKeywords || []);
  }, [activeScenario.id, recentKeywordsSignature, diagnosis?.contentSubtype]);

  const activeThreatTrack = useMemo(
    () => threatTrackProfiles[threatSubtype],
    [threatSubtype]
  );

  const activeContentTrack = useMemo(
    () => contentTrackProfiles[contentSubtype],
    [contentSubtype]
  );

  const resolvedIncidentPlan = useMemo(() => {
    if (activeScenario.id === 'threat_exposure') {
      return lang === 'ar' ? activeThreatTrack.incidentPlanAr : activeThreatTrack.incidentPlanEn;
    }
    if (activeScenario.id === 'inappropriate_content') {
      return lang === 'ar' ? activeContentTrack.incidentPlanAr : activeContentTrack.incidentPlanEn;
    }
    return activeScenario.incidentPlan;
  }, [activeScenario.id, activeScenario.incidentPlan, activeThreatTrack, activeContentTrack, lang]);

  const resolvedAlertTemplates = useMemo(() => {
    if (activeScenario.id === 'threat_exposure') {
      return lang === 'ar' ? activeThreatTrack.alertTemplatesAr : activeThreatTrack.alertTemplatesEn;
    }
    if (activeScenario.id === 'inappropriate_content') {
      return lang === 'ar' ? activeContentTrack.alertTemplatesAr : activeContentTrack.alertTemplatesEn;
    }
    return activeScenario.alertTemplates;
  }, [activeScenario.id, activeScenario.alertTemplates, activeThreatTrack, activeContentTrack, lang]);

  const fallbackBlackoutMessage = useMemo(
    () =>
      lang === 'ar'
        ? 'ุชู ููู ุงูุฌูุงุฒ ูุฏูุงุนู ุงูุฃูุงู. ูุฑุฌู ุงูุชูุงุตู ูุน ุงููุงูุฏูู.'
        : 'Device locked for safety. Please contact a parent.',
    [lang]
  );

  useEffect(() => {
    setActiveScenarioId(diagnosis?.scenarioId || inferScenarioId(child));
    setExpandedScenarioId(diagnosis?.scenarioId || inferScenarioId(child));
  }, [
    child?.id,
    child?.psychProfile?.priorityScenario,
    recentKeywordsSignature,
    diagnosis?.scenarioId,
  ]);

  useEffect(() => {
    let mounted = true;
    const loadPlaybooks = async () => {
      if (!child?.parentId) {
        if (mounted) setPlaybooks([]);
        return;
      }
      try {
        const stored = await fetchPlaybooks(child.parentId);
        if (!mounted) return;
        setPlaybooks(stored);
      } catch (error) {
        if (!mounted) return;
        console.warn('Failed to load psychological playbooks:', error);
        setPlaybooks([]);
      }
    };
    void loadPlaybooks();
    return () => {
      mounted = false;
    };
  }, [child?.parentId]);

  useEffect(() => {
    if (!blackoutMessage.trim()) {
      setBlackoutMessage(fallbackBlackoutMessage);
    }
  }, [blackoutMessage, fallbackBlackoutMessage]);

  useEffect(() => {
    const el = primaryCardRef.current;
    if (!el) return;
    requestAnimationFrame(() => {
      el.scrollIntoView({ behavior: 'auto', block: 'start' });
      el.focus({ preventScroll: true });
    });
  }, [child?.id]);

  useEffect(() => {
    const node = radarContainerRef.current;
    if (!node) return;

    let raf = 0;
    const checkReady = () => {
      cancelAnimationFrame(raf);
      raf = requestAnimationFrame(() => {
        const rect = node.getBoundingClientRect();
        setRadarSize({
          width: Math.max(0, Math.floor(rect.width)),
          height: Math.max(0, Math.floor(rect.height)),
        });
      });
    };

    checkReady();
    const observer = new ResizeObserver(checkReady);
    observer.observe(node);
    return () => {
      cancelAnimationFrame(raf);
      observer.disconnect();
    };
  }, [child?.id]);

  useEffect(() => {
    const node = trendContainerRef.current;
    if (!node) return;

    let raf = 0;
    const checkReady = () => {
      cancelAnimationFrame(raf);
      raf = requestAnimationFrame(() => {
        const rect = node.getBoundingClientRect();
        setTrendSize({
          width: Math.max(0, Math.floor(rect.width)),
          height: Math.max(0, Math.floor(rect.height)),
        });
      });
    };

    checkReady();
    const observer = new ResizeObserver(checkReady);
    observer.observe(node);
    return () => {
      cancelAnimationFrame(raf);
      observer.disconnect();
    };
  }, [child?.id]);

  if (!child || !profile) {
    return <div className="p-20 text-center font-black">ุฌุงุฑู ุชุญููู ุงููุจุถ ุงูููุณู...</div>;
  }

  const childAlerts = useMemo(() => {
    const norm = (value?: string) => (value || '').toLowerCase().replace(/\s+/g, ' ').trim();
    const childNameNorm = norm(child.name);
    return alerts
      .filter((alert) => {
        const alertNameNorm = norm(alert.childName);
        return (
          !!alertNameNorm &&
          !!childNameNorm &&
          (alertNameNorm === childNameNorm ||
            alertNameNorm.includes(childNameNorm) ||
            childNameNorm.includes(alertNameNorm))
        );
      })
      .sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());
  }, [alerts, child.name]);

  const clampScore = (value: number) => Math.max(0, Math.min(100, Math.round(value)));
  const severityToPressure: Record<AlertSeverity, number> = {
    [AlertSeverity.LOW]: 20,
    [AlertSeverity.MEDIUM]: 45,
    [AlertSeverity.HIGH]: 75,
    [AlertSeverity.CRITICAL]: 95,
  };

  const recentAlerts = childAlerts.slice(0, 8);
  const recentAlertPressure =
    recentAlerts.length > 0
      ? recentAlerts.reduce((sum, alert) => sum + severityToPressure[alert.severity], 0) / recentAlerts.length
      : 0;
  const diagnosticPressure =
    diagnosis?.topSignals?.length
      ? diagnosis.topSignals.reduce((sum, signal) => sum + severityToPressure[signal.severity], 0) /
        diagnosis.topSignals.length
      : 0;

  const anxietyScore = clampScore(
    profile.anxietyLevel * 0.65 + recentAlertPressure * 0.25 + diagnosticPressure * 0.1
  );
  const calmScore = clampScore(profile.moodScore * 0.7 + (100 - anxietyScore) * 0.3);
  const frustrationScore = clampScore((100 - profile.moodScore) * 0.65 + anxietyScore * 0.35);
  const isolationScore = clampScore(profile.isolationRisk * 0.8 + recentAlertPressure * 0.2);
  const aggressionScore = clampScore(
    anxietyScore * 0.38 + isolationScore * 0.34 + frustrationScore * 0.28
  );
  const riskComposite = clampScore(
    anxietyScore * 0.35 + frustrationScore * 0.2 + isolationScore * 0.2 + aggressionScore * 0.25
  );
  const stabilityScore = clampScore(calmScore * 0.6 + (100 - riskComposite) * 0.4);
  const readinessScore = profile.incidentReadinessScore ?? clampScore(100 - riskComposite * 0.7);
  const quickAdvisorTip =
    (diagnosis?.scenarioId === activeScenario.id ? diagnosis?.topSignals?.[0]?.suggestedAction : undefined) ||
    activeScenario.dialogues[0]?.advice ||
    resolvedIncidentPlan[0] ||
    profile.recommendation;

  const radarData = [
    { subject: 'ููู', A: anxietyScore, fullMark: 100 },
    { subject: 'ุฅุญุจุงุท', A: frustrationScore, fullMark: 100 },
    { subject: 'ุนุฒูุฉ', A: isolationScore, fullMark: 100 },
    { subject: 'ุนุฏูุงููุฉ', A: aggressionScore, fullMark: 100 },
    { subject: 'ูุฏูุก', A: calmScore, fullMark: 100 },
  ];

  const trendSeed = clampScore(riskComposite + recentAlertPressure * 0.08 - calmScore * 0.05);
  const weeklyTrend =
    profile.weeklyTrend && profile.weeklyTrend.length > 0
      ? profile.weeklyTrend
      : [
          { label: 'ุงูุงุซููู', value: clampScore(trendSeed - 6) },
          { label: 'ุงูุซูุงุซุงุก', value: clampScore(trendSeed - 2) },
          { label: 'ุงูุฃุฑุจุนุงุก', value: clampScore(trendSeed + 1) },
          { label: 'ุงูุฎููุณ', value: clampScore(trendSeed + 4) },
          { label: 'ุงูุฌูุนุฉ', value: clampScore(trendSeed + 7) },
        ];

  const riskSignals = useMemo(() => {
    const diagnosticSignals = diagnosis?.topSignals || [];
    const profileSignals = profile.riskSignals || [];
    const merged = [...diagnosticSignals, ...profileSignals];
    const actionCandidates = Array.from(
      new Set(
        [
          ...diagnosticSignals.map((signal) => signal.suggestedAction),
          ...profileSignals.map((signal) => signal.suggestedAction),
          ...resolvedIncidentPlan,
          ...activeScenario.incidentPlan,
          activeScenario.dialogues[0]?.advice,
          profile.recommendation,
        ].filter((value): value is string => !!value && value.trim().length > 0)
      )
    );

    if (merged.length > 0) {
      const unique = new Map<string, (typeof merged)[number]>();
      for (const signal of merged) {
        const key = `${signal.title}-${signal.severity}-${signal.reason}`;
        if (!unique.has(key)) {
          unique.set(key, signal);
        }
      }
      const usedActions = new Set<string>();
      return Array.from(unique.values())
        .slice(0, 4)
        .map((signal, idx) => {
          let suggestedAction = signal.suggestedAction?.trim();
          if (!suggestedAction || usedActions.has(suggestedAction)) {
            suggestedAction =
              actionCandidates.find((candidate) => !usedActions.has(candidate)) ||
              actionCandidates[idx % Math.max(actionCandidates.length, 1)] ||
              profile.recommendation;
          }
          usedActions.add(suggestedAction);
          return { ...signal, suggestedAction };
        });
    }
    return [
      {
        id: `fallback-${activeScenario.id}`,
        title: activeScenario.title,
        severity: activeScenario.severity,
        reason: activeScenario.symptoms[0],
        suggestedAction: resolvedIncidentPlan[0] || activeScenario.incidentPlan[0],
      },
    ];
  }, [diagnosis?.topSignals, profile.riskSignals, activeScenario, profile.recommendation, resolvedIncidentPlan]);

  const dominantPlatform = useMemo(() => {
    const count = new Map<string, number>();
    for (const alert of childAlerts) {
      const key = (alert.platform || 'Unknown').trim();
      count.set(key, (count.get(key) || 0) + 1);
    }
    const sorted = Array.from(count.entries()).sort((a, b) => b[1] - a[1]);
    return sorted[0]?.[0] || childAlerts[0]?.platform || 'Discord';
  }, [childAlerts]);

  const dominantSeverity: AlertSeverity =
    diagnosis?.topSignals?.[0]?.severity || childAlerts[0]?.severity || activeScenario.severity;

  const cyberRiskStage = useMemo(() => {
    if (activeScenario.id !== 'cyber_crime') return null;
    if (dominantSeverity === AlertSeverity.CRITICAL) {
      return { badgeAr: 'ูุฑุญูุฉ ุงุญุชูุงุก', badgeEn: 'Containment Stage' };
    }
    if (severityRank[dominantSeverity] >= severityRank[AlertSeverity.HIGH]) {
      return { badgeAr: 'ูุฑุญูุฉ ุฅูุฐุงุฑ', badgeEn: 'Warning Stage' };
    }
    return { badgeAr: 'ูุฑุญูุฉ ุฑุตุฏ', badgeEn: 'Observation Stage' };
  }, [activeScenario.id, dominantSeverity]);

  const highRiskApp = useMemo(() => {
    const apps = child.appUsage || [];
    if (apps.length === 0) return null;
    const platformNorm = dominantPlatform.toLowerCase();
    const direct = apps.find((app) => app.appName.toLowerCase().includes(platformNorm));
    if (direct) return direct;
    const fallback = apps.find((app) =>
      ['discord', 'telegram', 'roblox', 'tiktok', 'snapchat', 'youtube'].some((name) =>
        app.appName.toLowerCase().includes(name)
      )
    );
    return fallback || apps[0];
  }, [child.appUsage, dominantPlatform]);

  const blockedDomains = useMemo(
    () => scenarioBlockedDomains[activeScenario.id] || [],
    [activeScenario.id]
  );

  const playbookDrivenSteps = useMemo<AutoExecutionStep[]>(() => {
    const category = scenarioToCategory(activeScenario.id, threatSubtype, contentSubtype, dominantSeverity);
    const actions = getDefenseActionsWithPlaybooks(category, dominantSeverity, playbooks, {
      allowAutoLock: autoLockInAutomationEnabled && !allLocksDisabled,
    });

    const priorityToSeverity = (priority: string): AlertSeverity => {
      if (priority === 'critical') return AlertSeverity.CRITICAL;
      if (priority === 'high') return AlertSeverity.HIGH;
      if (priority === 'medium') return AlertSeverity.MEDIUM;
      return AlertSeverity.LOW;
    };

    return actions
      .map((action) => ({
        id: `pb-${action.id}`,
        title: lang === 'ar' ? `ุฅุฌุฑุงุก ุจุฑูุชูููู: ${action.label}` : `Playbook Action: ${action.label}`,
        description:
          lang === 'ar'
            ? 'ุฎุทูุฉ ูุณุชุฑุฌุนุฉ ูู ุจุฑูุชููููุงุช ุงูุญูุงูุฉ ุงููุฎุตุตุฉ ููุนุงุฆูุฉ.'
            : 'A family-configured action restored from safety playbooks.',
        command: action.command as AutoExecutionStep['command'],
        value: action.payload ?? true,
        minSeverity: priorityToSeverity(action.priority),
        enabledByDefault: true,
      }));
  }, [
    activeScenario.id,
    allLocksDisabled,
    autoLockInAutomationEnabled,
    contentSubtype,
    dominantSeverity,
    lang,
    playbooks,
    threatSubtype,
  ]);

  useEffect(() => {
    if (activeScenario.id === 'gaming') {
      setPlanVideoSource('screen');
      setPlanAudioSource('system');
      return;
    }
    if (activeScenario.id === 'bullying') {
      setPlanVideoSource('camera_front');
      setPlanAudioSource('mic');
      return;
    }
    if (activeScenario.id === 'threat_exposure') {
      if (threatSubtype === 'financial_blackmail') {
        setPlanVideoSource('screen');
        setPlanAudioSource('system');
        return;
      }
      setPlanVideoSource('camera_front');
      setPlanAudioSource('mic');
      return;
    }
    if (activeScenario.id === 'inappropriate_content') {
      if (contentSubtype === 'violent_content') {
        setPlanVideoSource('camera_front');
        setPlanAudioSource('mic');
        return;
      }
      setPlanVideoSource('screen');
      setPlanAudioSource('system');
      return;
    }
    if (activeScenario.id === 'phishing_links') {
      setPlanVideoSource('screen');
      setPlanAudioSource('system');
      return;
    }
    if (
      activeScenario.id === 'account_theft_fraud' ||
      activeScenario.id === 'crypto_scams' ||
      activeScenario.id === 'gambling_betting' ||
      activeScenario.id === 'privacy_tracking'
    ) {
      setPlanVideoSource('screen');
      setPlanAudioSource('system');
      return;
    }
    if (
      activeScenario.id === 'self_harm' ||
      activeScenario.id === 'sexual_exploitation' ||
      activeScenario.id === 'harmful_challenges'
    ) {
      setPlanVideoSource('camera_front');
      setPlanAudioSource('mic');
      return;
    }
    setPlanVideoSource('screen');
    setPlanAudioSource('mic');
  }, [activeScenario.id, child?.id, contentSubtype, threatSubtype]);

  const digitalBalanceNarrative = useMemo(() => {
    const appLabel = highRiskApp?.appName || dominantPlatform;
    if (activeScenario.id === 'threat_exposure') {
      const base = lang === 'ar' ? activeThreatTrack.narrativeAr : activeThreatTrack.narrativeEn;
      return `${base} (${appLabel}).`;
    }
    if (activeScenario.id === 'inappropriate_content') {
      const base = lang === 'ar' ? activeContentTrack.narrativeAr : activeContentTrack.narrativeEn;
      return `${base} (${appLabel}).`;
    }
    if (activeScenario.id === 'bullying') {
      return `ููุตู ุจุชุดุฏูุฏ ุงูุฎุตูุตูุฉ ุฏุงุฎู ${appLabel}ุ ุชูููุฏ ุงููุฑุงุณูุฉ ูู ุงูุบุฑุจุงุกุ ูุชูุนูู ุจุฑูุชูููู "ูุซูู/ุงุญุธุฑ/ุจููุบ" ุชููุงุฆูุงู.`;
    }
    if (activeScenario.id === 'gaming') {
      return `ููุตู ุจุถุจุท ${appLabel} ุนุจุฑ ูุถุน ูุชูุงุฒู: ุฌูุณุงุช ูุนุจ ูุฌุฏููุฉ + ุฅููุงู ุงูุฅุดุนุงุฑุงุช ุงููุดุชุชุฉ + ููุน ุงูุงูุถูุงู ูุบุฑู ุนุงูุฉ ูุฑุชูุนุฉ ุงููุฎุงุทุฑ.`;
    }
    if (activeScenario.id === 'self_harm') {
      return `ููุตู ุจุฎุทุฉ ุฃูุงู ููุฑูุฉ ุนูู ${appLabel}: ุงุญุชูุงุก ูุจุงุดุฑุ ุชูููู ุงูุนุฒูุฉ ุงูุฑูููุฉุ ููุฑุงูุจุฉ ูุตููุฉ ูููุญูุฒุงุช ุนุงููุฉ ุงูุฎุทูุฑุฉ.`;
    }
    if (activeScenario.id === 'sexual_exploitation') {
      return `ููุตู ุจุนุฒู ูููุงุช ุงูุชูุงุตู ุงูุญุณุงุณุฉ ุนูู ${appLabel}ุ ุญูุงูุฉ ุงูุญุณุงุจ ููุฑุงูุ ูุฑุจุท ุฎุทุฉ ุงูุฅุจูุงุบ ุงูุฑุณูู ุจุงูุฃุฏูุฉ.`;
    }
    if (activeScenario.id === 'account_theft_fraud') {
      return `ููุตู ุจุชุฏููุฑ ูููุงุช ุงููุฑูุฑ ููุญุณุงุจุงุช ุงููุฑุชุจุทุฉ ุจู ${appLabel}ุ ุฅุบูุงู ุงูุฌูุณุงุช ุงููุดุทุฉุ ูุชูุนูู ุญูุงูุฉ ุงุณุชุฑุฏุงุฏ ูุดุฏุฏุฉ.`;
    }
    if (activeScenario.id === 'gambling_betting') {
      return `ููุตู ุจุฅููุงู ุงููุดุชุฑูุงุช ุงููุฑุชุจุทุฉ ุจู ${appLabel}ุ ุชูุนูู ุญุฏูุฏ ุฅููุงูุ ูุงุณุชุจุฏุงู ููุท ุงูุฑูุงู ุจุฃูุดุทุฉ ุจุฏููุฉ.`;
    }
    if (activeScenario.id === 'privacy_tracking') {
      return `ููุตู ุจุชูููู ุฃุซุฑ ${appLabel} ุนูู ุงูุฎุตูุตูุฉ: ุถุจุท ุงูุฃุฐููุงุชุ ุฅููุงู ุงูุชุชุจุนุ ูุชูุธูู ุงูุจูุงูุงุช ุงูููุดููุฉ.`;
    }
    if (activeScenario.id === 'harmful_challenges') {
      return `ููุตู ุจุนุฒู ูุฌููุนุงุช ุงูุชุฑูุฏุงุช ุงูุฎุทุฑุฉ ุนูู ${appLabel}ุ ูุน ุฎุทุฉ ุชุฏุฎู ุชุฑุจูู ุนุงุฌู ููุชุงุจุนุฉ ููููุฉ ูุตูุฑุฉ.`;
    }
    return `ููุตู ุจุฎุทุฉ ุชูุงุฒู ุฑููู ูุฎุตุตุฉ ูู ${appLabel}: ุชูููู ุณุทุญ ุงูุชุนุฑุถุ ุฑูุน ุงูุฑูุงุจุฉ ุงููุญุธูุฉุ ูุชูุนูู ุงุณุชุฌุงุจุฉ ุชููุงุฆูุฉ ุนูุฏ ุงุฑุชูุงุน ุงููุฎุงุทุฑ.`;
  }, [activeScenario.id, activeContentTrack, activeThreatTrack, dominantPlatform, highRiskApp?.appName, lang]);

  const autoExecutionSteps = useMemo<AutoExecutionStep[]>(
    () => {
      const baseSteps: AutoExecutionStep[] = [
      {
        id: 'snapshot',
        title: 'ุชูุซูู ููุฑู',
        description: 'ุฃุฎุฐ ููุทุฉ ุดุงุดุฉ ููุฑูุฉ ูุฅุซุจุงุช ุงูุญุงูุฉ ุงูุญุงููุฉ.',
        command: 'takeScreenshot',
        value: true,
        minSeverity: AlertSeverity.LOW,
        enabledByDefault: true,
      },
      {
        id: 'block-app',
        title: 'ุญุธุฑ ุงูุชุทุจูู ุงูุฃุนูู ุฎุทูุฑุฉ',
        description: highRiskApp
          ? `ุชูุนูู ุญุธุฑ ${highRiskApp.appName} ูุคูุชูุง ูุญูู ูุฑุงุฌุนุฉ ุงููุดุฑู.`
          : 'ูุง ููุฌุฏ ุชุทุจูู ูุฑุตูุฏ ููุชู ุญุธุฑู ุชููุงุฆููุง.',
        command: 'blockApp',
        value: highRiskApp
          ? {
            appId: highRiskApp.id,
            appName: highRiskApp.appName,
            blocked: true,
            isBlocked: true,
            reason: 'digital_balance_auto',
          }
          : null,
        minSeverity: AlertSeverity.MEDIUM,
        enabledByDefault: !!highRiskApp,
      },
      {
        id: 'video-source',
        title: 'ุถุจุท ูุตุฏุฑ ุงูุตูุฑุฉ',
        description: 'ุชุญุฏูุฏ ูุตุฏุฑ ุงูุจุซ: ุดุงุดุฉ ุงูุฌูุงุฒ.',
        command: 'setVideoSource',
        value: planVideoSource,
        minSeverity: AlertSeverity.HIGH,
        enabledByDefault: true,
      },
      {
        id: 'audio-source',
        title: 'ุถุจุท ูุตุฏุฑ ุงูุตูุช',
        description: 'ุชุญุฏูุฏ ูุตุฏุฑ ุงูุตูุช: ูููุฑูููู ุงูุฌูุงุฒ.',
        command: 'setAudioSource',
        value: planAudioSource,
        minSeverity: AlertSeverity.HIGH,
        enabledByDefault: true,
      },
      {
        id: 'start-stream',
        title: 'ุจุฏุก ุจุซ ุฑูุงุจู ูุจุงุดุฑ',
        description: 'ุชุดุบูู ุจุซ ูุจุงุดุฑ ูููุฑุงุฌุนุฉ ุงูุณุฑูุนุฉ ูู ููู ุงูุฃูุฑ.',
        command: 'startLiveStream',
        value: {
          videoSource: planVideoSource,
          audioSource: planAudioSource,
          source: 'digital_balance_auto',
        },
        minSeverity: AlertSeverity.HIGH,
        enabledByDefault: true,
      },
      {
        id: 'lock-device',
        title: 'ููู ููุงุฆู ูุคูุช',
        description: 'ููู ูุคูุช ููุฌูุงุฒ ุญุชู ุงูุชูุงู ุงูุชูููู.',
        command: 'lockDevice',
        value: true,
        minSeverity: AlertSeverity.CRITICAL,
        enabledByDefault: true,
      },
      {
        id: 'blackout-screen',
        title: 'ุดุงุดุฉ ุณูุฏุงุก ุจุฑุณุงูุฉ ุญูุงูุฉ',
        description: 'ุชูุนูู ุญุฌุจ ุงูุฌูุงุฒ ูุน ุฑุณุงูุฉ ุฅุฑุดุงุฏูุฉ ููุทูู ุญุชู ูุฑุงุฌุนุฉ ุงููุงูุฏูู.',
        command: 'lockscreenBlackout',
        value: { enabled: true, source: 'digital_balance_auto' },
        minSeverity: AlertSeverity.HIGH,
        enabledByDefault:
          activeScenario.id === 'bullying' ||
          activeScenario.id === 'self_harm' ||
          activeScenario.id === 'sexual_exploitation' ||
          activeScenario.id === 'harmful_challenges' ||
          (activeScenario.id === 'threat_exposure' && activeThreatTrack.preferBlackout) ||
          (activeScenario.id === 'inappropriate_content' && activeContentTrack.preferBlackout),
      },
      {
        id: 'walkie-enable',
        title: 'ุชูุนูู ููุงุฉ Walkie-Talkie',
        description: 'ุชูุนูู ููุงุฉ ุงูุชูุงุตู ุงูุตูุชู ุงูููุฑู ุจูู ุงููุงูุฏ ูุงูุทูู.',
        command: 'walkieTalkieEnable',
        value: { enabled: true, source: 'mic' },
        minSeverity: AlertSeverity.HIGH,
        enabledByDefault:
          activeScenario.id === 'self_harm' ||
          activeScenario.id === 'sexual_exploitation' ||
          activeScenario.id === 'harmful_challenges' ||
          (activeScenario.id === 'threat_exposure' && activeThreatTrack.preferWalkie),
      },
      {
        id: 'net-quarantine',
        title: 'ุนุฒู ุงูุดุจูุฉ ูุคูุชุงู',
        description: 'ูุทุน ุงุชุตุงู ุงูุฅูุชุฑูุช ูุคูุชุงู ูููุน ุงูุชุญูููุงุช ุฃู ุงุณุชููุงู ุงููุณุงุฑุงุช ุงูุฎุทุฑุฉ.',
        command: 'cutInternet',
        value: true,
        minSeverity: AlertSeverity.HIGH,
        enabledByDefault:
          (activeScenario.id === 'threat_exposure' && activeThreatTrack.preferCutInternet) ||
          activeScenario.id === 'phishing_links' ||
          activeScenario.id === 'account_theft_fraud',
      },
      {
        id: 'siren',
        title: 'ุตุงูุฑุฉ ุฑุฏุน',
        description: 'ุชุดุบูู ุตุงูุฑุฉ ูู ุงูุญุงูุงุช ุงูุญุฑุฌุฉ ุฌุฏูุง.',
        command: 'playSiren',
        value: true,
        minSeverity: AlertSeverity.CRITICAL,
        enabledByDefault:
          activeScenario.id === 'harmful_challenges' ||
          (activeScenario.id === 'threat_exposure' && activeThreatTrack.preferSiren) ||
          (activeScenario.id === 'inappropriate_content' && activeContentTrack.preferSiren),
      },
      ];

      const merged = [...baseSteps];
      for (const step of playbookDrivenSteps) {
        if (!merged.some((existing) => existing.command === step.command)) {
          merged.push(step);
        }
      }
      if (allLocksDisabled || !autoLockInAutomationEnabled) {
        return merged.filter((step) => !isAutoLockCommand(step.command));
      }
      return merged;
    },
    [
      activeContentTrack,
      activeScenario.id,
      allLocksDisabled,
      autoLockInAutomationEnabled,
      activeThreatTrack,
      highRiskApp,
      planAudioSource,
      planVideoSource,
      playbookDrivenSteps,
    ]
  );

  useEffect(() => {
    const initSelection: Record<string, boolean> = {};
    const initStatus: Record<string, AutoStepStatus> = {};
    for (const step of autoExecutionSteps) {
      initSelection[step.id] = step.enabledByDefault;
      initStatus[step.id] = 'idle';
    }
    setAutoSelection(initSelection);
    setAutoStatus(initStatus);
    setAutoRunSummary('');
    setExecutionTimeline([]);
    setTimelineFilter('all');
  }, [child?.id, activeScenario.id, dominantSeverity, highRiskApp?.id, autoExecutionSteps]);

  const pushTimeline = (entry: Omit<PlanTimelineEntry, 'id' | 'at'>) => {
    setExecutionTimeline((prev) =>
      [
        {
          id: `timeline-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,
          at: new Date(),
          ...entry,
        },
        ...prev,
      ].slice(0, 40)
    );
  };

  const buildSuggestedPlan = (): Partial<CustomMode> => {
    const frequentApps = [...(child.appUsage || [])]
      .sort((a, b) => b.minutesUsed - a.minutesUsed)
      .slice(0, 3)
      .map((app) => app.appName);

    return {
      name: `Digital Balance Mode - ${child.name}`,
      icon: 'DB',
      color: 'bg-indigo-900',
      allowedApps: frequentApps.length > 0 ? frequentApps : ['School App', 'WhatsApp'],
      allowedUrls: [],
      blacklistedUrls: blockedDomains,
      isInternetCut:
        dominantSeverity === AlertSeverity.CRITICAL ||
        (activeScenario.id === 'threat_exposure' && activeThreatTrack.preferCutInternet) ||
        activeScenario.id === 'phishing_links' ||
        activeScenario.id === 'account_theft_fraud',
      isDeviceLocked: false,
      isScreenDimmed: true,
      cameraEnabled: dominantSeverity !== AlertSeverity.CRITICAL,
      micEnabled: true,
      internetStartTime: '06:00',
      internetEndTime: '22:00',
      activeDays: [0, 1, 2, 3, 4, 5, 6],
      preferredVideoSource: planVideoSource,
      preferredAudioSource: planAudioSource,
      autoStartLiveStream: severityRank[dominantSeverity] >= severityRank[AlertSeverity.HIGH],
      autoTakeScreenshot: true,
      blackoutOnApply:
        severityRank[dominantSeverity] >= severityRank[AlertSeverity.HIGH] &&
        !allLocksDisabled &&
        (activeScenario.id === 'threat_exposure'
          ? activeThreatTrack.preferBlackout
          : activeScenario.id === 'inappropriate_content'
            ? activeContentTrack.preferBlackout
            : true),
      blackoutMessage: blackoutMessage.trim() || fallbackBlackoutMessage,
      enableWalkieTalkieOnApply:
        activeScenario.id === 'bullying' ||
        activeScenario.id === 'self_harm' ||
        activeScenario.id === 'sexual_exploitation' ||
        activeScenario.id === 'harmful_challenges' ||
        (activeScenario.id === 'threat_exposure' && activeThreatTrack.preferWalkie),
    };
  };

  const handleApplyEmergencyPlan = () => {
    const suggested = buildSuggestedPlan();
    onAcceptPlan(suggested);
    navigate('/modes', { state: { suggestedMode: suggested } });
  };

  const toggleAutoStep = (stepId: string) => {
    if (isAutoRunning) return;
    setAutoSelection((prev) => ({ ...prev, [stepId]: !prev[stepId] }));
  };

  const runAutoExecutionPlan = async () => {
    if (isAutoRunning) return;
    setIsAutoRunning(true);
    setAutoRunSummary('');
    pushTimeline({
      title: lang === 'ar' ? 'ุจุฏุก ุงูุชูููุฐ' : 'Execution started',
      detail:
        lang === 'ar'
          ? `ุจุฏุก ุชุดุบูู ุงูุฎุทุฉ ุนูู ${child.name}.`
          : `Started running the plan for ${child.name}.`,
      status: 'info',
    });

    let done = 0;
    let failed = 0;
    let skipped = 0;
    const currentSeverityRank = severityRank[dominantSeverity];

    for (const step of autoExecutionSteps) {
      if (!autoSelection[step.id]) {
        setAutoStatus((prev) => ({ ...prev, [step.id]: 'skipped' }));
        pushTimeline({
          title: step.title,
          detail: lang === 'ar' ? 'ุชู ุงูุชุฎุทู (ุบูุฑ ูุญุฏุฏ).' : 'Skipped (not selected).',
          status: 'skipped',
        });
        skipped += 1;
        continue;
      }

      if (currentSeverityRank < severityRank[step.minSeverity]) {
        setAutoStatus((prev) => ({ ...prev, [step.id]: 'skipped' }));
        pushTimeline({
          title: step.title,
          detail:
            lang === 'ar'
              ? `ุชู ุงูุชุฎุทู ูุฃู ูุณุชูู ุงูุฎุทุฑ ุงูุญุงูู ุฃูู ูู ุงูุญุฏ ุงูุฃุฏูู (${step.minSeverity}).`
              : `Skipped because current severity is below minimum (${step.minSeverity}).`,
          status: 'skipped',
        });
        skipped += 1;
        continue;
      }

      if (step.command === 'blockApp' && !highRiskApp) {
        setAutoStatus((prev) => ({ ...prev, [step.id]: 'skipped' }));
        pushTimeline({
          title: step.title,
          detail: lang === 'ar' ? 'ุชู ุงูุชุฎุทู ูุนุฏู ูุฌูุฏ ุชุทุจูู ุนุงูู ุงูุฎุทูุฑุฉ.' : 'Skipped (no high-risk app).',
          status: 'skipped',
        });
        skipped += 1;
        continue;
      }

      if ((allLocksDisabled || !autoLockInAutomationEnabled) && isAutoLockCommand(step.command)) {
        setAutoStatus((prev) => ({ ...prev, [step.id]: 'skipped' }));
        pushTimeline({
          title: step.title,
          detail:
            lang === 'ar'
              ? allLocksDisabled
                ? 'ุชุฎุทู ุงูุฅุฌุฑุงุก ูุฃู ุชุนุทูู ุฌููุน ุงูุฃููุงู ููุนู ูู ุงูุฅุนุฏุงุฏุงุช.'
                : 'ุชุฎุทู ุงูุฅุฌุฑุงุก ูุฃู ุงูููู ุงูุชููุงุฆู ูุนุทู ูู ุฅุนุฏุงุฏุงุช ุงููุทูุฑ.'
              : allLocksDisabled
                ? 'Skipped because all locks are disabled in settings.'
                : 'Skipped because automatic lock is disabled in settings.',
          status: 'skipped',
        });
        skipped += 1;
        continue;
      }

      try {
        setAutoStatus((prev) => ({ ...prev, [step.id]: 'pending' }));
        let commandValue = step.value;
        if (step.command === 'lockscreenBlackout') {
          commandValue = {
            enabled: true,
            message: blackoutMessage.trim() || fallbackBlackoutMessage,
            source: 'digital_balance_auto',
          };
        }
        if (step.command === 'walkieTalkieEnable') {
          commandValue = {
            enabled: true,
            source: planAudioSource,
            sourceTag: 'digital_balance_auto',
          };
        }
        await sendRemoteCommand(child.id, step.command, commandValue);
        setAutoStatus((prev) => ({ ...prev, [step.id]: 'done' }));
        pushTimeline({
          title: step.title,
          detail: lang === 'ar' ? 'ุชู ุงูุชูููุฐ ุจูุฌุงุญ.' : 'Executed successfully.',
          status: 'done',
        });
        done += 1;
      } catch (error) {
        console.error(`Auto step failed: ${step.id}`, error);
        setAutoStatus((prev) => ({ ...prev, [step.id]: 'error' }));
        pushTimeline({
          title: step.title,
          detail: lang === 'ar' ? 'ูุดู ุงูุชูููุฐ.' : 'Execution failed.',
          status: 'error',
        });
        failed += 1;
      }
    }

    const summary = { done, skipped, failed };
    setIsAutoRunning(false);
    setAutoRunSummary(
      lang === 'ar'
        ? `ุชู ุชูููุฐ ${done} ุฎุทูุฉุ ุชุฎุทู ${skipped}ุ ููุดู ${failed}.`
        : `Executed ${done} steps, skipped ${skipped}, failed ${failed}.`
    );
    pushTimeline({
      title: lang === 'ar' ? 'ููุฎุต ุงูุชูููุฐ' : 'Execution summary',
      detail:
        lang === 'ar'
          ? `${done} ุชูุ ${skipped} ุชุฎุทูุ ${failed} ูุดู.`
          : `${done} done, ${skipped} skipped, ${failed} failed.`,
      status: failed > 0 ? 'error' : 'done',
    });
    onPlanExecutionResult?.(summary);
    return summary;
  };

  const runPlanAndCreateMode = async () => {
    await runAutoExecutionPlan();
    const suggested = buildSuggestedPlan();
    const modeId = onAcceptPlan(suggested);
    pushTimeline({
      title: lang === 'ar' ? 'ุญูุธ ุงููุถุน ุงูุฐูู' : 'Smart mode saved',
      detail:
        lang === 'ar'
          ? `ุชู ุญูุธ ุงููุถุน ${suggested.name || ''}.`
          : `Saved mode ${suggested.name || ''}.`,
      status: 'done',
    });
    if (!modeId) {
      pushTimeline({
        title: lang === 'ar' ? 'ูุนุฑู ุงููุถุน' : 'Mode ID',
        detail:
          lang === 'ar'
            ? 'ุชู ุญูุธ ุงููุถุน ุจุฏูู ูุนุฑู ููุฑูุ ูููู ุชุทุจููู ูู ุตูุญุฉ ุงูุฃูุถุงุน.'
            : 'Mode saved without immediate id. You can apply it from Modes page.',
        status: 'info',
      });
      navigate('/modes', { state: { suggestedMode: suggested } });
      return;
    }
    if (onApplyModeToChild) {
      try {
        await onApplyModeToChild(child.id, modeId);
        pushTimeline({
          title: lang === 'ar' ? 'ุชุทุจูู ุงููุถุน' : 'Mode applied',
          detail:
            lang === 'ar'
              ? `ุชู ุชุทุจูู ุงููุถุน ุนูู ${child.name}.`
              : `Applied mode to ${child.name}.`,
          status: 'done',
        });
      } catch (error) {
        pushTimeline({
          title: lang === 'ar' ? 'ุชุทุจูู ุงููุถุน' : 'Mode apply',
          detail: lang === 'ar' ? 'ูุดู ุชุทุจูู ุงููุถุน.' : 'Failed to apply mode.',
          status: 'error',
        });
        console.error('Apply mode from pulse failed', error);
      }
    }
  };

  const stepStateClass = (status: AutoStepStatus) => {
    if (status === 'done') return 'bg-emerald-100 text-emerald-700 border-emerald-200';
    if (status === 'pending') return 'bg-indigo-100 text-indigo-700 border-indigo-200';
    if (status === 'error') return 'bg-rose-100 text-rose-700 border-rose-200';
    if (status === 'skipped') return 'bg-slate-100 text-slate-500 border-slate-200';
    return 'bg-slate-50 text-slate-500 border-slate-100';
  };

  const stepStateLabel = (status: AutoStepStatus) => {
    if (lang === 'ar') {
      if (status === 'done') return 'ุชู';
      if (status === 'pending') return 'ููุฏ ุงูุชูููุฐ';
      if (status === 'error') return 'ูุดู';
      if (status === 'skipped') return 'ุชุฎุทู';
      return 'ุฌุงูุฒ';
    }
    if (status === 'done') return 'Done';
    if (status === 'pending') return 'Running';
    if (status === 'error') return 'Failed';
    if (status === 'skipped') return 'Skipped';
    return 'Idle';
  };

  const timelineBadgeClass = (status: PlanTimelineStatus) => {
    if (status === 'done') return 'bg-emerald-100 text-emerald-700 border-emerald-200';
    if (status === 'error') return 'bg-rose-100 text-rose-700 border-rose-200';
    if (status === 'skipped') return 'bg-slate-100 text-slate-600 border-slate-200';
    return 'bg-indigo-100 text-indigo-700 border-indigo-200';
  };

  const timelineStatusLabel = (status: PlanTimelineStatus) => {
    if (lang !== 'ar') return status;
    if (status === 'done') return 'ุชู';
    if (status === 'error') return 'ูุดู';
    if (status === 'skipped') return 'ุชุฎุทู';
    return 'ูุนูููุฉ';
  };

  const filteredExecutionTimeline = useMemo(() => {
    if (timelineFilter === 'all') return executionTimeline;
    return executionTimeline.filter((entry) => entry.status === timelineFilter);
  }, [executionTimeline, timelineFilter]);

  const executionSummary = useMemo(() => {
    return executionTimeline.reduce(
      (acc, entry) => {
        if (entry.status === 'done') acc.done += 1;
        if (entry.status === 'error') acc.failed += 1;
        if (entry.status === 'skipped') acc.skipped += 1;
        return acc;
      },
      { done: 0, failed: 0, skipped: 0 }
    );
  }, [executionTimeline]);

  const saveExecutionTimelineToVault = async () => {
    if (!onSaveExecutionEvidence || executionTimeline.length === 0 || isSavingExecutionEvidence) return;

    setIsSavingExecutionEvidence(true);
    try {
      const recordId = await onSaveExecutionEvidence({
        childId: child.id,
        childName: child.name,
        scenarioId: activeScenario.id,
        threatSubtype: activeScenario.id === 'threat_exposure' ? threatSubtype : undefined,
        contentSubtype: activeScenario.id === 'inappropriate_content' ? contentSubtype : undefined,
        scenarioTitle: activeScenario.title,
        severity: dominantSeverity,
        dominantPlatform,
        summary: executionSummary,
        timeline: executionTimeline.map((entry) => ({
          title: entry.title,
          detail: entry.detail,
          status: entry.status,
          at: entry.at.toISOString(),
        })),
      });

      pushTimeline({
        title: lang === 'ar' ? 'ุญูุธ ูู ุงูุฎุฒูุฉ' : 'Saved to vault',
        detail:
          lang === 'ar'
            ? 'ุชู ุญูุธ ุณุฌู ุงูุชูููุฐ ูุฏููู ูู ุงูุฃุฑุดูู ุงูุฌูุงุฆู.'
            : 'Execution timeline was saved as forensic evidence.',
        status: 'done',
      });

      if (recordId) {
        navigate('/vault', { state: { openAlertId: recordId, presetFilter: 'pulse' } });
      }
    } catch (error) {
      console.error('Save execution evidence failed', error);
      pushTimeline({
        title: lang === 'ar' ? 'ุญูุธ ูู ุงูุฎุฒูุฉ' : 'Save to vault',
        detail:
          lang === 'ar'
            ? 'ูุดู ุญูุธ ุณุฌู ุงูุชูููุฐ ูู ุงูุฎุฒูุฉ.'
            : 'Failed to save execution timeline to vault.',
        status: 'error',
      });
    } finally {
      setIsSavingExecutionEvidence(false);
    }
  };

  const exportExecutionTimeline = () => {
    if (filteredExecutionTimeline.length === 0) return;

    const exportPayload = filteredExecutionTimeline.map((entry) => ({
      title: entry.title,
      detail: entry.detail,
      status: entry.status,
      timestamp: entry.at.toISOString(),
      childName: child.name,
      scenarioId: activeScenario.id,
      severity: dominantSeverity,
    }));

    const blob = new Blob([JSON.stringify(exportPayload, null, 2)], {
      type: 'application/json;charset=utf-8',
    });
    const objectUrl = URL.createObjectURL(blob);
    const anchor = document.createElement('a');
    anchor.href = objectUrl;
    anchor.download = `amanah-execution-timeline-${child.id}-${Date.now()}.json`;
    document.body.appendChild(anchor);
    anchor.click();
    anchor.remove();
    URL.revokeObjectURL(objectUrl);
  };

  const copyIncidentPlan = async () => {
    const payload = [
      `ุฎุทุฉ 10 ุฏูุงุฆู: ${activeScenario.title}`,
      ...resolvedIncidentPlan.map((step, idx) => `${idx + 1}. ${step}`),
    ].join('\n');

    try {
      await navigator.clipboard.writeText(payload);
      setCopiedPlan(true);
      setTimeout(() => setCopiedPlan(false), 1500);
    } catch {
      setCopiedPlan(false);
    }
  };

  const previewCount = 2;
  const sectionStateKey = (scenarioId: PsychScenarioId, section: ScenarioSectionKey) =>
    `${scenarioId}:${section}`;
  const isSectionExpanded = (scenarioId: PsychScenarioId, section: ScenarioSectionKey) =>
    !!expandedSectionMap[sectionStateKey(scenarioId, section)];
  const toggleSectionExpansion = (scenarioId: PsychScenarioId, section: ScenarioSectionKey) => {
    const key = sectionStateKey(scenarioId, section);
    setExpandedSectionMap((prev) => ({ ...prev, [key]: !prev[key] }));
  };

  const scenarioOperationalContext: Record<PsychScenarioId, { riskLabel: string; responseWindow: string }> = {
    bullying: { riskLabel: 'ุฃุฐู ุงุฌุชูุงุนู ูููุณู ููุชุฏ', responseWindow: '48 ุณุงุนุฉ' },
    threat_exposure: { riskLabel: 'ุชูุฏูุฏ ูุจุงุดุฑ ูุงุจุชุฒุงุฒ ูุชุตุงุนุฏ', responseWindow: 'ููุฑููุง ุฎูุงู ููุณ ุงูุณุงุนุฉ' },
    gaming: { riskLabel: 'ุงุณุชูุฒุงู ุณูููู ูุฅุฏูุงู ููุทู', responseWindow: '72 ุณุงุนุฉ' },
    inappropriate_content: { riskLabel: 'ุชุนุฑุถ ููุญุชูู ูุคุฐู ูุชุทุจูุน ุชุฏุฑูุฌู', responseWindow: '48 ุณุงุนุฉ' },
    cyber_crime: { riskLabel: 'ุงูุญุฑุงู ุชููู ุนุงูู ุงููุฎุงุทุฑ', responseWindow: 'ุฎูุงู 24 ุณุงุนุฉ' },
    crypto_scams: { riskLabel: 'ุฎุณุงุฑุฉ ูุงููุฉ ูุงุญุชูุงู ุงุณุชุซูุงุฑู', responseWindow: 'ุฎูุงู 24 ุณุงุนุฉ' },
    phishing_links: { riskLabel: 'ุณุฑูุฉ ุญุณุงุจุงุช ูุจูุงูุงุช ุงุนุชูุงุฏ', responseWindow: 'ููุฑููุง ุฎูุงู ููุณ ุงูุณุงุนุฉ' },
    self_harm: { riskLabel: 'ุฎุทุฑ ููุณู ูุฌุณุฏู ุญุฑุฌ', responseWindow: 'ููุฑููุง ูุน ุชุตุนูุฏ ูุฎุชุต' },
    sexual_exploitation: { riskLabel: 'ุงุณุชุบูุงู ุฌูุณู ูุถุบุท ุณุฑู', responseWindow: 'ููุฑููุง ุฎูุงู ููุณ ุงูุณุงุนุฉ' },
    account_theft_fraud: { riskLabel: 'ุงุณุชููุงุก ุนูู ุงูุญุณุงุจุงุช ูุงููููุฉ', responseWindow: 'ุฎูุงู 24 ุณุงุนุฉ' },
    gambling_betting: { riskLabel: 'ูุฒูู ูุงูู ูุงุนุชูุงุฏ ูุฎุงุทุฑุฉ', responseWindow: '48 ุณุงุนุฉ' },
    privacy_tracking: { riskLabel: 'ุงูุชูุงู ุฎุตูุตูุฉ ูุชุชุจูุน ูุคุฐู', responseWindow: 'ุฎูุงู 24 ุณุงุนุฉ' },
    harmful_challenges: { riskLabel: 'ุฅูุฐุงุก ุจุฏูู ุชุญุช ุถุบุท ุงูุชุฑูุฏ', responseWindow: 'ููุฑููุง ุฎูุงู ููุณ ุงูููู' },
  };

  const buildSectionDetail = (
    scenarioId: PsychScenarioId,
    section: Exclude<ScenarioSectionKey, 'interventionProgram' | 'dialogues'>,
    item: string,
    rank: number
  ) => {
    const hasScenarioContext = Object.prototype.hasOwnProperty.call(
      scenarioOperationalContext,
      scenarioId as string
    );
    const resolvedScenarioId = hasScenarioContext ? scenarioId : activeScenario.id;
    const context = scenarioOperationalContext[resolvedScenarioId] || {
      riskLabel: 'ูุฎุงุทุฑ ุฑูููุฉ ุนุงูุฉ',
      responseWindow: '48 ุณุงุนุฉ',
    };

    if (import.meta.env.DEV && !hasScenarioContext) {
      console.warn('[PsychologicalInsightView] Missing scenario context for buildSectionDetail:', {
        requestedScenarioId: scenarioId,
        resolvedScenarioId,
        section,
      });
    }

    const rankLabel =
      rank === 1 ? 'ุฃููููุฉ ูุตูู' : rank === 2 ? 'ุฃููููุฉ ุนุงููุฉ' : 'ุฃููููุฉ ูุชุงุจุนุฉ';

    if (section === 'symptoms') {
      return `${rankLabel}: ูุฐุง ุงูุนุฑุถ ูุฑุชุจุท ุจุฎุทุฑ "${context.riskLabel}". ุงูุฅุฌุฑุงุก ุงูุนููู: ุฑุงูุจ ุงูุชูุฑุงุฑ ูุงูุฒูู ูุงูุณูุงูุ ูุงุจุฏุฃ ุชุฏุฎููุง ุฃููููุง ุฎูุงู ${context.responseWindow}.`;
    }
    if (section === 'lurePatterns') {
      return `${rankLabel}: ูุฐุง ุงูููุท ููุณุชุฎุฏู ุนุงุฏุฉู ูุงุฎุชุจุงุฑ ูุงุจููุฉ ุงูุงุณุชุฌุงุจุฉ ุซู ุงูุชุตุนูุฏ. ุงูุฅุฌุฑุงุก ุงูุนููู: ุชุฏุฑูุจ ุงูุทูู ุนูู ุฅููุงู ุงูุชูุงุนู ููุฑูุง ูุน ุชูุซูู ุงูุฏููู ูุงูุฅุจูุงุบ ุฎูุงู ${context.responseWindow}.`;
    }
    if (section === 'prevention') {
      return `${rankLabel}: ุทุจูู ูุฐู ุงูููุงูุฉ ูุฅุนุฏุงุฏ ุฏุงุฆู ุซู ุฑุงุฌุน ุฃุซุฑูุง ุฃุณุจูุนููุง. ูุคุดุฑ ุงููุฌุงุญ: ุงูุฎูุงุถ ุชุนุฑุถ "${context.riskLabel}" ูุชุฑุงุฌุน ุงูุชูุจููุงุช ุงููุฑุชุจุทุฉ.`;
    }
    if (section === 'incidentPlan') {
      return `${rankLabel}: ูุฐู ุงูุฎุทูุฉ ุชุดุบูููุฉ ุถูู ุฎุทุฉ ุงูุงุณุชุฌุงุจุฉ. ูููุฐูุง ูุน ุฎุชู ุฒููู ูุชูุซูู ูุชูุฌุฉ ูุงุถุญ ูุถูุงู ูุงุจููุฉ ุงูุชุฏููู ูุงูุชุญุณูู ุงููุงุญู.`;
    }
    return `${rankLabel}: ุตูุงุบุฉ ุฅูุฐุงุฑ ุชุดุบููู ููุฐู ุงูุญุงูุฉ. ุงูุฃูุถู ุฑุจุท ุงูุฑุณุงูุฉ ุจุฅุฌุฑุงุก ุชูููุฐู ูุจุงุดุฑ ูุชูุงุณุจ ูุน "${context.riskLabel}".`;
  };

  const openScenarioSection = (scenarioId: PsychScenarioId, section: PreviewSectionKey) => {
    setActiveScenarioId(scenarioId);
    setExpandedScenarioId(scenarioId);
    const key = sectionStateKey(scenarioId, section);
    setExpandedSectionMap((prev) => ({ ...prev, [key]: true }));
    if (typeof window !== 'undefined') {
      const targetId = `scenario-${scenarioId}-${section}-details`;
      window.setTimeout(() => {
        const target = document.getElementById(targetId);
        if (!target) return;
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 120);
    }
  };

  const buildPreviewOperationalInsight = (
    section: PreviewSectionKey,
    item: string,
    rank: number
  ): PreviewOperationalInsight => {
    const isPrimary = rank === 1;
    const normalized = item.toLowerCase();

    if (section === 'symptoms') {
      if (normalized.includes('ุญุฐู') || normalized.includes('ุฅุฎูุงุก')) {
        return {
          badge: isPrimary ? 'ุฅุดุงุฑุฉ ุญุฑุฌุฉ ูุจูุฑุฉ' : 'ุฅุดุงุฑุฉ ุนุงููุฉ ุงูุดููุน',
          whyNow: 'ุงูุฅุฎูุงุก ุงููุชูุฑุฑ ูุนูู ุบุงูุจูุง ูุฌูุฏ ุถุบุท ูุดุท ูุฎุดู ุงูุทูู ูุดูู.',
          immediateAction: 'ุฅุฌุฑุงุก ููุฑู: ูุฑุงุฌุนุฉ ูุงุฏุฆุฉ ูุขุฎุฑ 24 ุณุงุนุฉ ูุน ุชูุนูู ุญูุธ ุงูุฃุฏูุฉ ูุจู ุงูุญุฐู.',
          toneClass: isPrimary ? 'bg-rose-100 text-rose-700 border-rose-200' : 'bg-amber-100 text-amber-700 border-amber-200',
        };
      }
      if (normalized.includes('ูุฒุงุฌ') || normalized.includes('ุชูุชุฑ')) {
        return {
          badge: isPrimary ? 'ุฃููููุฉ ุชุฏุฎู ุณูููู' : 'ุฅุดุงุฑุฉ ุนุงููุฉ ุงูุดููุน',
          whyNow: 'ุชุบูุฑ ุงููุฒุงุฌ ุจุนุฏ ุงูุงุณุชุฎุฏุงู ูุคุดุฑ ูุจูุฑ ุนูู ูุญุชูู ุถุงุบุท ุฃู ุนูุงูุฉ ูุคุฐูุฉ.',
          immediateAction: 'ุฅุฌุฑุงุก ููุฑู: ูุญุต ูุตูุฑ ุจุนุฏ ูู ุฌูุณุฉ ุงุณุชุฎุฏุงู ูุฑุจุท ุงููุชูุฌุฉ ุจุณุฌู ุงูุชูุจููุงุช.',
          toneClass: isPrimary ? 'bg-rose-100 text-rose-700 border-rose-200' : 'bg-amber-100 text-amber-700 border-amber-200',
        };
      }
      if (normalized.includes('ุงูุณุญุงุจ') || normalized.includes('ุงููุฏุฑุณุฉ')) {
        return {
          badge: isPrimary ? 'ุชุฃุซูุฑ ุงุฌุชูุงุนู ูุจุงุดุฑ' : 'ุฅุดุงุฑุฉ ุนุงููุฉ ุงูุดููุน',
          whyNow: 'ุงูุชูุงู ุงูุฃุซุฑ ูู ุงูุดุงุดุฉ ุฅูู ุงููุฏุฑุณุฉ/ุงูุนูุงูุงุช ูุนูู ุฃู ุงูุญุงูุฉ ุชุชุตุงุนุฏ.',
          immediateAction: 'ุฅุฌุฑุงุก ููุฑู: ุชุฏุฎู ุฃุณุฑู ุฎูุงู 72 ุณุงุนุฉ ูุน ูุชุงุจุนุฉ ูุฏุฑุณูุฉ ูุตูุฑุฉ.',
          toneClass: isPrimary ? 'bg-rose-100 text-rose-700 border-rose-200' : 'bg-amber-100 text-amber-700 border-amber-200',
        };
      }
      return {
        badge: isPrimary ? 'ูุคุดุฑ ุฎุทุฑ ูุฑุชูุน' : 'ูุคุดุฑ ูุชูุฑุฑ',
        whyNow: 'ูุฐุง ุงูุนุฑุถ ุบุงูุจูุง ูุธูุฑ ูุจู ุงูุชูุงูู ุงููุงูู ููุญุงูุฉ.',
        immediateAction: 'ุฅุฌุฑุงุก ููุฑู: ุชูุซูู ุงูุชูุฑุงุฑ ุซู ููุงูุดุชู ูุน ุงูุทูู ูู ุฌูุณุฉ ุฏุนู ูุฑูุฒุฉ.',
        toneClass: isPrimary ? 'bg-rose-100 text-rose-700 border-rose-200' : 'bg-amber-100 text-amber-700 border-amber-200',
      };
    }

    if (normalized.includes('ุชูุฏูุฏ') || normalized.includes('ุงุจุชุฒุงุฒ') || normalized.includes('ูุดุฑ')) {
      return {
        badge: isPrimary ? 'ุงุจุชุฒุงุฒ ูุญุชูู' : 'ููุท ุถุบุท ูุชูุฑุฑ',
        whyNow: 'ุงูุชูุฏูุฏ ุจุงููุดุฑ ุนุงุฏุฉู ูุณุจู ุทูุจุงุช ุชุตุนูุฏ ูุงููุฉ ุฃู ุณููููุฉ.',
        immediateAction: 'ุฅุฌุฑุงุก ููุฑู: ูุง ุชูุงูุถุ ุชูุซูู ููุฑูุ ุญุธุฑ ุงูุญุณุงุจุ ูุจุฏุก ุงูุฅุจูุงุบ.',
        toneClass: isPrimary ? 'bg-fuchsia-100 text-fuchsia-700 border-fuchsia-200' : 'bg-indigo-100 text-indigo-700 border-indigo-200',
      };
    }
    if (normalized.includes('ุญุณุงุจุงุช ููููุฉ') || normalized.includes('ุซูุฉ')) {
      return {
        badge: isPrimary ? 'ุงุณุชุฏุฑุงุฌ ูุจุงุดุฑ' : 'ุงุณุชุฏุฑุงุฌ ุดุงุฆุน',
        whyNow: 'ุจูุงุก ุงูุซูุฉ ุงููุฒููุฉ ูู ุฃุณุฑุน ูุฏุฎู ูุงุณุชุฎุฑุงุฌ ูุนูููุงุช ุญุณุงุณุฉ.',
        immediateAction: 'ุฅุฌุฑุงุก ููุฑู: ุชุทุจูู ูุงุนุฏุฉ ุนุฏู ูุดุงุฑูุฉ ุฃู ูุนูููุฉ ุดุฎุตูุฉ ูุน ุญุณุงุจ ุฌุฏูุฏ.',
        toneClass: isPrimary ? 'bg-fuchsia-100 text-fuchsia-700 border-fuchsia-200' : 'bg-indigo-100 text-indigo-700 border-indigo-200',
      };
    }
    if (normalized.includes('ูุฌููุนุงุช') || normalized.includes('ุฅูุตุงุก') || normalized.includes('ุฅูุงูุฉ')) {
      return {
        badge: isPrimary ? 'ุถุบุท ูุฌููุนุฉ ูุคุฐู' : 'ุงุณุชุฏุฑุงุฌ ุงุฌุชูุงุนู',
        whyNow: 'ุงูุถุบุท ุงูุฌูุงุนู ูุฑูุน ุณุฑุนุฉ ุงูุงุณุชุฌุงุจุฉ ุงูุงููุนุงููุฉ ููููู ุญูู ุงูุทูู ุงูุณููู.',
        immediateAction: 'ุฅุฌุฑุงุก ููุฑู: ุนุฒู ุงููุฌููุนุฉ ุซู ุชุฏุฑูุจ ุงูุทูู ุนูู ุนุจุงุฑุงุช ุฑูุถ ุฌุงูุฒุฉ.',
        toneClass: isPrimary ? 'bg-fuchsia-100 text-fuchsia-700 border-fuchsia-200' : 'bg-indigo-100 text-indigo-700 border-indigo-200',
      };
    }
    return {
      badge: isPrimary ? 'ุทุฑููุฉ ุงุณุชุฏุฑุงุฌ ูุนูุงูุฉ' : 'ุทุฑููุฉ ุงุณุชุฏุฑุงุฌ ุดุงุฆุนุฉ',
      whyNow: 'ูุฐู ุงูุทุฑููุฉ ุชูุณุชุฎุฏู ุนุงุฏุฉู ูุงุฎุชุจุงุฑ ูุงุจููุฉ ุงูุทูู ููุงุณุชุฌุงุจุฉ ุงูุณุฑูุนุฉ.',
      immediateAction: 'ุฅุฌุฑุงุก ููุฑู: ุฅููุงู ุงูุชูุงุนู + ุญูุธ ุงูุฏููู + ุฅุจูุงุบ ููู ุงูุฃูุฑ ููุฑูุง.',
      toneClass: isPrimary ? 'bg-fuchsia-100 text-fuchsia-700 border-fuchsia-200' : 'bg-indigo-100 text-indigo-700 border-indigo-200',
    };
  };

  const renderRadarAxisTick = (tickProps: any) => {
    const { x, y, cx, cy, payload } = tickProps;
    const dx = x - cx;
    const dy = y - cy;
    const length = Math.sqrt(dx * dx + dy * dy) || 1;

    // Keep Arabic labels away from polygon edges, especially left/right axes.
    const radialOffset = Math.abs(dx) > Math.abs(dy) ? 34 : dy > 0 ? 28 : 24;
    const tx = x + (dx / length) * radialOffset;
    const ty = y + (dy / length) * radialOffset + (dy > 0 ? 5 : -3);

    let textAnchor: 'middle' | 'start' | 'end' = 'middle';
    if (Math.abs(dx) > 8) {
      textAnchor = dx > 0 ? 'start' : 'end';
    }

    return (
      <text
        x={tx}
        y={ty}
        textAnchor={textAnchor}
        dominantBaseline="central"
        direction="rtl"
        unicodeBidi="plaintext"
        fill="#64748b"
        fontSize={14}
        fontWeight={800}
        fontFamily="Cairo"
      >
        {payload?.value}
      </text>
    );
  };

  return (
    <div className="max-w-6xl mx-auto space-y-10 pb-72 animate-in fade-in" dir="rtl">
      <div className="bg-slate-900 rounded-[4rem] p-12 text-white shadow-2xl border-b-8 border-indigo-600">
        <h2 className="text-5xl font-black tracking-tighter mb-2">Amanah Pulse Pro</h2>
        <p className="text-indigo-300 font-bold text-lg opacity-90">
          ุชุญููู ุงูุงุณุชูุฑุงุฑ ุงูุฑููู ูุงููุจุถ ุงูุนุงุทูู ูู {child.name}
        </p>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-10">
        <div
          ref={primaryCardRef}
          tabIndex={-1}
          className="bg-[#f4f6fa] rounded-[3.5rem] p-8 md:p-10 shadow-xl border border-[#e8ecf3] h-full flex flex-col items-center focus:outline-none focus-visible:ring-4 focus-visible:ring-indigo-200"
        >
          <div className="w-full flex justify-center mb-9">
            <div className="px-8 py-4 bg-[#eef1f6] rounded-full">
              <h3 className="text-[2rem] md:text-[2.2rem] leading-none font-black text-slate-800 text-center">
                ูุคุดุฑุงุช ุงูุชูุงุฒู ุงูููุณู
              </h3>
            </div>
          </div>
          <div ref={radarContainerRef} className="w-full h-[26rem] relative flex items-center justify-center min-w-0">
            {radarSize.width > 40 && radarSize.height > 40 ? (
              <RadarChart width={radarSize.width} height={radarSize.height} cx="50%" cy="50%" outerRadius="64%" data={radarData}>
                <PolarGrid stroke="#d3dae5" strokeWidth={1.5} />
                <PolarAngleAxis dataKey="subject" tick={renderRadarAxisTick} />
                <RadarComponent
                  name="Amanah Pulse"
                  dataKey="A"
                  stroke="#5f63df"
                  strokeWidth={6}
                  fill="#7b80e7"
                  fillOpacity={0.38}
                />
              </RadarChart>
            ) : (
              <div className="h-full w-full rounded-3xl bg-[#eef2f9]" />
            )}
          </div>
          <div className="w-full mt-3 pt-2">
            <div className="max-w-md mx-auto grid grid-cols-[1fr_auto_1fr] items-center gap-6 text-center">
              <div>
                <p className="text-6xl md:text-7xl leading-none font-black text-rose-500">{anxietyScore}</p>
                <p className="mt-2 text-xl md:text-2xl font-black text-slate-400">ุงูููู</p>
              </div>
              <div className="h-32 md:h-36 w-px bg-slate-300"></div>
              <div>
                <p className="text-6xl md:text-7xl leading-none font-black text-indigo-600">{stabilityScore}</p>
                <p className="mt-2 text-xl md:text-2xl font-black text-slate-400">ุงูุงุณุชูุฑุงุฑ</p>
              </div>
            </div>
          </div>
        </div>

        <div className="bg-indigo-50 rounded-[4rem] p-10 shadow-2xl border border-indigo-100 flex flex-col justify-between gap-6">
          <div className="space-y-4">
            <h3 className="text-2xl font-black text-slate-800">ุจุฑูุชูููู ุงูุฑุฏ ุงูููุชุฑุญ</h3>
            <div className="bg-white p-7 rounded-[2.5rem] border border-indigo-100 italic font-bold text-indigo-900 leading-relaxed">
              {profile.recommendation}
            </div>
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-white border border-indigo-100 rounded-2xl p-4 text-center">
                <p className="text-xs font-black text-slate-500 mb-1">ุฌุงูุฒูุฉ ุฅุฏุงุฑุฉ ุงูุญุงุฏุซ</p>
                <p className="text-3xl font-black text-indigo-700">{readinessScore}</p>
              </div>
              <div className="bg-white border border-indigo-100 rounded-2xl p-4 text-center">
                <p className="text-xs font-black text-slate-500 mb-1">ุงูุนุงุทูุฉ ุงูุบุงูุจุฉ</p>
                <p className="text-xl font-black text-slate-800">{profile.dominantEmotion}</p>
              </div>
            </div>
          </div>
          <button
            onClick={handleApplyEmergencyPlan}
            className="py-5 bg-slate-900 text-white rounded-[2rem] font-black text-lg shadow-2xl active:scale-95 transition-all"
          >
            ุชูุนูู ูุถุน ุงูุญูุงูุฉ ุงููุชูุงุฒู
          </button>
        </div>
      </div>

      <section className="bg-white rounded-[3rem] p-8 border border-slate-100 shadow-xl space-y-4">
        <div className="flex items-center justify-between flex-wrap gap-3">
          <h3 className="text-xl font-black text-slate-900">ูุชูุฌุฉ ุงูุชุญููู ุงูุชุดุฎูุตู ููุชูุจููุงุช</h3>
          {diagnosis ? (
            <span className="px-4 py-2 rounded-full bg-indigo-100 text-indigo-700 text-xs font-black">
              ุฏูุฉ ุงูุชุดุฎูุต: {diagnosis.confidence}%
            </span>
          ) : (
            <span className="px-4 py-2 rounded-full bg-slate-100 text-slate-600 text-xs font-black">
              ูุง ุชูุฌุฏ ุชูุจููุงุช ูุงููุฉ ููุชุญููู
            </span>
          )}
        </div>

        {diagnosis ? (
          <>
            <p className="text-xs font-bold text-slate-600">
              ุชู ุชุญููู {diagnosis.analyzedAlertCount} ุชูุจูู ุฎุงุต ุจุงูุทููุ ูุชู ุชุฑุฌูุญ ุณููุงุฑูู{' '}
              <span className="text-indigo-700 font-black">{activeScenario.title}</span> ุงุนุชูุงุฏูุง ุนูู ุงูุดุฏุฉ + ุงููุฆุฉ +
              ุงูุณูุงู ุงููุตู + ุญุฏุงุซุฉ ุงูุญุฏุซ.
            </p>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
              {diagnosis.reasons.map((reason, idx) => (
                <div key={idx} className="bg-slate-50 border border-slate-100 rounded-2xl p-4">
                  <p className="text-xs font-bold text-slate-700 leading-relaxed">{reason}</p>
                </div>
              ))}
            </div>
          </>
        ) : (
          <p className="text-xs font-bold text-slate-500">
            ุณูุชู ุชูุนูู ุงูุฑุจุท ุงูุชููุงุฆู ููุฑ ุชููุฑ ุชูุจููุงุช ูุฑุชุจุทุฉ ุจูุฐุง ุงูุทูู.
          </p>
        )}
      </section>

      <section className="bg-white rounded-[3rem] p-8 border border-slate-100 shadow-xl space-y-6">
        <h3 className="text-2xl font-black text-slate-900">ูุคุดุฑุงุช ุงูุฎุทุฑ ุงูุญุงููุฉ</h3>
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          {riskSignals.map((signal) => (
            <article key={signal.id} className="bg-slate-50 border border-slate-100 rounded-2xl p-5 space-y-3">
              <div className="flex items-center justify-between gap-2">
                <h4 className="font-black text-sm text-slate-900">{signal.title}</h4>
                <span
                  className={`px-3 py-1 rounded-full border text-[10px] font-black ${severityClassMap[signal.severity]}`}
                >
                  {severityTextMap[signal.severity]}
                </span>
              </div>
              <p className="text-xs font-bold text-slate-700 leading-relaxed">{signal.reason}</p>
              <p className="text-xs font-black text-indigo-700">ุฅุฌุฑุงุก ููุชุฑุญ: {signal.suggestedAction}</p>
            </article>
          ))}
        </div>

        <div className="bg-slate-50 border border-slate-100 rounded-[2rem] p-5">
          <p className="text-xs font-black text-slate-500 mb-3">ุงุชุฌุงู ุงููุจุถ ุฎูุงู ุงูุฃุณุจูุน</p>
          <div ref={trendContainerRef} className="w-full h-56 min-w-0">
            {trendSize.width > 40 && trendSize.height > 40 ? (
              <BarChart width={trendSize.width} height={trendSize.height} data={weeklyTrend} margin={{ top: 10, right: 10, left: 0, bottom: 0 }}>
                <CartesianGrid strokeDasharray="3 3" stroke="#e2e8f0" />
                <XAxis dataKey="label" tick={{ fill: '#64748b', fontSize: 11, fontWeight: 700 }} />
                <YAxis domain={[0, 100]} tick={{ fill: '#64748b', fontSize: 11, fontWeight: 700 }} />
                <Tooltip cursor={{ fill: '#eef2ff' }} />
                <Bar dataKey="value" fill="#6366f1" radius={[10, 10, 0, 0]} />
              </BarChart>
            ) : (
              <div className="h-full w-full rounded-2xl bg-slate-100" />
            )}
          </div>
        </div>
      </section>

      <section className="bg-gradient-to-br from-indigo-700 to-indigo-500 rounded-[3rem] p-8 text-white shadow-2xl border border-indigo-300/30 space-y-5">
        <div className="flex flex-wrap items-start justify-between gap-4">
          <div className="space-y-2 max-w-3xl">
            <h3 className="text-2xl md:text-3xl font-black tracking-tight">
              {lang === 'ar' ? 'ุฎุทุฉ ุงูุชูุงุฒู ุงูุฑููู' : 'Digital Balance Plan'}
            </h3>
            <p className="text-indigo-100 font-bold leading-relaxed">{digitalBalanceNarrative}</p>
          </div>
          <div className="flex flex-col gap-2 text-xs font-black">
            <span className="px-3 py-1 rounded-full bg-white/15 border border-white/20">
              {lang === 'ar' ? 'ุงูุณููุงุฑูู' : 'Scenario'}: {activeScenario.title}
            </span>
            {activeScenario.id === 'threat_exposure' && (
              <span className="px-3 py-1 rounded-full bg-rose-500/25 border border-rose-200/50">
                {lang === 'ar' ? 'ุงููุณุงุฑ' : 'Track'}:{' '}
                {lang === 'ar' ? activeThreatTrack.badgeLabelAr : activeThreatTrack.badgeLabelEn}
              </span>
            )}
            {activeScenario.id === 'inappropriate_content' && (
              <span className="px-3 py-1 rounded-full bg-amber-400/25 border border-amber-100/50">
                {lang === 'ar' ? 'ุงููุณุงุฑ' : 'Track'}:{' '}
                {lang === 'ar' ? activeContentTrack.badgeLabelAr : activeContentTrack.badgeLabelEn}
              </span>
            )}
            {activeScenario.id === 'cyber_crime' && cyberRiskStage && (
              <span className="px-3 py-1 rounded-full bg-cyan-400/25 border border-cyan-100/50">
                {lang === 'ar' ? 'ุงููุฑุญูุฉ' : 'Stage'}:{' '}
                {lang === 'ar' ? cyberRiskStage.badgeAr : cyberRiskStage.badgeEn}
              </span>
            )}
            <span className="px-3 py-1 rounded-full bg-white/15 border border-white/20">
              {lang === 'ar' ? 'ุงูููุตุฉ' : 'Platform'}: {highRiskApp?.appName || dominantPlatform}
            </span>
            <span className="px-3 py-1 rounded-full bg-white/15 border border-white/20">
              {lang === 'ar' ? 'ุงูุญุฏุฉ' : 'Severity'}: {dominantSeverity}
            </span>
          </div>
        </div>

        <div className="flex flex-wrap gap-2">
          {blockedDomains.map((domain) => (
            <span key={domain} className="px-3 py-1 rounded-lg text-xs font-black bg-white/15 border border-white/20">
              {domain}
            </span>
          ))}
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
          <label className="text-xs font-black text-indigo-100 flex flex-col gap-2">
            {lang === 'ar' ? 'ูุตุฏุฑ ุงูุตูุฑุฉ' : 'Video Source'}
            <select
              value={planVideoSource}
              onChange={(event) => setPlanVideoSource(event.target.value as PlanVideoSource)}
              className="bg-white/15 border border-white/30 rounded-xl px-3 py-2 text-white font-black outline-none"
            >
              <option className="text-slate-900" value="camera_front">
                {lang === 'ar' ? 'ุงููุงููุฑุง ุงูุฃูุงููุฉ' : 'Front Camera'}
              </option>
              <option className="text-slate-900" value="camera_back">
                {lang === 'ar' ? 'ุงููุงููุฑุง ุงูุฎูููุฉ' : 'Back Camera'}
              </option>
              <option className="text-slate-900" value="screen">
                {lang === 'ar' ? 'ุงูุดุงุดุฉ' : 'Screen'}
              </option>
            </select>
          </label>
          <label className="text-xs font-black text-indigo-100 flex flex-col gap-2">
            {lang === 'ar' ? 'ูุตุฏุฑ ุงูุตูุช' : 'Audio Source'}
            <select
              value={planAudioSource}
              onChange={(event) => setPlanAudioSource(event.target.value as PlanAudioSource)}
              className="bg-white/15 border border-white/30 rounded-xl px-3 py-2 text-white font-black outline-none"
            >
              <option className="text-slate-900" value="mic">
                {lang === 'ar' ? 'ุงููููุฑูููู' : 'Microphone'}
              </option>
              <option className="text-slate-900" value="system">
                {lang === 'ar' ? 'ุตูุช ุงููุธุงู' : 'System Audio'}
              </option>
            </select>
          </label>
        </div>

        <label className="text-xs font-black text-indigo-100 flex flex-col gap-2">
          {lang === 'ar' ? 'ุฑุณุงูุฉ ุดุงุดุฉ ุงูุญุฌุจ ุงูููุงุฆู' : 'Blackout Screen Message'}
          <input
            value={blackoutMessage}
            onChange={(event) => setBlackoutMessage(event.target.value)}
            className="bg-white/15 border border-white/30 rounded-xl px-3 py-2 text-white font-bold outline-none placeholder:text-indigo-200/70"
            placeholder={
              lang === 'ar'
                ? 'ูุซุงู: ุชู ููู ุงูุฌูุงุฒ ูุฏูุงุนู ุงูุฃูุงู. ูุฑุฌู ุงูุชูุงุตู ูุน ุงููุงูุฏูู.'
                : 'Example: Device locked for safety. Please contact a parent.'
            }
          />
        </label>

        <div className="flex flex-wrap gap-3">
          <button
            onClick={handleApplyEmergencyPlan}
            className="px-5 py-3 rounded-xl bg-white text-indigo-700 font-black text-sm shadow active:scale-95"
          >
            {lang === 'ar' ? 'ุฅูุดุงุก ูุถุน ุฐูู ููุชุฑุญ' : 'Create Suggested Smart Mode'}
          </button>
          <button
            onClick={runAutoExecutionPlan}
            disabled={isAutoRunning}
            className="px-5 py-3 rounded-xl bg-slate-900 text-white font-black text-sm shadow disabled:opacity-50 active:scale-95"
          >
            {isAutoRunning
              ? lang === 'ar'
                ? 'ุฌุงุฑู ุงูุชูููุฐ...'
                : 'Running...'
              : lang === 'ar'
                ? 'ุชูููุฐ ุงูุฎุทุฉ ุชููุงุฆูุงู'
                : 'Execute Plan Automatically'}
          </button>
          <button
            onClick={runPlanAndCreateMode}
            disabled={isAutoRunning}
            className="px-5 py-3 rounded-xl bg-emerald-500 text-white font-black text-sm shadow disabled:opacity-50 active:scale-95"
          >
            {isAutoRunning
              ? lang === 'ar'
                ? 'ุฌุงุฑู ุงูุชูููุฐ...'
                : 'Running...'
              : lang === 'ar'
                ? 'ุชูููุฐ + ุญูุธ + ุชุทุจูู'
                : 'Execute + Save as Mode'}
          </button>
        </div>
      </section>

      <section className="bg-white rounded-[3rem] p-8 border border-slate-100 shadow-xl space-y-5">
        <div>
          <h3 className="text-xl font-black text-slate-900">
            {lang === 'ar' ? 'ุฎุทูุงุช ุงูุชูููุฐ ุงูุชููุงุฆู' : 'Auto Execution Steps'}
          </h3>
          <p className="text-xs font-bold text-slate-500 mt-1">
            {lang === 'ar'
              ? 'ูุชู ุชุดุบูู ุงูุฃูุงูุฑ ุงููุฎุชุงุฑุฉ ูุจุงุดุฑุฉ ุนูู ุฌูุงุฒ ุงูุทูู ุจูุงุกู ุนูู ูุณุชูู ุงูุฎุทุฑ ุงูุญุงูู.'
              : 'Selected commands run directly on the child device based on the current risk severity.'}
          </p>
          {allLocksDisabled && (
            <p className="mt-2 text-[11px] font-black text-rose-700 bg-rose-50 border border-rose-200 rounded-lg px-3 py-2">
              {lang === 'ar'
                ? 'ุชุนุทูู ุฌููุน ุงูุฃููุงู ููุนูุ ููู ูุชู ุฅุฑุณุงู ุฃู ุฃูุงูุฑ ููู ุฃู ุดุงุดุฉ ุญุฌุจ.'
                : 'All lock actions are disabled, and no lock/blackout commands will be sent.'}
            </p>
          )}
          {!allLocksDisabled && !autoLockInAutomationEnabled && (
            <p className="mt-2 text-[11px] font-black text-amber-700 bg-amber-50 border border-amber-200 rounded-lg px-3 py-2">
              {lang === 'ar'
                ? 'ุงูููู ุงูุชููุงุฆู ูุนุทู ูู ุงูุฅุนุฏุงุฏุงุชุ ูุณูุชู ุชูููุฐ ุจุงูู ุงูุฅุฌุฑุงุกุงุช ููุท.'
                : 'Automatic lock is disabled from settings, and only non-lock actions will run.'}
            </p>
          )}
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-2 gap-3">
          {autoExecutionSteps.map((step) => {
            const checked = !!autoSelection[step.id];
            const status = autoStatus[step.id] || 'idle';
            return (
              <article key={step.id} className="rounded-2xl border border-slate-100 bg-slate-50 p-4 space-y-3">
                <div className="flex items-center justify-between gap-2">
                  <div className="space-y-1">
                    <h4 className="font-black text-sm text-slate-900">{step.title}</h4>
                    <p className="text-xs font-bold text-slate-600 leading-relaxed">{step.description}</p>
                  </div>
                  <button
                    onClick={() => toggleAutoStep(step.id)}
                    disabled={isAutoRunning}
                    className={`w-12 h-7 rounded-full p-1 transition-all disabled:opacity-50 ${checked ? 'bg-indigo-600' : 'bg-slate-300'}`}
                  >
                    <span
                      className={`block w-5 h-5 rounded-full bg-white shadow transition-transform ${
                        checked ? '-translate-x-5' : 'translate-x-0'
                      }`}
                    />
                  </button>
                </div>

                <div className="flex flex-wrap items-center justify-between gap-2">
                  <span className="px-3 py-1 rounded-lg text-[10px] font-black bg-slate-200 text-slate-700">
                    {lang === 'ar' ? 'ุงูุญุฏ ุงูุฃุฏูู' : 'Min'}: {step.minSeverity}
                  </span>
                  <span className={`px-3 py-1 rounded-lg text-[10px] font-black border ${stepStateClass(status)}`}>
                    {stepStateLabel(status)}
                  </span>
                </div>
              </article>
            );
          })}
        </div>

        {autoRunSummary && (
          <div className="rounded-2xl border border-indigo-100 bg-indigo-50 text-indigo-700 px-4 py-3 text-xs font-black">
            {autoRunSummary}
          </div>
        )}

        <div className="rounded-2xl border border-slate-100 bg-slate-50 p-4 space-y-3">
          <div className="flex flex-wrap items-center justify-between gap-2">
            <h4 className="text-sm font-black text-slate-900">
              {lang === 'ar' ? 'ุงูุณุฌู ุงูุฒููู ููุชูููุฐ' : 'Execution Timeline'}
            </h4>
            <div className="flex items-center gap-2">
              <span className="text-[10px] font-black text-slate-500">
                {lang === 'ar'
                  ? `${filteredExecutionTimeline.length} / ${executionTimeline.length} ุฃุญุฏุงุซ`
                  : `${filteredExecutionTimeline.length} / ${executionTimeline.length} events`}
              </span>
              <button
                onClick={saveExecutionTimelineToVault}
                disabled={
                  executionTimeline.length === 0 ||
                  isSavingExecutionEvidence ||
                  !onSaveExecutionEvidence
                }
                className="px-3 py-1 rounded-lg bg-emerald-600 text-white text-[10px] font-black disabled:opacity-40"
              >
                {isSavingExecutionEvidence
                  ? lang === 'ar'
                    ? 'ุฌุงุฑู ุงูุญูุธ...'
                    : 'Saving...'
                  : lang === 'ar'
                    ? 'ุญูุธ ุจุงูุฎุฒูุฉ'
                    : 'Save to Vault'}
              </button>
              <button
                onClick={exportExecutionTimeline}
                disabled={filteredExecutionTimeline.length === 0}
                className="px-3 py-1 rounded-lg bg-indigo-600 text-white text-[10px] font-black disabled:opacity-40"
              >
                {lang === 'ar' ? 'ุชุตุฏูุฑ JSON' : 'Export JSON'}
              </button>
            </div>
          </div>

          <div className="flex flex-wrap gap-2">
            {(['all', 'done', 'error', 'skipped', 'info'] as const).map((statusKey) => {
              const isActive = timelineFilter === statusKey;
              const label =
                statusKey === 'all'
                  ? lang === 'ar'
                    ? 'ุงููู'
                    : 'All'
                  : timelineStatusLabel(statusKey);
              return (
                <button
                  key={statusKey}
                  onClick={() => setTimelineFilter(statusKey)}
                  className={`px-3 py-1 rounded-lg text-[10px] font-black border ${
                    isActive
                      ? 'bg-slate-900 text-white border-slate-900'
                      : 'bg-white text-slate-600 border-slate-200'
                  }`}
                >
                  {label}
                </button>
              );
            })}
          </div>

          {filteredExecutionTimeline.length > 0 ? (
            <div className="space-y-2 max-h-56 overflow-y-auto custom-scrollbar pr-1">
              {filteredExecutionTimeline.map((entry) => (
                <article
                  key={entry.id}
                  className="bg-white border border-slate-100 rounded-xl px-3 py-2 flex items-start justify-between gap-3"
                >
                  <div className="space-y-1">
                    <p className="text-xs font-black text-slate-900">{entry.title}</p>
                    <p className="text-xs font-bold text-slate-600">{entry.detail}</p>
                  </div>
                  <div className="flex flex-col items-end gap-1 shrink-0">
                    <span className={`px-2 py-0.5 rounded-md border text-[10px] font-black ${timelineBadgeClass(entry.status)}`}>
                      {timelineStatusLabel(entry.status)}
                    </span>
                    <span className="text-[10px] font-bold text-slate-400">
                      {entry.at.toLocaleTimeString(lang === 'ar' ? 'ar-EG' : 'en-US', {
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                      })}
                    </span>
                  </div>
                </article>
              ))}
            </div>
          ) : (
            <p className="text-xs font-bold text-slate-500">
              {lang === 'ar'
                ? executionTimeline.length > 0
                  ? 'ูุง ุชูุฌุฏ ุฃุญุฏุงุซ ุถูู ุงูููุชุฑ ุงูุญุงูู.'
                  : 'ุงุจุฏุฃ ุงูุชูููุฐ ูุนุฑุถ ุณุฌู ุงูุฎุทูุงุช ุชููุงุฆููุง.'
                : executionTimeline.length > 0
                  ? 'No events for the selected filter.'
                  : 'Run the plan to populate execution timeline.'}
            </p>
          )}
        </div>
      </section>

      <section className="space-y-5">
        <div>
          <h3 className="text-3xl font-black text-slate-900 tracking-tighter mb-2">ูุฑูุฒ ุงููุจุถ ุงูููุณู</h3>
          <p className="text-slate-500 font-bold">ุจุทุงูุงุช ูุฏูุฌุฉ ูุงุจูุฉ ููุชูุฏุฏ: ููุฎุต ุณุฑูุน ุซู ุนุฑุถ ุงูุชูุงุตูู ุฏุงุฎู ููุณ ุงูุจุทุงูุฉ.</p>
        </div>

        <div className="space-y-5 pt-1">
          {guidanceScenarios.map((scenario) => {
            const isExpanded = expandedScenarioId === scenario.id;
            const isActiveScenario = activeScenarioId === scenario.id;
            const glass = scenarioGlassStyles[scenario.id];
            const incidentSteps =
              scenario.id === 'threat_exposure'
                ? isActiveScenario
                  ? resolvedIncidentPlan
                  : scenario.incidentPlan
                : scenario.id === 'inappropriate_content'
                  ? isActiveScenario
                    ? resolvedIncidentPlan
                    : scenario.incidentPlan
                  : scenario.incidentPlan;
            const alertTemplates =
              scenario.id === 'threat_exposure'
                ? isActiveScenario
                  ? resolvedAlertTemplates
                  : scenario.alertTemplates
                : scenario.id === 'inappropriate_content'
                  ? isActiveScenario
                    ? resolvedAlertTemplates
                    : scenario.alertTemplates
                  : scenario.alertTemplates;
            const canExpandSymptoms = scenario.symptoms.length > previewCount;
            const canExpandLurePatterns = scenario.lurePatterns.length > previewCount;

            return (
              <article
                key={scenario.id}
                className={`relative w-full overflow-hidden rounded-[3rem] border border-slate-100 bg-white/55 backdrop-blur-xl shadow-xl shadow-slate-900/10 transition-all duration-300 ${
                  isExpanded ? 'ring-2 ring-white/70' : ''
                }`}
              >
                <div className={`pointer-events-none absolute inset-0 bg-gradient-to-br ${glass.tint}`} />
                <div className="relative p-5 space-y-4">
                  <header className="flex items-start justify-between gap-3">
                    <button
                      type="button"
                      onClick={() => {
                        setActiveScenarioId(scenario.id);
                        setExpandedScenarioId((prev) => (prev === scenario.id ? null : scenario.id));
                      }}
                      className="flex items-center gap-3 text-right"
                    >
                      <div className="h-12 w-12 rounded-2xl bg-white/85 shadow-[0_2px_8px_rgba(15,23,42,0.08)] flex items-center justify-center text-2xl">
                        {scenario.icon}
                      </div>
                      <div>
                        <h4 className="text-base md:text-lg font-black text-slate-900">{scenario.title}</h4>
                        <p className="text-sm font-black text-slate-600">
                          ูุณุชูู ุงูุฎุทุฑ: {severityTextMap[scenario.severity]}
                        </p>
                      </div>
                    </button>

                    <button
                      type="button"
                      onClick={() => {
                        setActiveScenarioId(scenario.id);
                        setExpandedScenarioId((prev) => (prev === scenario.id ? null : scenario.id));
                      }}
                      className={`shrink-0 px-3 py-2 rounded-xl text-sm font-black text-white bg-gradient-to-r ${glass.button} shadow-lg`}
                    >
                      {isExpanded ? 'ุฅุฎูุงุก ุงูุชูุงุตูู' : 'ุงุนุฑุถ ุงููุฒูุฏ'}
                    </button>
                  </header>

                  {!isExpanded && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div className="rounded-2xl bg-slate-50/85 border border-slate-100 p-3 space-y-2 shadow-sm">
                        <div className="flex items-center justify-between gap-2">
                          <p className="text-sm font-black text-slate-500">ุงูุฃุนุฑุงุถ (ุฃุนูู ุฅุดุงุฑุชูู)</p>
                          <button
                            type="button"
                            onClick={() => openScenarioSection(scenario.id, 'symptoms')}
                            className="px-2.5 py-1 rounded-lg bg-slate-900 text-white text-[10px] font-black"
                          >
                            {canExpandSymptoms ? 'ุชูุงุตูู ููุณุนุฉ' : 'ูุชุญ ุงููุณู ุงูุชูุตููู'}
                          </button>
                        </div>
                        <div className="space-y-2">
                          {scenario.symptoms.slice(0, 2).map((item, idx) => {
                            const preview = buildPreviewOperationalInsight('symptoms', item, idx + 1);
                            return (
                              <article key={`${item}-${idx}`} className="rounded-2xl border border-slate-100 bg-white/95 p-3 space-y-1.5 shadow-sm">
                                <div className="flex items-center justify-between gap-2">
                                  <span className={`px-2 py-0.5 rounded-md border text-[10px] font-black ${preview.toneClass}`}>
                                    {preview.badge}
                                  </span>
                                  <span className="text-[10px] font-black text-slate-500">#{idx + 1}</span>
                                </div>
                                <p className="text-sm font-black text-slate-800 leading-relaxed">{item}</p>
                                <p className="text-sm font-bold text-slate-600">ููุงุฐุง ุงูุขู: {preview.whyNow}</p>
                                <p className="text-sm font-bold text-slate-700">{preview.immediateAction}</p>
                              </article>
                            );
                          })}
                        </div>
                      </div>
                      <div className="rounded-2xl bg-slate-50/85 border border-slate-100 p-3 space-y-2 shadow-sm">
                        <div className="flex items-center justify-between gap-2">
                          <p className="text-sm font-black text-slate-500">ุทุฑู ุงูุงุณุชุฏุฑุงุฌ (ุฃุนูู ููุทูู)</p>
                          <button
                            type="button"
                            onClick={() => openScenarioSection(scenario.id, 'lurePatterns')}
                            className="px-2.5 py-1 rounded-lg bg-slate-900 text-white text-[10px] font-black"
                          >
                            {canExpandLurePatterns ? 'ุชูุงุตูู ููุณุนุฉ' : 'ูุชุญ ุงููุณู ุงูุชูุตููู'}
                          </button>
                        </div>
                        <div className="space-y-2">
                          {scenario.lurePatterns.slice(0, 2).map((item, idx) => {
                            const preview = buildPreviewOperationalInsight('lurePatterns', item, idx + 1);
                            return (
                              <article key={`${item}-${idx}`} className="rounded-2xl border border-slate-100 bg-white/95 p-3 space-y-1.5 shadow-sm">
                                <div className="flex items-center justify-between gap-2">
                                  <span className={`px-2 py-0.5 rounded-md border text-[10px] font-black ${preview.toneClass}`}>
                                    {preview.badge}
                                  </span>
                                  <span className="text-[10px] font-black text-slate-500">#{idx + 1}</span>
                                </div>
                                <p className="text-sm font-black text-slate-800 leading-relaxed">{item}</p>
                                <p className="text-sm font-bold text-slate-600">ููุงุฐุง ุงูุขู: {preview.whyNow}</p>
                                <p className="text-sm font-bold text-slate-700">{preview.immediateAction}</p>
                              </article>
                            );
                          })}
                        </div>
                      </div>
                    </div>
                  )}

                  {isExpanded && (
                    <div className="space-y-4 pt-3">
                      {scenario.id === 'threat_exposure' && isActiveScenario && (
                        <div className="rounded-xl bg-rose-50/80 border border-rose-200 px-3 py-2 text-sm font-black text-rose-700">
                          ุงููุณุงุฑ ุงููุดุท: {lang === 'ar' ? activeThreatTrack.badgeLabelAr : activeThreatTrack.badgeLabelEn}
                        </div>
                      )}
                      {scenario.id === 'inappropriate_content' && isActiveScenario && (
                        <div className="rounded-xl bg-amber-50/80 border border-amber-200 px-3 py-2 text-sm font-black text-amber-700">
                          ุงููุณุงุฑ ุงููุดุท: {lang === 'ar' ? activeContentTrack.badgeLabelAr : activeContentTrack.badgeLabelEn}
                        </div>
                      )}
                      {scenario.id === 'cyber_crime' && isActiveScenario && cyberRiskStage && (
                        <div className="rounded-xl bg-cyan-50/80 border border-cyan-200 px-3 py-2 text-sm font-black text-cyan-700">
                          ุงููุฑุญูุฉ ุงููุดุทุฉ: {lang === 'ar' ? cyberRiskStage.badgeAr : cyberRiskStage.badgeEn}
                        </div>
                      )}

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div
                          id={`scenario-${scenario.id}-symptoms-details`}
                          className="rounded-2xl bg-slate-50/85 border border-slate-100 p-4 space-y-2 shadow-sm"
                        >
                          <div className="flex items-center justify-between gap-2">
                            <p className="text-sm font-black text-slate-500">ุงูุฃุนุฑุงุถ ุงูุชูุตูููุฉ</p>
                            <button
                              type="button"
                              onClick={() => toggleSectionExpansion(scenario.id, 'symptoms')}
                              disabled={!canExpandSymptoms}
                              className={`px-2.5 py-1 rounded-lg text-[10px] font-black ${
                                canExpandSymptoms ? 'bg-slate-900 text-white' : 'bg-slate-200 text-slate-500 cursor-not-allowed'
                              }`}
                            >
                              {canExpandSymptoms
                                ? isSectionExpanded(scenario.id, 'symptoms')
                                  ? 'ุนุฑุถ ุฃูู'
                                  : 'ุชูุงุตูู ููุณุนุฉ'
                                : 'ูู ุงูุนูุงุตุฑ ุธุงูุฑุฉ'}
                            </button>
                          </div>
                          <div className="space-y-2">
                            {(isSectionExpanded(scenario.id, 'symptoms')
                              ? scenario.symptoms
                              : scenario.symptoms.slice(0, previewCount)
                            ).map((item, idx) => (
                              <article key={`${item}-${idx}`} className="rounded-2xl bg-white/95 border border-slate-100 p-3 space-y-1 shadow-sm">
                                <p className="text-sm font-black text-slate-800">{idx + 1}. {item}</p>
                                <p className="text-sm font-bold text-slate-600">
                                  {buildSectionDetail(scenario.id, 'symptoms', item, idx + 1)}
                                </p>
                              </article>
                            ))}
                          </div>
                        </div>

                        <div
                          id={`scenario-${scenario.id}-lurePatterns-details`}
                          className="rounded-2xl bg-slate-50/85 border border-slate-100 p-4 space-y-2 shadow-sm"
                        >
                          <div className="flex items-center justify-between gap-2">
                            <p className="text-sm font-black text-slate-500">ุทุฑู ุงูุงุณุชุฏุฑุงุฌ ุงูุชูุตูููุฉ</p>
                            <button
                              type="button"
                              onClick={() => toggleSectionExpansion(scenario.id, 'lurePatterns')}
                              disabled={!canExpandLurePatterns}
                              className={`px-2.5 py-1 rounded-lg text-[10px] font-black ${
                                canExpandLurePatterns ? 'bg-slate-900 text-white' : 'bg-slate-200 text-slate-500 cursor-not-allowed'
                              }`}
                            >
                              {canExpandLurePatterns
                                ? isSectionExpanded(scenario.id, 'lurePatterns')
                                  ? 'ุนุฑุถ ุฃูู'
                                  : 'ุชูุงุตูู ููุณุนุฉ'
                                : 'ูู ุงูุนูุงุตุฑ ุธุงูุฑุฉ'}
                            </button>
                          </div>
                          <div className="space-y-2">
                            {(isSectionExpanded(scenario.id, 'lurePatterns')
                              ? scenario.lurePatterns
                              : scenario.lurePatterns.slice(0, previewCount)
                            ).map((item, idx) => (
                              <article key={`${item}-${idx}`} className="rounded-2xl bg-white/95 border border-slate-100 p-3 space-y-1 shadow-sm">
                                <p className="text-sm font-black text-slate-800">{idx + 1}. {item}</p>
                                <p className="text-sm font-bold text-slate-600">
                                  {buildSectionDetail(scenario.id, 'lurePatterns', item, idx + 1)}
                                </p>
                              </article>
                            ))}
                          </div>
                        </div>
                      </div>

                      <div className="rounded-2xl bg-slate-50/85 border border-slate-100 p-4 space-y-2 shadow-sm">
                        <div className="flex items-center justify-between gap-2">
                          <p className="text-sm font-black text-slate-500">ุฅุฌุฑุงุกุงุช ุงูููุงูุฉ (ููุณุนุฉ)</p>
                          <button
                            type="button"
                            onClick={() => toggleSectionExpansion(scenario.id, 'prevention')}
                            className="px-2.5 py-1 rounded-lg bg-slate-900 text-white text-[10px] font-black"
                          >
                            {isSectionExpanded(scenario.id, 'prevention') ? 'ุนุฑุถ ุฃูู' : 'ุชูุงุตูู ููุณุนุฉ'}
                          </button>
                        </div>
                        <div className="space-y-2">
                          {(isSectionExpanded(scenario.id, 'prevention')
                            ? scenario.prevention
                            : scenario.prevention.slice(0, previewCount)
                          ).map((item, idx) => (
                            <article key={`${item}-${idx}`} className="rounded-2xl bg-white/95 border border-slate-100 p-3 space-y-1 shadow-sm">
                              <p className="text-sm font-black text-slate-800">{idx + 1}. {item}</p>
                              <p className="text-sm font-bold text-slate-600">
                                {buildSectionDetail(scenario.id, 'prevention', item, idx + 1)}
                              </p>
                            </article>
                          ))}
                        </div>
                      </div>

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div className="rounded-2xl bg-slate-50/85 border border-slate-100 p-4 space-y-2 shadow-sm">
                          <div className="flex items-center justify-between gap-2">
                            <p className="text-sm font-black text-slate-500">ุฎุทุฉ 10 ุฏูุงุฆู (ุชูุตูู)</p>
                            <button
                              type="button"
                              onClick={() => toggleSectionExpansion(scenario.id, 'incidentPlan')}
                              className="px-2.5 py-1 rounded-lg bg-slate-900 text-white text-[10px] font-black"
                            >
                              {isSectionExpanded(scenario.id, 'incidentPlan') ? 'ุนุฑุถ ุฃูู' : 'ุชูุงุตูู ููุณุนุฉ'}
                            </button>
                          </div>
                          <div className="space-y-2">
                            {(isSectionExpanded(scenario.id, 'incidentPlan')
                              ? incidentSteps
                              : incidentSteps.slice(0, previewCount)
                            ).map((step, idx) => (
                              <article key={`${step}-${idx}`} className="rounded-2xl bg-white/95 border border-slate-100 p-3 space-y-1 shadow-sm">
                                <p className="text-sm font-black text-slate-800">{idx + 1}. {step}</p>
                                <p className="text-sm font-bold text-slate-600">
                                  {buildSectionDetail(scenario.id, 'incidentPlan', step, idx + 1)}
                                </p>
                              </article>
                            ))}
                          </div>
                        </div>

                        <div className="rounded-2xl bg-slate-50/85 border border-slate-100 p-4 space-y-2 shadow-sm">
                          <div className="flex items-center justify-between gap-2">
                            <p className="text-sm font-black text-slate-500">ุฑุณุงุฆู ุงูุชูุจูู (ุชูุตูู)</p>
                            <button
                              type="button"
                              onClick={() => toggleSectionExpansion(scenario.id, 'alertTemplates')}
                              className="px-2.5 py-1 rounded-lg bg-slate-900 text-white text-[10px] font-black"
                            >
                              {isSectionExpanded(scenario.id, 'alertTemplates') ? 'ุนุฑุถ ุฃูู' : 'ุชูุงุตูู ููุณุนุฉ'}
                            </button>
                          </div>
                          <div className="space-y-2">
                            {(isSectionExpanded(scenario.id, 'alertTemplates')
                              ? alertTemplates
                              : alertTemplates.slice(0, previewCount)
                            ).map((template, idx) => (
                              <article key={`${template}-${idx}`} className="rounded-2xl bg-white/95 border border-slate-100 p-3 space-y-1 shadow-sm">
                                <p className="text-sm font-black text-slate-800">{idx + 1}. {template}</p>
                                <p className="text-sm font-bold text-slate-600">
                                  {buildSectionDetail(scenario.id, 'alertTemplates', template, idx + 1)}
                                </p>
                              </article>
                            ))}
                          </div>
                        </div>
                      </div>

                      <div className="rounded-2xl bg-slate-50/85 border border-slate-100 p-4 space-y-2 shadow-sm">
                        <div className="flex items-center justify-between gap-2">
                          <p className="text-sm font-black text-slate-500">ุจุฑูุงูุฌ ุงูุชุฏุฎู ุงูุนูุงุฌู (ููุณุน)</p>
                          <button
                            type="button"
                            onClick={() => toggleSectionExpansion(scenario.id, 'interventionProgram')}
                            className="px-2.5 py-1 rounded-lg bg-slate-900 text-white text-[10px] font-black"
                          >
                            {isSectionExpanded(scenario.id, 'interventionProgram') ? 'ุนุฑุถ ุฃูู' : 'ุชูุงุตูู ููุณุนุฉ'}
                          </button>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-2">
                          {(isSectionExpanded(scenario.id, 'interventionProgram')
                            ? scenario.interventionProgram
                            : scenario.interventionProgram.slice(0, previewCount)
                          ).map((step, idx) => (
                            <article key={`${step.week}-${idx}`} className="rounded-2xl bg-white/95 border border-slate-100 p-3 space-y-1 shadow-sm">
                              <p className="text-[10px] font-black text-indigo-600">{step.week}</p>
                              <p className="text-sm font-black text-slate-800">{step.goal}</p>
                              <p className="text-sm font-bold text-slate-600">{step.action}</p>
                              <p className="text-sm font-bold text-slate-500">
                                ุดุฑุญ ุชูููุฐู: ุงุจุฏุฃ ุจูุฏู "{step.goal}" ุนุจุฑ ุฅุฌุฑุงุก "{step.action}" ูุน ูุฑุงุฌุนุฉ ุฃุซุฑู ุฎูุงู 7 ุฃูุงู.
                              </p>
                            </article>
                          ))}
                        </div>
                      </div>

                      <div className="rounded-2xl bg-slate-50/85 border border-slate-100 p-4 space-y-2 shadow-sm">
                        <div className="flex items-center justify-between gap-2">
                          <p className="text-sm font-black text-slate-500">ุงูุญูุงุฑุงุช ุงูุชุฑุจููุฉ (ููุณุนุฉ)</p>
                          <button
                            type="button"
                            onClick={() => toggleSectionExpansion(scenario.id, 'dialogues')}
                            className="px-2.5 py-1 rounded-lg bg-slate-900 text-white text-[10px] font-black"
                          >
                            {isSectionExpanded(scenario.id, 'dialogues') ? 'ุนุฑุถ ุฃูู' : 'ุชูุงุตูู ููุณุนุฉ'}
                          </button>
                        </div>
                        <div className="space-y-2">
                          {(isSectionExpanded(scenario.id, 'dialogues')
                            ? scenario.dialogues
                            : scenario.dialogues.slice(0, previewCount)
                          ).map((dialogue, idx) => (
                            <article key={`${dialogue.situation}-${idx}`} className="rounded-2xl bg-white/95 border border-slate-100 p-3 space-y-1 shadow-sm">
                              <p className="text-sm font-black text-slate-500">{dialogue.situation}</p>
                              <p className="text-sm font-black text-slate-800">{dialogue.opener}</p>
                              <p className="text-sm font-bold text-slate-600">{dialogue.advice}</p>
                              <p className="text-sm font-bold text-slate-500">
                                ุฅุฑุดุงุฏ ุชุทุจููู: ุงุจุฏุฃ ุจุงูุงุญุชูุงุก ุซู ุงุณุฃู ุณุคุงููุง ููุชูุญูุงุ ูุงุฎุชู ุจุฎุทูุฉ ุฃูุงู ูุงุญุฏุฉ ูุงุจูุฉ ููุชูููุฐ ููุฑูุง.
                              </p>
                            </article>
                          ))}
                        </div>
                      </div>

                      {isActiveScenario && (
                        <div className="flex items-center justify-between gap-3 flex-wrap">
                          <p className="text-sm font-black text-slate-700">{quickAdvisorTip}</p>
                          <button
                            onClick={copyIncidentPlan}
                            className="px-4 py-2 text-sm font-black rounded-xl bg-slate-900 text-white"
                          >
                            {copiedPlan ? 'ุชู ุงููุณุฎ' : 'ูุณุฎ ุงูุฎุทุฉ'}
                          </button>
                        </div>
                      )}
                    </div>
                  )}
                </div>
              </article>
            );
          })}
        </div>
      </section>

    </div>
  );
};

export default PsychologicalInsightView;
