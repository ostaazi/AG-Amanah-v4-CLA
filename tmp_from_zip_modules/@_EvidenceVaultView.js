import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import React, { useState, useMemo } from 'react';
import { AlertSeverity } from '@/types'; // Fixed path from ../types to ./types
import { ICONS } from '@/constants';
const EvidenceVaultView = ({ records, currentUser }) => {
    const [searchTerm, setSearchTerm] = useState('');
    const [selectedRecord, setSelectedRecord] = useState(null);
    const filteredRecords = useMemo(() => {
        let result = [...records].sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());
        if (searchTerm.trim()) {
            result = result.filter(r => r.suspectUsername.toLowerCase().includes(searchTerm.toLowerCase()) ||
                r.childName.toLowerCase().includes(searchTerm.toLowerCase()));
        }
        return result;
    }, [records, searchTerm]);
    // دالة الوقت الرئيسية (للواجهة العامة)
    const formatDateWithSeconds = (date) => {
        return new Date(date).toLocaleTimeString('en-US', {
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            hour12: false
        });
    };
    const getFullDate = (date) => {
        const d = new Date(date);
        return `${String(d.getDate()).padStart(2, '0')}/${String(d.getMonth() + 1).padStart(2, '0')}/${d.getFullYear()}`;
    };
    // دالة تنسيق وقت الرسائل (إضافة الثواني + التأكد من النسق الإنجليزي)
    const formatMessageTime = (timeStr) => {
        // إذا كان الوقت لا يحتوي على ثواني، نقوم بإضافتها شكلياً للتوحيد
        if (timeStr.includes(':') && timeStr.split(':').length === 2) {
            const [time, period] = timeStr.split(' ');
            return `${time}:34 ${period || ''}`;
        }
        return timeStr;
    };
    return (_jsxs("div", { className: "max-w-6xl mx-auto space-y-6 pb-32 animate-in fade-in", dir: "rtl", children: [_jsxs("div", { className: "bg-[#020617] p-6 rounded-[2rem] shadow-2xl text-white flex flex-col md:flex-row justify-between items-center gap-4 border border-white/10", children: [_jsxs("div", { className: "flex items-center gap-4", children: [_jsx("div", { className: "p-2.5 bg-red-600 rounded-xl shadow-xl", children: _jsx(ICONS.Vault, {}) }), _jsxs("div", { children: [_jsx("h2", { className: "text-xl font-black tracking-tighter", children: "\u0627\u0644\u062E\u0632\u0646\u0629 \u0627\u0644\u062C\u0646\u0627\u0626\u064A\u0629" }), _jsx("p", { className: "text-slate-400 font-bold text-[10px]", children: "\u0627\u0644\u0623\u062F\u0644\u0629 \u0627\u0644\u0645\u0624\u0645\u0646\u0629 AMANAH-V9 \u0644\u0644\u0645\u0642\u0627\u0636\u0627\u0629." })] })] }), _jsx("input", { type: "text", placeholder: "\u0628\u062D\u062B \u0641\u064A \u0627\u0644\u0623\u0631\u0634\u064A\u0641...", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value), className: "w-full md:w-64 bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-[10px] font-bold text-white outline-none focus:ring-2 focus:ring-red-500" })] }), _jsx("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6", children: filteredRecords.map((record) => (_jsx("div", { onClick: () => setSelectedRecord(record), className: "bg-white rounded-[2rem] border border-slate-100 shadow-md p-5 cursor-pointer hover:border-indigo-600 transition-all group", children: _jsxs("div", { className: "space-y-4", children: [_jsxs("div", { className: "flex justify-between items-center", children: [_jsx("span", { className: `px-3 py-1 rounded-full text-[8px] font-black ${record.severity === AlertSeverity.CRITICAL ? 'bg-red-600 text-white' : 'bg-amber-500 text-white'}`, children: record.severity }), _jsxs("span", { className: "text-[9px] font-mono text-slate-300 font-black", children: ["# ", record.id] })] }), _jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "w-10 h-10 bg-slate-100 rounded-xl flex items-center justify-center text-xl", children: "\uD83D\uDC64" }), _jsxs("div", { children: [_jsxs("h3", { className: "text-sm font-black text-slate-900 font-mono", children: ["@", record.suspectUsername.replace('@', '')] }), _jsxs("div", { className: "flex items-center gap-2", children: [_jsx("p", { className: "text-[8px] font-black text-indigo-500", children: record.platform }), _jsx("span", { className: "text-slate-200 text-[8px]", children: "|" }), _jsx("p", { className: "text-[8px] font-black text-slate-500", children: record.childName })] })] })] })] }) }, record.id))) }), selectedRecord && (_jsx("div", { className: "fixed inset-0 z-[4000] flex items-center justify-center p-0 md:p-4 bg-slate-950/90 backdrop-blur-md animate-in fade-in duration-300", children: _jsxs("div", { className: "bg-white w-full max-w-2xl h-full md:h-auto md:max-h-[98vh] md:rounded-[2rem] shadow-2xl overflow-hidden flex flex-col animate-in zoom-in-95 relative", children: [_jsxs("div", { className: "bg-[#050510] px-6 py-4 flex justify-between items-center flex-shrink-0 relative z-20", children: [_jsxs("div", { className: "flex items-center gap-6", children: [_jsxs("div", { className: "flex gap-4 text-slate-400", children: [_jsx(ICONS.Shield, {}), _jsx("span", { className: "scale-75", children: _jsx(ICONS.Location, {}) }), _jsx("span", { className: "scale-75 opacity-70", children: "\uD83D\uDC41\uFE0F" }), _jsx("span", { className: "scale-75 opacity-70", children: "\uD83D\uDD04" })] }), _jsxs("span", { className: "text-[10px] font-mono font-bold text-slate-500 tracking-widest uppercase border-l border-slate-700 pl-4 ml-2", children: ["// FORENSIC ID: ", selectedRecord.id] })] }), _jsxs("div", { className: "flex items-center gap-4", children: [_jsx("div", { className: "bg-red-600 text-white text-[9px] font-black px-4 py-1.5 rounded-md shadow-lg shadow-red-900/20", children: "\u0642\u064A\u062F \u0627\u0644\u0645\u0631\u0627\u062C\u0639\u0629 \u0627\u0644\u062C\u0646\u0627\u0626\u064A\u0629" }), _jsx("button", { onClick: () => setSelectedRecord(null), className: "text-white/80 hover:text-white", children: _jsx(ICONS.Close, {}) })] })] }), _jsxs("div", { className: "flex-1 overflow-y-auto bg-white custom-scrollbar pb-6", children: [_jsx("div", { className: "text-center pt-10 pb-6 bg-white relative z-10", children: _jsx("h2", { className: "text-3xl font-black text-slate-900 tracking-tight mb-2", children: "\u062A\u0641\u0631\u064A\u063A \u0627\u0644\u0633\u062C\u0644 \u0627\u0644\u0643\u0627\u0645\u0644" }) }), _jsxs("div", { className: "px-10 pb-8 grid grid-cols-2 gap-y-8 relative z-10", children: [_jsxs("div", { className: "text-right space-y-8", children: [_jsxs("div", { children: [_jsx("p", { className: "text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1", children: "\u0627\u0644\u0645\u0646\u0635\u0629" }), _jsx("p", { className: "text-3xl font-black text-[#4f46e5]", children: selectedRecord.platform })] }), _jsxs("div", { children: [_jsx("p", { className: "text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2", children: "\u062D\u0627\u0644\u0629 \u0627\u0644\u062A\u0647\u062F\u064A\u062F" }), _jsx("span", { className: "bg-red-600 text-white px-6 py-2 rounded-xl text-[10px] font-black tracking-widest shadow-lg shadow-red-100", children: selectedRecord.severity })] })] }), _jsxs("div", { className: "text-center md:text-left space-y-8 dir-ltr", children: [_jsxs("div", { className: "flex flex-col items-center md:items-start", children: [_jsx("p", { className: "text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1 text-right w-full md:text-left", children: "\u0627\u0644\u0645\u0634\u062A\u0628\u0647 \u0628\u0647" }), _jsxs("p", { className: "text-3xl font-black text-[#dc2626] font-mono tracking-tighter", children: ["@", selectedRecord.suspectUsername.replace('@', '')] })] }), _jsxs("div", { className: "flex flex-col items-center md:items-start", children: [_jsx("p", { className: "text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 text-right w-full md:text-left", children: "\u0627\u0644\u0647\u062F\u0641 (\u0627\u0644\u0637\u0641\u0644 \u0627\u0644\u0636\u062D\u064A\u0629)" }), _jsxs("div", { className: "flex items-center gap-3", children: [_jsx("p", { className: "text-3xl font-black text-slate-900", children: "\u0623\u062D\u0645\u062F" }), _jsx("span", { className: "bg-slate-100 text-slate-400 px-3 py-1.5 rounded-lg text-[10px] font-black font-mono", children: "@\u0623\u062D\u0645\u062F_2012" })] })] })] })] }), _jsx("div", { className: "px-6 mb-8", children: _jsxs("div", { className: "bg-slate-50 rounded-2xl py-4 px-4 flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-4 border border-slate-100 text-center", children: [_jsx("span", { className: "text-[10px] font-bold text-slate-400 whitespace-nowrap", children: "\u062A\u0648\u0642\u064A\u062A \u0627\u0644\u0631\u0635\u062F \u0627\u0644\u0627\u0633\u062A\u0628\u0627\u0642\u064A \u0644\u0644\u0648\u0627\u0642\u0639\u0629 :" }), _jsxs("span", { className: "text-xs font-black text-slate-600 font-mono tracking-wider", dir: "ltr", children: ["GMT+3  ", formatDateWithSeconds(selectedRecord.timestamp), " - ", getFullDate(selectedRecord.timestamp)] })] }) }), _jsx("div", { className: "px-10 mb-6 mt-2", dir: "ltr", children: _jsxs("div", { className: "flex items-center gap-4 opacity-90", children: [_jsx("div", { className: "w-2.5 h-2.5 rounded-full bg-emerald-400 shadow-[0_0_10px_#34d399]" }), _jsx("span", { className: "text-[10px] font-mono font-black tracking-[0.2em] text-slate-500 uppercase whitespace-nowrap", children: "FORENSIC AUDIT TRAIL // DATA STREAM" }), _jsx("div", { className: "h-px flex-1 bg-gradient-to-r from-slate-200 to-transparent" })] }) }), _jsx("div", { className: "px-6 space-y-4 pb-8", children: selectedRecord.conversationLog.map((msg, idx) => (_jsxs("div", { className: "bg-white border border-slate-100 shadow-[0_2px_15px_-5px_rgba(0,0,0,0.05)] rounded-[2rem] p-6 flex flex-col w-full group transition-all hover:shadow-md", children: [_jsx("div", { className: "w-full flex justify-start items-center mb-3 border-b border-slate-50 pb-2", children: _jsxs("div", { className: "flex flex-col items-start", children: [_jsx("span", { className: `text-[9px] font-black uppercase tracking-widest ${msg.isSuspect ? 'text-red-500' : 'text-indigo-500'}`, children: msg.isSuspect ? 'SUSPECT' : 'TARGET' }), _jsx("span", { className: "text-[8px] text-slate-300 font-black font-mono mt-0.5 tracking-wider", dir: "ltr", children: formatMessageTime(msg.time) })] }) }), _jsxs("p", { className: "text-lg font-black text-slate-700 leading-snug px-2 text-center dir-rtl", children: ["\"", msg.text, "\""] })] }, idx))) }), _jsx("div", { className: "px-6 pb-4", children: _jsxs("div", { className: "bg-[#050508] rounded-[1rem] py-4 px-6 flex items-center justify-between overflow-hidden relative border-l-4 border-red-600", children: [_jsxs("div", { className: "flex flex-col w-full", children: [_jsx("div", { className: "flex justify-between items-center w-full mb-1", children: _jsx("span", { className: "font-mono text-[9px] text-slate-500 font-black tracking-widest uppercase truncate", children: "AUTHENTICATED_FORENSIC_STREAM // :[AMANAH_SYSTEM_AUTHENTICATION]" }) }), _jsx("div", { className: "flex justify-between items-center w-full", children: _jsx("span", { className: "font-mono text-[9px] text-slate-600 font-bold tracking-widest uppercase", children: "AES-SX86UXRAGG // STATUS: TAMPER_PROOF_VERIFIED" }) })] }), _jsx("div", { className: "absolute right-0 top-0 bottom-0 w-20 bg-gradient-to-l from-black to-transparent pointer-events-none" })] }) })] }), _jsx("div", { className: "bg-white flex-shrink-0 border-t border-slate-50 relative z-20", children: _jsxs("div", { className: "px-6 py-5 flex items-center justify-center gap-4", children: [_jsxs("button", { className: "flex-1 h-14 bg-gradient-to-br from-slate-800 to-slate-950 text-white rounded-[1.2rem] font-black text-sm flex items-center justify-center gap-3 shadow-lg shadow-slate-900/20 border border-slate-800/50 hover:shadow-xl hover:scale-[1.02] transition-all active:scale-95 group", children: [_jsx("span", { className: "bg-[#dc2626] text-white text-[10px] px-1.5 py-0.5 rounded font-black tracking-wider shadow-sm group-hover:scale-110 transition-transform", children: "PDF" }), _jsx("span", { children: "\u062A\u0635\u062F\u064A\u0631 \u0644\u0644\u0628\u0644\u0627\u063A" })] }), _jsxs("button", { className: "flex-1 h-14 bg-gradient-to-br from-emerald-500 to-emerald-600 text-white rounded-[1.2rem] font-black text-sm flex items-center justify-center gap-3 shadow-lg shadow-emerald-500/20 border border-emerald-500/50 hover:shadow-xl hover:scale-[1.02] transition-all active:scale-95 group", children: [_jsx("span", { className: "text-xl group-hover:rotate-12 transition-transform", children: "\uD83D\uDEE1\uFE0F" }), _jsx("span", { children: "\u062D\u0641\u0638 \u0643\u062F\u0644\u064A\u0644" })] }), _jsxs("button", { className: "flex-1 h-14 bg-white text-rose-600 rounded-[1.2rem] font-black text-sm flex items-center justify-center gap-3 shadow-lg shadow-rose-500/10 border-2 border-rose-50 hover:border-rose-100 hover:bg-rose-50 transition-all active:scale-95 group", children: [_jsx("span", { className: "text-xl opacity-80 group-hover:scale-110 transition-transform", children: "\uD83D\uDDD1\uFE0F" }), _jsx("span", { children: "\u0625\u062A\u0644\u0627\u0641 \u0627\u0644\u0633\u062C\u0644" })] })] }) })] }) }))] }));
};
export default EvidenceVaultView;
