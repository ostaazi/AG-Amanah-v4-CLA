import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import React, { useState } from 'react';
import { AmanahShield } from '@/constants';
const ProactiveDefenseView = ({ children, onUpdateDefense, lang }) => {
    const [selectedChildId, setSelectedChildId] = useState(children[0]?.id || '');
    const child = children.find(c => c.id === selectedChildId) || children[0];
    const [isRecording, setIsRecording] = useState(false);
    const [recordingStatus, setRecordingStatus] = useState('IDLE');
    const defaultConfig = {
        isEnabled: true,
        onTextThreat: { lockDevice: true, blockApp: true, sendWarning: true, triggerSiren: false },
        onVisualThreat: { blockCamera: true, lockDevice: true, triggerSiren: true, blockMic: true },
        autoMessage: "تحذير: تم رصد محتوى يخالف قواعد السلامة. تم تقييد الوصول مؤقتاً لحمايتك، يرجى التواصل مع الوالدين فوراً.",
        sirenType: 'DEFAULT'
    };
    const config = child?.defenseConfig || defaultConfig;
    const updateConfig = (updates) => {
        onUpdateDefense(child.id, { ...config, ...updates });
    };
    const toggleMasterSwitch = () => {
        updateConfig({ isEnabled: !config.isEnabled });
    };
    const handleRecordVoice = () => {
        if (!isRecording) {
            setIsRecording(true);
            setRecordingStatus('RECORDING');
            // محاكاة بدء التسجيل
            setTimeout(() => {
                setIsRecording(false);
                setRecordingStatus('DONE');
                updateConfig({ sirenType: 'VOICE_RECORD', voiceRecordUrl: 'mock_voice_url' });
            }, 3000);
        }
    };
    if (!child)
        return (_jsxs("div", { className: "flex flex-col items-center justify-center p-20 text-slate-400 gap-4", children: [_jsx("div", { className: "text-6xl grayscale opacity-20", children: "\uD83D\uDCE1" }), _jsx("p", { className: "font-black", children: "\u064A\u0631\u062C\u0649 \u0631\u0628\u0637 \u062C\u0647\u0627\u0632 \u0637\u0641\u0644 \u0644\u062A\u0641\u0639\u064A\u0644 \u0628\u0631\u0648\u062A\u0648\u0643\u0648\u0644\u0627\u062A \u0627\u0644\u062F\u0641\u0627\u0639." })] }));
    return (_jsxs("div", { className: "max-w-6xl mx-auto space-y-8 pb-40 animate-in fade-in", dir: "rtl", children: [_jsxs("div", { className: "bg-[#0f172a] rounded-[3rem] p-8 md:p-12 text-white shadow-2xl relative overflow-hidden border-b-[12px] border-[#8A1538]", children: [_jsx("div", { className: "absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_top_right,rgba(138,21,56,0.15)_0%,transparent_60%)]" }), _jsxs("div", { className: "relative z-10 flex flex-col md:flex-row justify-between items-center gap-10", children: [_jsxs("div", { className: "flex items-center gap-8", children: [_jsx("div", { className: `w-24 h-24 rounded-3xl flex items-center justify-center text-4xl shadow-2xl transition-all duration-700 ${config.isEnabled ? 'bg-[#8A1538] animate-pulse' : 'bg-slate-700 grayscale'}`, children: _jsx(AmanahShield, { className: "w-16 h-16", animate: config.isEnabled }) }), _jsxs("div", { children: [_jsx("h2", { className: "text-4xl font-black tracking-tighter mb-2", children: "\u0628\u0631\u0648\u062A\u0648\u0643\u0648\u0644 \u0627\u0644\u062D\u0627\u0631\u0633 \u0627\u0644\u0634\u062E\u0635\u064A" }), _jsx("p", { className: "text-indigo-200 font-bold opacity-80 text-lg", children: "\u0627\u0644\u062A\u062D\u0643\u0645 \u0641\u064A \u0627\u0644\u0627\u0633\u062A\u062C\u0627\u0628\u0629 \u0627\u0644\u0622\u0644\u064A\u0629 \u0627\u0644\u0641\u0648\u0631\u064A\u0629 \u0639\u0646\u062F \u0631\u0635\u062F \u0623\u064A \u062E\u0637\u0631." })] })] }), _jsxs("button", { onClick: toggleMasterSwitch, className: `group relative px-12 py-6 rounded-3xl font-black text-xl transition-all shadow-2xl flex items-center gap-6 overflow-hidden ${config.isEnabled ? 'bg-emerald-600 hover:bg-emerald-500' : 'bg-slate-800 text-slate-500'}`, children: [_jsx("span", { className: "relative z-10", children: config.isEnabled ? '🛡️ النظام نشط' : '⚪ النظام معطل' }), _jsx("div", { className: `w-14 h-7 rounded-full p-1 bg-black/30 relative transition-all ${config.isEnabled ? 'bg-emerald-400' : ''}`, children: _jsx("div", { className: `w-5 h-5 bg-white rounded-full shadow-lg transition-transform ${config.isEnabled ? '-translate-x-7' : 'translate-x-0'}` }) })] })] })] }), _jsx("div", { className: "flex gap-3 overflow-x-auto pb-4 custom-scrollbar px-2", children: children.map(c => (_jsxs("button", { onClick: () => setSelectedChildId(c.id), className: `flex items-center gap-4 px-8 py-4 rounded-2xl border-2 transition-all whitespace-nowrap ${selectedChildId === c.id ? 'bg-white border-[#8A1538] text-[#8A1538] shadow-xl' : 'bg-slate-50 border-transparent text-slate-400'}`, children: [_jsx("img", { src: c.avatar, className: "w-10 h-10 rounded-xl object-cover border border-slate-200" }), _jsxs("div", { className: "text-right", children: [_jsx("p", { className: "font-black text-sm block leading-none", children: c.name }), _jsx("span", { className: "text-[8px] font-bold uppercase opacity-60", children: "\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0628\u0631\u0648\u062A\u0648\u0643\u0648\u0644" })] })] }, c.id))) }), _jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8", children: [_jsxs("div", { className: "bg-white p-10 rounded-[3.5rem] shadow-xl border border-slate-100 space-y-8 flex flex-col", children: [_jsxs("div", { className: "flex items-center gap-5 border-b border-slate-50 pb-8", children: [_jsx("div", { className: "w-16 h-16 bg-amber-50 text-amber-600 rounded-2xl flex items-center justify-center text-3xl shadow-inner border border-amber-100", children: "\u2328\uFE0F" }), _jsxs("div", { children: [_jsx("h3", { className: "text-2xl font-black text-slate-800 tracking-tight", children: "\u0628\u0631\u0648\u062A\u0648\u0643\u0648\u0644 \u0627\u0644\u062A\u0647\u062F\u064A\u062F \u0627\u0644\u0646\u0635\u064A" }), _jsx("p", { className: "text-slate-400 font-bold text-xs uppercase tracking-widest mt-1", children: "\u0639\u0646\u062F \u0631\u0635\u062F \u0643\u0644\u0645\u0627\u062A \u0628\u0630\u064A\u0626\u0629 \u0623\u0648 \u0627\u0633\u062A\u062F\u0631\u0627\u062C" })] })] }), _jsxs("div", { className: "space-y-4 flex-1", children: [_jsx(ProtocolToggle, { label: "\u0642\u0641\u0644 \u0627\u0644\u062C\u0647\u0627\u0632 \u0641\u0648\u0631\u0627\u064B", desc: "\u0645\u0646\u0639 \u0627\u0644\u0637\u0641\u0644 \u0645\u0646 \u0627\u0633\u062A\u062E\u062F\u0627\u0645 \u0627\u0644\u0647\u0627\u062A\u0641 \u0648\u0639\u0631\u0636 \u0634\u0627\u0634\u0629 \u0627\u0644\u0642\u0641\u0644.", active: config.onTextThreat.lockDevice, onToggle: () => updateConfig({ onTextThreat: { ...config.onTextThreat, lockDevice: !config.onTextThreat.lockDevice } }) }), _jsx(ProtocolToggle, { label: "\u062D\u0638\u0631 \u0627\u0644\u062A\u0637\u0628\u064A\u0642 \u0627\u0644\u0645\u0641\u062A\u0648\u062D", desc: "\u0633\u064A\u062A\u0645 \u0625\u063A\u0644\u0627\u0642 \u0627\u0644\u062A\u0637\u0628\u064A\u0642 \u0627\u0644\u0630\u064A \u062A\u0645\u062A \u0641\u064A\u0647 \u0627\u0644\u0645\u062E\u0627\u0644\u0641\u0629 \u0641\u0642\u0637.", active: config.onTextThreat.blockApp, onToggle: () => updateConfig({ onTextThreat: { ...config.onTextThreat, blockApp: !config.onTextThreat.blockApp } }) }), _jsx(ProtocolToggle, { label: "\u062F\u0641\u0639 \u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u062A\u062D\u0630\u064A\u0631", desc: "\u0625\u0638\u0647\u0627\u0631 \u0627\u0644\u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u0622\u0644\u064A\u0629 \u0641\u0648\u0642 \u0643\u0627\u0641\u0629 \u0627\u0644\u0646\u0648\u0627\u0641\u0630.", active: config.onTextThreat.sendWarning, onToggle: () => updateConfig({ onTextThreat: { ...config.onTextThreat, sendWarning: !config.onTextThreat.sendWarning } }) }), _jsx(ProtocolToggle, { label: "\u062A\u0641\u0639\u064A\u0644 \u0635\u0648\u062A \u0627\u0644\u062A\u0646\u0628\u064A\u0647", active: config.onTextThreat.triggerSiren, onToggle: () => updateConfig({ onTextThreat: { ...config.onTextThreat, triggerSiren: !config.onTextThreat.triggerSiren } }) })] })] }), _jsxs("div", { className: "bg-white p-10 rounded-[3.5rem] shadow-xl border border-slate-100 space-y-8 flex flex-col", children: [_jsxs("div", { className: "flex items-center gap-5 border-b border-slate-50 pb-8", children: [_jsx("div", { className: "w-16 h-16 bg-red-50 text-red-600 rounded-2xl flex items-center justify-center text-3xl shadow-inner border border-red-100", children: "\uD83D\uDC41\uFE0F" }), _jsxs("div", { children: [_jsx("h3", { className: "text-2xl font-black text-slate-800 tracking-tight", children: "\u0628\u0631\u0648\u062A\u0648\u0643\u0648\u0644 \u0627\u0644\u062A\u0647\u062F\u064A\u062F \u0627\u0644\u0628\u0635\u0631\u064A" }), _jsx("p", { className: "text-slate-400 font-bold text-xs uppercase tracking-widest mt-1", children: "\u0639\u0646\u062F \u0631\u0635\u062F \u0635\u0648\u0631 \u063A\u064A\u0631 \u0644\u0627\u0626\u0642\u0629 \u0623\u0648 \u0637\u0644\u0628 \u0643\u0627\u0645\u064A\u0631\u0627" })] })] }), _jsxs("div", { className: "space-y-4 flex-1", children: [_jsx(ProtocolToggle, { label: "\u062D\u0638\u0631 \u0627\u0644\u0643\u0627\u0645\u064A\u0631\u0627 \u0648\u0627\u0644\u0645\u064A\u0643\u0631\u0648\u0641\u0648\u0646", desc: "\u062A\u0639\u0637\u064A\u0644 \u0627\u0644\u0639\u062A\u0627\u062F \u0628\u0631\u0645\u062C\u064A\u0627\u064B \u0641\u0648\u0631 \u0631\u0635\u062F \u0645\u062D\u0627\u0648\u0644\u0629 \u0627\u0633\u062A\u062F\u0631\u0627\u062C.", active: config.onVisualThreat.blockCamera, onToggle: () => updateConfig({ onVisualThreat: { ...config.onVisualThreat, blockCamera: !config.onVisualThreat.blockCamera, blockMic: !config.onVisualThreat.blockMic } }) }), _jsx(ProtocolToggle, { label: "\u0642\u0641\u0644 \u0627\u0644\u0647\u0627\u062A\u0641 \u0628\u0627\u0644\u0643\u0627\u0645\u0644", desc: "\u0623\u0642\u0635\u0649 \u062F\u0631\u062C\u0627\u062A \u0627\u0644\u062D\u0645\u0627\u064A\u0629 \u0639\u0646\u062F \u0648\u062C\u0648\u062F \u062A\u0647\u062F\u064A\u062F \u062C\u0646\u0627\u0626\u064A.", active: config.onVisualThreat.lockDevice, onToggle: () => updateConfig({ onVisualThreat: { ...config.onVisualThreat, lockDevice: !config.onVisualThreat.lockDevice } }) }), _jsx(ProtocolToggle, { label: "\u0635\u0627\u0641\u0631\u0629 \u0627\u0644\u0625\u0646\u0630\u0627\u0631 \u0627\u0644\u0642\u0635\u0648\u0649", active: config.onVisualThreat.triggerSiren, onToggle: () => updateConfig({ onVisualThreat: { ...config.onVisualThreat, triggerSiren: !config.onVisualThreat.triggerSiren } }) }), _jsx(ProtocolToggle, { label: "\u062A\u062A\u0628\u0639 \u0627\u0644\u0645\u0648\u0642\u0639 \u0627\u0644\u062C\u063A\u0631\u0627\u0641\u064A \u0627\u0644\u062D\u064A", desc: "\u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0625\u062D\u062F\u0627\u062B\u064A\u0627\u062A \u0643\u0644 \u062B\u0627\u0646\u064A\u0629 \u0641\u0648\u0631 \u0631\u0635\u062F \u0627\u0644\u062A\u0647\u062F\u064A\u062F.", active: true, onToggle: () => { }, disabled: true })] })] })] }), _jsxs("div", { className: "bg-white p-10 rounded-[4rem] shadow-xl border border-slate-100 space-y-10", children: [_jsxs("div", { className: "flex items-center gap-6", children: [_jsx("div", { className: "w-14 h-14 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center text-2xl shadow-inner border border-indigo-100", children: "\uD83D\uDCAC" }), _jsxs("div", { children: [_jsx("h3", { className: "text-2xl font-black text-slate-800 tracking-tight", children: "\u0646\u0638\u0627\u0645 \u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u0631\u062F\u0639 \u0627\u0644\u0627\u0633\u062A\u0628\u0627\u0642\u064A\u0629" }), _jsx("p", { className: "text-slate-400 font-bold text-[10px] uppercase tracking-widest mt-1", children: "\u062A\u0638\u0647\u0631 \u0647\u0630\u0647 \u0627\u0644\u0631\u0633\u0627\u0644\u0629 \u0622\u0644\u064A\u0627\u064B \u0644\u0644\u0637\u0641\u0644 \u0639\u0646\u062F \u0631\u0635\u062F \u0623\u064A \u062E\u0637\u0631" })] })] }), _jsxs("div", { className: "relative group", children: [_jsx("textarea", { value: config.autoMessage, onChange: (e) => updateConfig({ autoMessage: e.target.value }), className: "w-full p-8 rounded-[2.5rem] bg-slate-50 border-2 border-slate-100 outline-none font-bold text-xl shadow-inner text-right min-h-[180px] focus:border-indigo-500 focus:bg-white transition-all resize-none", placeholder: "\u0627\u0643\u062A\u0628 \u0647\u0646\u0627 \u0627\u0644\u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u062A\u064A \u062A\u0631\u064A\u062F \u0623\u0646 \u064A\u0631\u0627\u0647\u0627 \u0637\u0641\u0644\u0643..." }), _jsx("div", { className: "absolute bottom-6 left-6 flex items-center gap-2", children: _jsx("span", { className: "bg-indigo-600 text-white text-[9px] font-black px-4 py-1.5 rounded-full shadow-lg", children: "\u0633\u064A\u062A\u0645 \u062F\u0641\u0639\u0647\u0627 \u0644\u0644\u062C\u0647\u0627\u0632 \u0641\u0648\u0631\u0627\u064B" }) })] })] }), _jsxs("div", { className: "bg-slate-900 rounded-[4rem] p-10 md:p-12 text-white shadow-2xl flex flex-col lg:flex-row items-center gap-12 border-b-8 border-indigo-600", children: [_jsxs("div", { className: "flex-1 space-y-8", children: [_jsxs("div", { className: "flex items-center gap-6", children: [_jsx("div", { className: "w-16 h-16 bg-white/5 rounded-2xl flex items-center justify-center text-4xl shadow-inner border border-white/10", children: "\uD83D\uDCE2" }), _jsxs("div", { children: [_jsx("h3", { className: "text-3xl font-black tracking-tight", children: "\u0646\u0638\u0627\u0645 \u0627\u0644\u0631\u062F\u0639 \u0627\u0644\u0635\u0648\u062A\u064A" }), _jsx("p", { className: "text-indigo-300 font-bold text-sm opacity-80", children: "\u0627\u062E\u062A\u0631 \u0635\u0648\u062A \u0627\u0644\u062A\u0646\u0628\u064A\u0647 \u0623\u0648 \u0633\u062C\u0644 \u0635\u0648\u062A\u0643 \u0627\u0644\u0634\u062E\u0635\u064A \u0644\u062F\u0641\u0639\u0647 \u0644\u0644\u062C\u0647\u0627\u0632." })] })] }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4", children: [_jsxs("button", { onClick: () => updateConfig({ sirenType: 'DEFAULT' }), className: `p-6 rounded-[1.8rem] border-2 transition-all flex items-center justify-between group ${config.sirenType === 'DEFAULT' ? 'bg-indigo-600 border-indigo-400 shadow-xl' : 'bg-white/5 border-white/10 text-slate-500'}`, children: [_jsxs("div", { className: "text-right", children: [_jsx("p", { className: `font-black ${config.sirenType === 'DEFAULT' ? 'text-white' : ''}`, children: "\u0635\u0627\u0641\u0631\u0629 \u0625\u0646\u0630\u0627\u0631 \u0631\u0633\u0645\u064A\u0629" }), _jsx("p", { className: "text-[10px] opacity-60", children: "\u0635\u0648\u062A \u0639\u0627\u0644\u064A \u062C\u062F\u0627\u064B \u0644\u0627 \u064A\u0645\u0643\u0646 \u0643\u062A\u0645\u0647" })] }), _jsx("span", { className: "text-2xl group-hover:scale-125 transition-transform", children: "\uD83D\uDEA8" })] }), _jsxs("button", { onClick: () => updateConfig({ sirenType: 'VOICE_RECORD' }), className: `p-6 rounded-[1.8rem] border-2 transition-all flex items-center justify-between group ${config.sirenType === 'VOICE_RECORD' ? 'bg-[#8A1538] border-[#B83A60] shadow-xl' : 'bg-white/5 border-white/10 text-slate-500'}`, children: [_jsxs("div", { className: "text-right", children: [_jsx("p", { className: `font-black ${config.sirenType === 'VOICE_RECORD' ? 'text-white' : ''}`, children: "\u0628\u0635\u0645\u0629 \u0635\u0648\u062A \u0627\u0644\u0648\u0627\u0644\u062F" }), _jsx("p", { className: "text-[10px] opacity-60", children: "\u062F\u0641\u0639 \u062A\u0633\u062C\u064A\u0644 \u0635\u0648\u062A\u064A \u0645\u062E\u0635\u0635" })] }), _jsx("span", { className: "text-2xl group-hover:scale-125 transition-transform", children: "\uD83C\uDFA4" })] })] })] }), _jsxs("div", { className: "w-full lg:w-80 bg-white/5 backdrop-blur-xl rounded-[3rem] p-10 border border-white/10 flex flex-col items-center justify-center space-y-8 shadow-2xl relative overflow-hidden group/rec", children: [_jsx("div", { className: "absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(220,38,38,0.1)_0%,transparent_70%)] opacity-0 group-hover/rec:opacity-100 transition-opacity" }), _jsxs("button", { onMouseDown: handleRecordVoice, className: `w-32 h-32 rounded-full flex items-center justify-center transition-all duration-500 shadow-2xl relative z-10 ${isRecording ? 'bg-red-600 scale-110 shadow-red-500/50' : 'bg-slate-800 hover:bg-slate-700'}`, children: [_jsx("div", { className: `text-4xl ${isRecording ? 'animate-pulse' : ''}`, children: isRecording ? '⏺️' : '🎤' }), isRecording && _jsx("div", { className: "absolute inset-0 border-4 border-white/20 rounded-full animate-ping" })] }), _jsxs("div", { className: "text-center relative z-10", children: [_jsx("p", { className: `text-[11px] font-black uppercase tracking-widest ${isRecording ? 'text-red-500' : 'text-slate-400'}`, children: isRecording ? 'جاري تسجيل صوتك...' : recordingStatus === 'DONE' ? 'تم الحفظ والمزامنة ✓' : 'اضغط مطولاً للتسجيل والدفع' }), recordingStatus === 'DONE' && _jsx("p", { className: "text-[8px] font-bold text-emerald-500 mt-2", children: "Voice_Shield_V2.0_Loaded" })] })] })] }), _jsx("div", { className: "flex justify-center pt-10", children: _jsxs("button", { onClick: () => alert("تم تعميم كافة بروتوكولات الدفاع الاستباقي على أجهزة الأطفال بنجاح."), className: "px-20 py-7 bg-slate-900 text-white rounded-[2.5rem] font-black text-2xl shadow-[0_20px_50px_rgba(0,0,0,0.3)] hover:bg-indigo-600 active:scale-95 transition-all flex items-center gap-6 border-b-4 border-black", children: [_jsx("span", { children: "\uD83D\uDCBE" }), "\u062D\u0641\u0638 \u0648\u062A\u0639\u0645\u064A\u0645 \u0627\u0644\u0628\u0631\u0648\u062A\u0648\u0643\u0648\u0644"] }) })] }));
};
const ProtocolToggle = ({ label, desc, active, onToggle, disabled }) => (_jsxs("div", { onClick: () => !disabled && onToggle(), className: `p-6 rounded-[2rem] border-2 transition-all flex items-center justify-between group ${disabled ? 'opacity-40 cursor-not-allowed' : 'cursor-pointer'} ${active ? 'bg-indigo-50 border-indigo-100 shadow-sm' : 'bg-slate-50/50 border-transparent hover:bg-slate-50'}`, children: [_jsxs("div", { className: "flex-1 text-right", children: [_jsx("p", { className: `font-black text-lg ${active ? 'text-indigo-900' : 'text-slate-700'}`, children: label }), desc && _jsx("p", { className: "text-[10px] font-bold text-slate-400 mt-1 leading-none", children: desc })] }), _jsx("div", { className: `w-14 h-8 rounded-full p-1 transition-all ${active ? 'bg-indigo-600 shadow-lg shadow-indigo-100' : 'bg-slate-300'}`, children: _jsx("div", { className: `w-6 h-6 bg-white rounded-full shadow-md transition-transform ${active ? '-translate-x-6' : 'translate-x-0'}` }) })] }));
export default ProactiveDefenseView;
