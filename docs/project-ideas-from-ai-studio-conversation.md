# Amanah Project Ideas & Notes (Extracted from AI Studio Conversation)

> هذا الملف يلخص الأفكار والملاحظات المستخرجة من الحوار الطويل في ملف HTML.
> الهدف: تحويل النقاش إلى نقاط تنفيذية واضحة يمكن إضافتها إلى الخطة العامة.
> حالة التنفيذ المرحلية (P0/P1/P2): `docs/project-execution-plan-p0-p2-status.md`

## 1) الهوية البصرية وتجربة الواجهة

- تخصيص `Admin Badge` ليطابق الدرع الماروني/الذهبي في المرفقات مع عدم تغيير اللوجو الرسمي العام.
- تحسين عرض اللوجو في الشريط العلوي وضبط التكبير/التصغير بدقة.
- تحسين شاشة `System Initialization` لتعرض اللوجو الصحيح بشكل متسق.
- إضافة تأثير توهج متحرك (Breathing Glow) في شاشة التهيئة فقط.
- إرجاع/ضبط البانر الأسود في الموضع الصحيح بدون تعارض مع الهيدر.
- إعادة تصميم أزرار `Evidence Vault` لتطابق المرفقات (شكل، ترتيب، أحجام).
- جعل محتوى الأزرار يدعم `RTL` (الأيقونة يمين، النص يسار).
- معالجة تداخل الهيدر/الفوتر مع المحتوى عبر `padding` و`safe-area`.
- جعل جميع الصفحات/النوافذ قابلة للتمرير (`scrollable`) لتفادي تداخل العناصر.
- معالجة اختفاء الشريط السفلي وضبط `z-index`.
- تحسين تخطيط المخطط الراداري لمنع تداخل النصوص العربية.
- توحيد عرض صور الأفاتار وإزالة الخلفيات/الإطارات غير المرغوبة.
- إضافة وتفعيل زر الترس بين أزرار الجهاز/الحذف في واجهات الأسرة.

## 2) تطبيق الأب (Parent Console) - ميزات التحكم

- إضافة لوحة تحكم شاملة لإعداد الاستجابات التلقائية للحالات الخطرة.
- التحكم الآلي في الإجراءات: قفل الجهاز، حظر تطبيق، تعطيل كاميرا/مايك/موقع.
- دعم إرسال رسالة تلقائية للطفل بناءً على القواعد.
- دعم تنبيه صوتي مخصص (اختيار ملف أو تسجيل من الوالد).
- إضافة `global toggle` + `per-feature toggle` لكل وظيفة حساسة.
- إضافة مفاتيح اختبار لإظهار/إخفاء شاشة التنبيه بشكل مؤقت.
- إضافة زر لتعطيل الشاشة الحمراء أو إعادتها مع تطبيق السياسة على كل التنبيهات القادمة.
- تحويل التنبيهات الحرجة إلى إشعارات عادية عند التعطيل المؤقت.
- إخفاء إشعارات الطوارئ تلقائيًا بعد مدة قصيرة (مثال: ثانيتان).

## 3) تطبيق الطفل (Android Child App)

- تجهيز المشروع ليعمل مباشرة على Android Studio مع خطوات واضحة.
- توضيح جميع dependencies المطلوبة ومكان إضافتها.
- التحقق من الصلاحيات الضرورية في الجهاز (Accessibility/Overlay/Admin/Notifications...).
- تفعيل أوامر من الوالد بشكل فعلي: لقطة شاشة حية، صافرة الطوارئ، قفل الجهاز.
- إصلاح حالات: القفل يعمل بينما screenshot/siren لا تعمل.
- إضافة ميزة تمنع قفل الجهاز عبر `toggle` عند الحاجة.
- دعم تخصيص سياسات كل جهاز طفل بشكل منفصل.

## 4) الرصد الذكي (Visual/Text Hybrid)

- اعتماد نهج `Hybrid`: كشف محلي سريع + تصعيد سحابي للحالات المعقدة.
- تطوير `visualSentinel.ts` من كشف اللون الأحمر فقط إلى تحليل أعمق (`HSV`, `texture`, `density clustering`).
- تحسين كشف الإصابات/العنف لتقليل حالات `false negative`.
- توثيق سبب ضعف بعض النماذج المحلية: ضغط النموذج، تدريب محدود، غياب فهم السياق.
- إضافة صفحة Benchmark لقياس أداء الكشف المحلي في ظروف مختلفة.
- الحاجة إلى تقوية كشف النصوص المموهة وتفسير السياق وليس الكلمات المباشرة فقط.

## 5) الاقتران والربط (Pairing & Device Identity)

- اعتماد جلسة اقتران مؤمنة تحتوي: `sessionId`, `otpCode`, `expiresAt`, `attempt limits`, `status`.
- تحديد صيغة QR بوضوح:
- خيار A: QR يحتوي `sessionId` فقط + OTP (أفضل أمنيًا).
- خيار B: QR يحتوي session + otp (أسرع لكن أخطر بدون توقيع/تشفير).
- تحديد نوع توكن الجهاز بعد الاقتران (`JWT/Firebase token/custom`) وسياسة انتهاء/تجديد.
- تخزين التوكن على أندرويد في `EncryptedSharedPreferences`.
- توحيد تعريف هوية الجهاز: `deviceId`, `model`, `osVersion`, `appVersion`, `familyId`, `parentUid`.
- تحديد الحد الأدنى من endpoints: `/pair/create`, `/pair/verify`, `/device/register|heartbeat`.

## 6) قاعدة البيانات وFirebase

- معالجة أخطاء `Firestore index required` عبر إنشاء الفهارس المطلوبة.
- معالجة `permission-denied` عبر قواعد Firestore صحيحة + جلسة مصادقة فعالة.
- معالجة مشكلات `auth/invalid-credential`.
- معالجة أخطاء `Converting circular structure to JSON` عبر تنظيف البيانات قبل التخزين.
- الانتقال من `Test Mode` إلى `Production Rules` قبل انتهاء مهلة الأمان.
- تأكيد أن تطبيق الأب والطفل يعملان على نفس مشروع Firebase ونفس collections.

## 7) الأدلة الجنائية (Evidence Vault & Forensics)

- تفعيل تصدير PDF حقيقي مع تنبيهات نجاح/فشل واضحة.
- إضافة تنبيه تأكيد قبل الحذف وتنبيه بعد التنفيذ.
- تحسين سلسلة العهدة (`Chain of Custody`) للأدلة.
- دعم `hash verification` للأدلة وإجراءات تحقق النزاهة.
- طرح معمارية مؤسسية:
- Background jobs عبر `BullMQ + Redis` لتوليد Evidence Packages.
- توقيع `manifest` بتوقيع رقمي (`Ed25519`).
- `Legal Hold + Retention Guard` لمنع حذف الأدلة الحساسة.
- اقتراح التكامل مع `S3/R2` و`SIEM` في المراحل المتقدمة.

## 8) إعدادات متقدمة ومختبر المطور

- استرجاع مجموعة الإعدادات المتقدمة كاملة (الأمان، 2FA، أفراد الأسرة...).
- إضافة قسم `Developer Controls` يحتوي toggles لكل وظيفة بالنظام.
- إضافة أدوات اختيارية لحقن/تنظيف بيانات وهمية لكل وحدة أو لكل النظام.
- استرجاع مكتبة الأفاتار من `assets` ودعم صورة من جهاز المستخدم.
- دراسة حفظ مكتبة الأفاتار بقاعدة البيانات لضمان الاستمرارية.

## 9) المشاكل المتكررة التي ظهرت أثناء التنفيذ

- تكرار ظهور "لا يوجد تغيير" بعد بعض التعديلات.
- حدوث انحدار وظيفي بعد إصلاحات UI (اختفاء عناصر أو شاشات بيضاء).
- ظهور تعارضات `z-index` بين الهيدر/الفوتر/المودالات.
- تكرار طلب العمل على نسخة مستقرة دون توسيع نطاق التعديل.
- الحاجة إلى اعتماد منهج "تعديل دقيق بدون آثار جانبية".

## 10) متطلبات أمنية وتقارير شاملة

- إنشاء صفحة تقرير: `System Security & Performance Analysis Report`.
- تحليل أمني شامل: AuthN/AuthZ/Session/Secrets/API/TLS.
- تحليل تهديدات: `XSS`, `CSRF`, `SQLi`, `IDOR`.
- تحليل أداء شامل: `Response Time`, `CPU`, `Memory`, `Scalability`, `Load Handling`.
- تحليل جودة الكود: الهيكلة، قابلية الصيانة، قابلية الاختبار.
- قسم `Recommendations & Action Plan` مصنف حسب الخطورة والأولوية.
- قسم `Continuous Security Monitoring & Emerging Threat Updates` لمتابعة `0-day` و`CVEs`.

## 11) ملاحظات تشغيلية ودعم المستخدم

- تحسين مسار `Forgot Password` وضمان وصول الرسائل (مع توعية spam).
- توثيق تفعيل SMS verification ومتطلبات التكلفة/الخطة.
- تحسين رسائل الخطأ المعروضة للمستخدم النهائي لتكون مفهومة وقابلة للإجراء.
- توفير مؤشرات نجاح واضحة عند ربط الأجهزة وتنفيذ الأوامر.

## 12) اقتراح تحويل النقاط إلى Backlog

- إنشاء `Epic` منفصل لكل محور أعلاه (UI, Child, Detection, Firebase, Forensics, Security).
- تقسيم كل Epic إلى `P0/P1/P2`.
- ربط كل مهمة بمعيار قبول (`Acceptance Criteria`) واختبارات تحقق.
- منع أي تعديل جديد دون smoke tests أساسية (Parent + Child + Firestore + Alerts).
